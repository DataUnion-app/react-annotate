{"version":3,"sources":["Theme/index.js","DemoSite/Editor.js","Crosshairs/index.js","PreventScrollToParents/index.js","hooks/use-window-size.js","ImageCanvas/use-mouse.js","ImageCanvas/use-project-box.js","ImageCanvas/region-tools.js","PointDistances/index.js","RegionLabel/styles.js","RegionLabel/index.js","RegionTags/index.js","colors.js","ImageMask/load-image.js","ImageMask/index.js","HighlightBox/index.js","RegionSelectAndTransformBoxes/index.js","SettingsProvider/index.js","VideoOrImageCanvasBackground/index.js","RegionShapes/index.js","ShortcutsManager/index.js","ImageCanvas/index.js","ImageCanvas/styles.js","ImageCanvas/use-wasd-mode.js","hooks/use-exclude-pattern.js","hooks/xpattern.js","MainLayout/styles.js","SettingsDialog/index.js","Annotator/reducers/get-active-image.js","Annotator/reducers/get-implied-video-regions.js","MainLayout/use-implied-video-regions.js","MainLayout/icon-dictionary.js","KeyframeTimeline/get-time-string.js","KeyframeTimeline/index.js","SidebarBoxContainer/index.js","DebugSidebarBox/index.js","TagsSidebarBox/index.js","KeyframesSelectorSidebarBox/index.js","TaskDescriptionSidebarBox/index.js","RegionSelectorSidebarBox/styles.js","RegionSelectorSidebarBox/index.js","ImageSelectorSidebarBox/index.js","HistorySidebarBox/index.js","utils/get-hotkey-help-text.js","ClassSelectionMenu/index.js","MainLayout/index.js","Annotator/reducers/history-handler.js","Annotator/reducers/convert-expanding-line-to-polygon.js","utils/get-landmarks-with-transform.js","Annotator/reducers/general-reducer.js","utils/set-in-local-storage.js","Annotator/reducers/image-reducer.js","Annotator/reducers/video-reducer.js","Annotator/index.js","utils/get-from-local-storage.js","Annotator/reducers/combine-reducers.js","DemoSite/ErrorBoundaryDialog.js","DemoSite/index.js","LandingPage/index.js","index.js"],"names":["useStyles","makeStyles","container","fontFamily","theme","createMuiTheme","typography","overrides","MuiButton","root","textTransform","Theme","children","classes","ThemeProvider","className","editBar","padding","borderBottom","backgroundColor","display","alignItems","margin","select","width","fontSize","contentArea","specificationArea","loadSavedInput","JSON","parse","window","localStorage","getItem","e","examples","taskDescription","regionTagList","regionClsList","enabledTools","images","src","name","allowComments","Custom","Editor","onOpenAnnotator","lastOutput","c","useState","currentError","changeCurrentError","selectedExample","changeSelectedExample","outputDialogOpen","changeOutputOpen","stringify","currentJSONValue","changeCurrentJSONValue","style","flexGrow","value","label","options","Object","keys","map","s","onChange","selectedOption","Button","disabled","onClick","variant","Boolean","border","language","code","setItem","toString","height","Dialog","fullScreen","open","DialogTitle","DialogContent","minWidth","DialogActions","Crosshairs","mousePosition","x","y","changeForceRenderState","current","useEffect","interval","setInterval","clearInterval","position","zIndex","left","pointerEvents","top","Container","styled","PreventScrollToParents","otherProps","mouseOver","changeMouseOver","onMouseMove","useEventCallback","onMouseLeave","setTimeout","enabled","removeScrollBar","useWindowSize","initialWidth","Infinity","initialHeight","isClient","useRafState","innerWidth","innerHeight","state","setState","handler","addEventListener","removeEventListener","useInterval","canvasEl","changeMat","changeDragging","zoomStart","changeZoomStart","zoomEnd","changeZoomEnd","layoutParams","zoomWithPrimary","dragWithPrimary","mat","onMouseUp","onMouseDown","dragging","useRef","prevMousePosition","zoomIn","direction","point","mx","my","scale","to","a","translate","scaleU","clone","mouseEvents","getBoundingClientRect","clientX","clientY","projMouse","applyToPoint","iw","ih","preventDefault","specialEvent","button","type","Math","abs","min","newMat","Matrix","from","onWheel","deltaY","onContextMenu","r","bbox","region","box","points","w","h","max","minX","values","minY","x1","y1","Error","getEnclosingBox","cbox","inverse","d","Svg","fill","vectorEffect","strokeWidth","opacity","stroke","strokeDasharray","animationDuration","animationTimingFunction","animationIterationCount","animationPlayState","PointDistances","projectRegionBox","regions","pointDistancePrecision","realSize","filter","r1","flatMap","i1","r2","i2","displayDistance","pr1","pr2","prm","unitName","sqrt","pow","toFixed","regionInfo","cursor","transition","fontWeight","color","grey","flexDirection","marginRight","boxShadow","borderRadius","textDecoration","commentBox","styles","memo","editing","allowedClasses","allowedTags","onDelete","onClose","onOpen","onRegionClassAdded","commentInputRef","Paper","classnames","highlighted","paddingLeft","paddingRight","textShadow","IconButton","tabIndex","size","marginTop","length","placeholder","o","actionMeta","action","cls","asMutable","newTags","tags","t","isMulti","TextField","InputProps","fullWidth","multiline","rows","ref","_","commentInput","focus","comment","event","target","key","prevProps","nextProps","RegionTags","onBeginRegionEdit","onChangeRegion","onCloseRegionEdit","onDeleteRegion","imageSrc","RegionEditLabel","RegionLabel","DefaultRegionLabel","visible","undefined","pbox","labelBoxHeight","editingLabels","locked","displayOnTop","coords","id","bottom","paddingBottom","onMouseEnter","obj","newObj","args","arg","copyWithout","colors","muiColors","rrggbb","bbggrr","replace","substr","parseInt","reverseParseColor","loadImage","image","Array","document","getElementsByTagName","find","img","canvas","createElement","ctx","getContext","Image","crossOrigin","Promise","resolve","reject","onload","naturalWidth","naturalHeight","drawImage","imageData","getImageData","ImageMask","imagePosition","hide","autoSegmentationOptions","canvasRef","setCanvasRef","sampleImageData","setSampleImageData","then","autoseg","setConfig","classNames","useDebounce","cp","udtRegions","regionType","classification","centerX","centerY","convertToUDTRegions","getMask","maskImageData","context","clearRect","putImageData","useMemo","bottomRight","topLeft","imageRendering","transform","isNaN","strokeDashoffset","highlightBox","animationName","HighlightBox","createWithPrimary","onBeginMovePoint","onSelectRegion","unfinished","styleCoords","pathD","TransformGrabber","boxCursorMap","RegionSelectAndTransformBox","fullImageSegmentationMode","onBeginBoxTransform","onBeginMovePolygonPoint","onBeginMoveKeypoint","onAddPolygonPoint","showHighlightBox","i","px","py","proj","p1","p2","pa","entries","keypointId","Tooltip","title","prev","next","RegionSelectAndTransformBoxes","props","n","p","SettingsContext","createContext","showCrosshairs","wasdMode","useSettings","useContext","SettingsProvider","settings","startsWith","pullSettingsFromLocalStorage","changeState","Provider","changeSetting","setting","Video","StyledImage","right","whiteSpace","videoTime","videoSrc","onLoad","useCrossOrigin","videoPlaying","onChangeVideoTime","onChangeVideoPlaying","videoRef","imageRef","error","setError","currentTime","renderLoopRunning","play","videoPlaybackSpeed","playbackRate","parseFloat","pause","checkForNewFrame","newVideoTime","floor","paused","requestAnimationFrame","onLoadedVideoMetadata","videoElm","currentTarget","videoWidth","videoHeight","duration","onImageLoaded","imageElm","onImageError","stylePosition","onError","onLoadedMetadata","clamp","num","RegionComponents","line","x2","y2","colorAlpha","polygon","Component","fullSegmentationMode","join","keypoints","keypointDefinitions","keypointsDefinitionId","landmarks","connections","kp1Id","kp2Id","kp1","kp2","midPoint","expandingWidth","slice","pointPairs","angle","atan2","PI","dx","sin","dy","cos","firstSection","secondSection","reverse","lastPoint","concat","candidatePoint","pixel","WrappedRegionList","regionId","RegionShapes","zoomIndicator","fixedRegionLabel","getDefaultMat","allowedArea","ImageCanvas","showTags","showPointDistances","showMask","onImageOrVideoLoaded","zoomOnAllowedArea","modifyingAllowedArea","windowSize","getLatestMat","dirs","keysDown","keyDownListener","includes","stopPropagation","keyUpListener","somethingChanged","useWasdMode","useMouse","useLayoutEffect","useProjectRegionBox","imageDimensions","changeImageDimensions","imageLoaded","onVideoOrImageLoaded","dims","excludePattern","pattern","createPattern","useExcludePattern","clientWidth","clientHeight","fitScale","canvasWidth","canvasHeight","save","toArray","globalAlpha","outer","inner","moveTo","forEach","lineTo","closePath","fillStyle","restore","zoomBox","highlightedRegion","highlightedRegions","maxHeight","overflow","disableClose","VideoOrImageCanvasBackground","headerTitle","SettingsDialog","noActions","defaultAnswers","onQuestionChange","q","answers","form","questions","defaultValue","choices","pathToActiveImage","activeImage","currentImageIndex","annotationType","selectedImage","getIn","currentVideoTime","emptyArr","keyframes","time","keyframeTimes","sort","b","nextKeyframeTimeIndex","findIndex","kt","t1","prevKeyframe","t2","nextKeyframe","prevRegionMap","nextRegionMap","impliedRegions","w1","w2","push","pp","newPoints","pointId","prevPoint","defaultKeyMap","description","binding","useDispatchHotkeyHandlers","dispatch","select_tool","selectedTool","zoom_tool","create_point","create_bounding_box","pan_tool","create_polygon","create_pixel","save_and_previous_sample","buttonName","save_and_next_sample","save_and_exit_sample","delete_region","undo","faStyle","marginBottom","iconDictionary","fixedWidth","icon","faMousePointer","pan","faHandPaper","zoom","faSearch","faTag","faCrosshairs","faVectorSquare","faDrawPolygon","faGripLines","faChartLine","faMask","faEdit","AccessibilityNewIcon","FullscreenIcon","getTimeString","ms","precision","secs","Number","isInteger","mins","marginLeft","Tick","TickText","userSelect","PositionCursor","placeItems","fontVariantNumeric","content","borderTop","borderLeft","borderRight","KeyframeMarker","borderTopLeftRadius","borderTopRightRadius","displayIntervalPairs","onChangeCurrentTime","useMeasure","bounds","instantCurrentTime","changeInstantCurrentTime","draggingTime","changeDraggingTime","minor","major","getMajorInterval","minorInterval","majorInterval","newTime","range","header","expandButton","expandedContent","overflowY","subTitle","noScroll","expandedByDefault","expanded","changeExpanded","SidebarBox","DebugSidebarBox","lastAction","mode","selectedImageFrameTime","noop","currentImage","imageClsList","imageTagList","onChangeImage","onChangeClassification","onChangeTags","selectValue","memoImgClsList","memoImgTagList","memoCurrentTags","paddingTop","KeyframeRow","KeyframesSelectorSidebarBox","onDeleteKeyframe","MarkdownContainer","source","row","blue","chip","HeaderSep","Chip","text","RowLayout","order","area","trash","lock","Grid","item","xs","textAlign","MemoRowHeader","MemoRow","index","mapUsedRegionProperties","isEqual","mapUsedImageProps","onSelect","List","ListItem","dense","ListItemText","primary","secondary","emptyText","listItemTextStyle","history","onRestoreHistory","moment","format","ListItemSecondaryAction","getHotkeyHelpText","commandName","firstSequence","getApplicationKeyMap","sequences","sequence","LabelContainer","Circle","Label","DashSep","ClassSelectionMenu","selectedCls","onSelectCls","keyMapping","onKeyDown","selected","capitalize","Box","pb","HotkeyDiv","withHotKeys","hotKeys","divRef","FullScreenContainer","MainLayout","nextImage","alwaysShowNextButton","alwaysShowPrevButton","hideHeader","hideHeaderText","hideNext","hidePrev","fullScreenHandle","useFullScreenHandle","memoizedActionFns","params","fnKey","fn","reduce","acc","getActiveImage","useKey","detectKeys","frameTime","innerContainerRef","hotkeyHandlers","impliedVideoRegions","getImpliedVideoRegions","useImpliedVideoRegions","refocusOnMouseEvent","useCallback","contains","activeElement","onClickIconSidebarItem","onClickHeaderItem","enter","exit","debugModeOn","$ANNOTATE_DEBUG_MODE","nextImageHasRegions","handle","onMouseOver","allowChanges","handlers","Workspace","allowFullscreen","headerLeftSide","KeyframeTimeline","videoDuration","headerItems","selectedTools","iconSidebarItems","helperText","alwaysShowing","rightSidebarItems","labelImages","settingsOpen","typesToSaveWithHistory","BEGIN_BOX_TRANSFORM","BEGIN_MOVE_POINT","DELETE_REGION","saveToHistory","updateIn","toDate","without","expandingLine","center","defaultPosition","getRandomId","random","split","aa","oldRegionClsList","Date","now","lastMouseMoveCall","setIn","getRegionIndex","regionIndex","getRegion","modifyRegion","closeEditors","setNewImage","imageIndex","oldRegion","clsIndex","indexOf","delta","directions","freedom","original","pointIndex","splice","mouseDownAt","moveRegion","xFree","yFree","ox","oy","ow","oh","dw","dh","distFromCenter","getLandmarksWithTransform","mouseDistFromLastPoint","newRegion","convertExpandingLineToPolygon","defaultRegionCls","defaultRegionColor","editLabelEditorAfter","isNew","newExpandingLine","newRegions","toLowerCase","val","setInLocalStorage","some","metadata","copyImpliedRegions","isPlaying","Annotator","getFromLocalStorage","videoName","onExit","onNextImage","onPrevImage","reducer","useReducer","reducers","combineReducers","imageReducer","videoReducer","generalReducer","prevState","nextState","makeImmutable","dispatchToReducer","ErrorBoundaryDialog","hasError","err","info","this","componentStack","annotatorOpen","changeAnnotatorOpen","annotatorProps","changeAnnotatorProps","changeLastOutput","output","RootContainer","ContentContainer","boxSizing","maxWidth","Header","justifyContent","HeaderButton","Hero","HeroMain","HeroSub","lineHeight","HeroButtons","Section","CodeBlock","docco","flatten","child","React","Children","HeadingRenderer","slug","level","LandingPage","href","data-size","data-show-count","aria-label","escapeHtml","renderers","heading","Site","path","location","pathname","DemoSite","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.018dea86.chunk.js","sourcesContent":["// @flow\n\nimport React from \"react\"\nimport {\n  ThemeProvider,\n  createMuiTheme,\n  makeStyles,\n} from \"@material-ui/core/styles\"\n\nconst useStyles = makeStyles({\n  container: {\n    fontFamily: '\"Inter\", sans-serif',\n  },\n})\n\nconst theme = createMuiTheme({\n  typography: {\n    fontFamily: '\"Inter\", \"Roboto\", sans-serif',\n  },\n  overrides: {\n    MuiButton: {\n      root: {\n        textTransform: \"none\",\n      },\n    },\n  },\n})\n\nexport const Theme = ({ children }: any) => {\n  const classes = useStyles()\n  return (\n    <ThemeProvider theme={theme}>\n      <div className={classes.container}>{children}</div>\n    </ThemeProvider>\n  )\n}\n\nexport default Theme\n","// @flow\n\nimport React, { useState } from \"react\"\nimport Button from \"@material-ui/core/Button\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport Select from \"react-select\"\nimport Code from \"react-syntax-highlighter\"\nimport Dialog from \"@material-ui/core/Dialog\"\nimport DialogTitle from \"@material-ui/core/DialogTitle\"\nimport DialogContent from \"@material-ui/core/DialogContent\"\nimport DialogActions from \"@material-ui/core/DialogActions\"\nimport MonacoEditor from \"react-monaco-editor\"\n\nconst useStyles = makeStyles({\n  editBar: {\n    padding: 10,\n    borderBottom: \"1px solid #ccc\",\n    backgroundColor: \"#f8f8f8\",\n    display: \"flex\",\n    alignItems: \"center\",\n    \"& .button\": { margin: 5 },\n  },\n  select: { width: 240, fontSize: 14 },\n  contentArea: {\n    padding: 10,\n  },\n  specificationArea: {\n    padding: 10,\n  },\n})\n\nconst loadSavedInput = () => {\n  try {\n    return JSON.parse(window.localStorage.getItem(\"customInput\") || \"{}\")\n  } catch (e) {\n    return {}\n  }\n}\n\nexport const examples = {\n  \"Simple Bounding Box\": () => ({\n    taskDescription:\n      \"Annotate each image according to this _markdown_ specification.\",\n    // regionTagList: [],\n    // regionClsList: [\"hotdog\"],\n    regionTagList: [\"has-bun\"],\n    regionClsList: [\"hotdog\", \"not-hotdog\"],\n    enabledTools: [\"select\", \"create-box\"],\n    // showTags: true,\n    images: [\n      {\n        src:\n          \"https://images.unsplash.com/photo-1496905583330-eb54c7e5915a?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=634&q=80\",\n        name: \"hot-dogs-1\",\n      },\n      {\n        src:\n          \"https://www.bianchi.com/wp-content/uploads/2019/07/YPB17I555K.jpg\",\n        name: \"bianchi-oltre-xr4\",\n      },\n    ],\n    allowComments: true,\n  }),\n  \"Simple Segmentation\": () => ({\n    taskDescription:\n      \"Annotate each image according to this _markdown_ specification.\",\n    regionClsList: [\"car\", \"truck\"],\n    enabledTools: [\"select\", \"create-polygon\"],\n    images: [\n      {\n        src:\n          \"https://images.unsplash.com/photo-1561518776-e76a5e48f731?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=750&q=80\",\n        name: \"car-image-1\",\n      },\n    ],\n  }),\n  Custom: () => loadSavedInput(),\n}\n\nconst Editor = ({ onOpenAnnotator, lastOutput }: any) => {\n  const c = useStyles()\n  const [currentError, changeCurrentError] = useState()\n  const [selectedExample, changeSelectedExample] = useState(\n    window.localStorage.getItem(\"customInput\")\n      ? \"Custom\"\n      : \"Simple Bounding Box\"\n  )\n  const [outputDialogOpen, changeOutputOpen] = useState(false)\n  const [currentJSONValue, changeCurrentJSONValue] = useState(\n    JSON.stringify(examples[selectedExample](), null, \"  \")\n  )\n  return (\n    <div>\n      <div className={c.editBar}>\n        <h3>React Image Annotate</h3>\n        <div style={{ flexGrow: 1 }} />\n        <div>\n          <div style={{ display: \"inline-flex\" }}>\n            <Select\n              className={c.select}\n              value={{ label: selectedExample, value: selectedExample }}\n              options={Object.keys(examples).map((s) => ({\n                label: s,\n                value: s,\n              }))}\n              onChange={(selectedOption) => {\n                changeSelectedExample(selectedOption.value)\n\n                changeCurrentJSONValue(\n                  JSON.stringify(\n                    selectedOption.value === \"Custom\"\n                      ? loadSavedInput()\n                      : examples[selectedOption.value](),\n                    null,\n                    \"  \"\n                  )\n                )\n              }}\n            />\n          </div>\n          <Button\n            className=\"button\"\n            disabled={!lastOutput}\n            onClick={() => changeOutputOpen(true)}\n          >\n            View Output\n          </Button>\n          <Button\n            className=\"button\"\n            variant=\"outlined\"\n            disabled={Boolean(currentError)}\n            onClick={() => {\n              onOpenAnnotator(\n                selectedExample === \"Custom\"\n                  ? loadSavedInput()\n                  : examples[selectedExample]\n              )\n            }}\n          >\n            Open Annotator\n          </Button>\n        </div>\n      </div>\n      <div\n        className={c.contentArea}\n        style={\n          currentError\n            ? { border: \"2px solid #f00\" }\n            : { border: \"2px solid #fff\" }\n        }\n      >\n        <div>\n          <MonacoEditor\n            value={currentJSONValue}\n            language=\"javascript\"\n            onChange={(code) => {\n              try {\n                window.localStorage.setItem(\n                  \"customInput\",\n                  JSON.stringify(JSON.parse(code))\n                )\n                changeCurrentError(null)\n              } catch (e) {\n                changeCurrentError(e.toString())\n              }\n              changeCurrentJSONValue(code)\n            }}\n            width=\"100%\"\n            height=\"550px\"\n          />\n        </div>\n      </div>\n      <div className={c.specificationArea}>\n        <h2>React Image Annotate Format</h2>\n        <Code language=\"javascript\">{`\n{\n  taskDescription?: string, // markdown\n  regionTagList?: Array<string>,\n  regionClsList?: Array<string>,\n  imageTagList?: Array<string>,\n  imageClsList?: Array<string>,\n  // all tools are enabled by default\n  enabledTools?: Array< \"select\" | \"create-point\" | \"create-box\" | \"create-polygon\" | \"create-line\">,\n  selectedImage?: string, // initial selected image\n  images: Array<{\n    src: string,\n    thumbnailSrc?: string, // use this if you are using high-res images\n    name: string,\n    regions?: Array<{\n      id: string | number,\n      cls?: string,\n      color?: string,\n      tags?: Array<string>,\n\n      // Point\n      type: \"point\",\n      x: number, // [0-1] % of image width\n      y: number, // [0-1] % of image height\n\n      // Bounding Box\n      type: \"box\",\n      x: number, // [0-1] % of image width\n      y: number, // [0-1] % of image height\n      w: number, // [0-1] % of image width\n      h: number, // [0-1] % of image height\n\n      // Polygon\n      type: \"polygon\",\n      open?: boolean, // should last and first points be connected, default: true\n      points: Array<[number, number]> // [0-1] % of image width/height\n    }>\n  }>,\n}\n`}</Code>\n      </div>\n      <Dialog fullScreen open={outputDialogOpen}>\n        <DialogTitle>React Image Annotate Output</DialogTitle>\n        <DialogContent style={{ minWidth: 400 }}>\n          <MonacoEditor\n            value={JSON.stringify(lastOutput, null, \"  \")}\n            language=\"javascript\"\n            width=\"100%\"\n            height=\"550px\"\n          />\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => changeOutputOpen(false)}>Close</Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  )\n}\n\nexport default Editor\n","// @flow\n\nimport React, { Fragment, useEffect, useState } from \"react\"\n\nexport const Crosshairs = ({\n  mousePosition,\n  x,\n  y,\n}: {\n  mousePosition: { current: { x: number, y: number } },\n  x?: number,\n  y?: number,\n}) => {\n  const [forceRenderState, changeForceRenderState] = useState()\n\n  if (mousePosition) {\n    x = mousePosition.current.x\n    y = mousePosition.current.y\n  }\n\n  useEffect(() => {\n    if (!mousePosition) return\n    const interval = setInterval(() => {\n      if (x !== mousePosition.current.x || y !== mousePosition.current.y) {\n        changeForceRenderState([\n          mousePosition.current.x,\n          mousePosition.current.y,\n        ])\n      }\n    }, 10)\n    return () => clearInterval(interval)\n  })\n\n  return (\n    <Fragment>\n      <div\n        style={{\n          position: \"absolute\",\n          height: \"100%\",\n          width: 1,\n          zIndex: 10,\n          backgroundColor: \"#f00\",\n          left: x,\n          pointerEvents: \"none\",\n          top: 0,\n        }}\n      />\n      <div\n        style={{\n          position: \"absolute\",\n          width: \"100%\",\n          zIndex: 10,\n          height: 1,\n          backgroundColor: \"#f00\",\n          top: y,\n          pointerEvents: \"none\",\n          left: 0,\n        }}\n      />\n    </Fragment>\n  )\n}\n\nexport default Crosshairs\n","// @flow\n\nimport React, { useState } from \"react\"\nimport { RemoveScroll } from \"react-remove-scroll\"\nimport { styled } from \"@material-ui/core/styles\"\nimport useEventCallback from \"use-event-callback\"\n\nconst Container = styled(\"div\")({\n  \"& > div\": {\n    width: \"100%\",\n    height: \"100%\",\n  },\n})\n\nexport const PreventScrollToParents = ({ children, ...otherProps }) => {\n  const [mouseOver, changeMouseOver] = useState(false)\n  const onMouseMove = useEventCallback((e) => {\n    if (!mouseOver) changeMouseOver(true)\n    if (otherProps.onMouseMove) {\n      otherProps.onMouseMove(e)\n    }\n  })\n  const onMouseLeave = useEventCallback((e) => {\n    setTimeout(() => {\n      if (mouseOver) {\n        changeMouseOver(false)\n      }\n    }, 100)\n  })\n\n  return (\n    <Container\n      {...otherProps}\n      onMouseMove={onMouseMove}\n      onMouseLeave={onMouseLeave}\n    >\n      <RemoveScroll enabled={mouseOver} removeScrollBar={false}>\n        {children}\n      </RemoveScroll>\n    </Container>\n  )\n}\n\nexport default PreventScrollToParents\n","// @flow\n\nimport { useEffect } from \"react\"\n\nimport { useRafState, useInterval } from \"react-use\"\n\nconst useWindowSize = (initialWidth = Infinity, initialHeight = Infinity) => {\n  const isClient = typeof window !== \"undefined\"\n  const [state, setState] = useRafState({\n    width: isClient ? window.innerWidth : initialWidth,\n    height: isClient ? window.innerHeight : initialHeight,\n  })\n\n  useEffect(() => {\n    if (!isClient) return\n    const handler = () => {\n      setState({\n        width: window.innerWidth,\n        height: window.innerHeight,\n      })\n    }\n\n    window.addEventListener(\"resize\", handler)\n\n    return () => {\n      window.removeEventListener(\"resize\", handler)\n    }\n  }, [])\n\n  useInterval(() => {\n    if (!isClient) return\n    if (\n      window.innerWidth !== state.width ||\n      window.innerHeight !== state.height\n    ) {\n      setState({\n        width: window.innerWidth,\n        height: window.innerHeight,\n      })\n    }\n  }, 100)\n\n  return state\n}\n\nexport default useWindowSize\n","// @flow weak\n\nimport { useRef } from \"react\"\nimport { Matrix } from \"transformation-matrix-js\"\n\nconst getDefaultMat = () => Matrix.from(1, 0, 0, 1, -10, -10)\n\nexport default ({\n  canvasEl,\n  changeMat,\n  changeDragging,\n  zoomStart,\n  zoomEnd,\n  changeZoomStart,\n  changeZoomEnd,\n  layoutParams,\n  zoomWithPrimary,\n  dragWithPrimary,\n  mat,\n  onMouseMove,\n  onMouseUp,\n  onMouseDown,\n  dragging,\n}) => {\n  const mousePosition = useRef({ x: 0, y: 0 })\n  const prevMousePosition = useRef({ x: 0, y: 0 })\n\n  const zoomIn = (direction, point) => {\n    const [mx, my] = [point.x, point.y]\n    let scale =\n      typeof direction === \"object\" ? direction.to / mat.a : 1 + 0.2 * direction\n\n    // NOTE: We're mutating mat here\n    mat.translate(mx, my).scaleU(scale)\n    if (mat.a > 2) mat.scaleU(2 / mat.a)\n    if (mat.a < 0.05) mat.scaleU(0.05 / mat.a)\n    mat.translate(-mx, -my)\n\n    changeMat(mat.clone())\n  }\n\n  const mouseEvents = {\n    onMouseMove: (e) => {\n      const { left, top } = canvasEl.current.getBoundingClientRect()\n      prevMousePosition.current.x = mousePosition.current.x\n      prevMousePosition.current.y = mousePosition.current.y\n      mousePosition.current.x = e.clientX - left\n      mousePosition.current.y = e.clientY - top\n\n      const projMouse = mat.applyToPoint(\n        mousePosition.current.x,\n        mousePosition.current.y\n      )\n\n      if (zoomWithPrimary && zoomStart) {\n        changeZoomEnd(projMouse)\n      }\n\n      const { iw, ih } = layoutParams.current\n      onMouseMove({ x: projMouse.x / iw, y: projMouse.y / ih })\n\n      if (dragging) {\n        mat.translate(\n          prevMousePosition.current.x - mousePosition.current.x,\n          prevMousePosition.current.y - mousePosition.current.y\n        )\n\n        changeMat(mat.clone())\n      }\n      e.preventDefault()\n    },\n    onMouseDown: (e, specialEvent = {}) => {\n      e.preventDefault()\n\n      if (\n        e.button === 1 ||\n        e.button === 2 ||\n        (e.button === 0 && dragWithPrimary)\n      )\n        return changeDragging(true)\n\n      const projMouse = mat.applyToPoint(\n        mousePosition.current.x,\n        mousePosition.current.y\n      )\n      if (zoomWithPrimary && e.button === 0) {\n        changeZoomStart(projMouse)\n        changeZoomEnd(projMouse)\n        return\n      }\n      if (e.button === 0) {\n        if (specialEvent.type === \"resize-box\") {\n          // onResizeBox()\n        }\n        if (specialEvent.type === \"move-region\") {\n          // onResizeBox()\n        }\n        const { iw, ih } = layoutParams.current\n        onMouseDown({ x: projMouse.x / iw, y: projMouse.y / ih })\n      }\n    },\n    onMouseUp: (e) => {\n      e.preventDefault()\n      const projMouse = mat.applyToPoint(\n        mousePosition.current.x,\n        mousePosition.current.y\n      )\n      if (zoomStart) {\n        const zoomEnd = projMouse\n        if (\n          Math.abs(zoomStart.x - zoomEnd.x) < 10 &&\n          Math.abs(zoomStart.y - zoomEnd.y) < 10\n        ) {\n          if (mat.a < 1) {\n            zoomIn({ to: 1 }, mousePosition.current)\n          } else {\n            zoomIn({ to: 0.25 }, mousePosition.current)\n          }\n        } else {\n          const { iw, ih } = layoutParams.current\n\n          if (zoomStart.x > zoomEnd.x) {\n            ;[zoomStart.x, zoomEnd.x] = [zoomEnd.x, zoomStart.x]\n          }\n          if (zoomStart.y > zoomEnd.y) {\n            ;[zoomStart.y, zoomEnd.y] = [zoomEnd.y, zoomStart.y]\n          }\n\n          // The region defined by zoomStart and zoomEnd should be the new transform\n          let scale = Math.min(\n            (zoomEnd.x - zoomStart.x) / iw,\n            (zoomEnd.y - zoomStart.y) / ih\n          )\n          if (scale < 0.05) scale = 0.05\n          if (scale > 10) scale = 10\n\n          const newMat = getDefaultMat()\n            .translate(zoomStart.x, zoomStart.y)\n            .scaleU(scale)\n\n          changeMat(newMat.clone())\n        }\n\n        changeZoomStart(null)\n        changeZoomEnd(null)\n      }\n      if (\n        e.button === 1 ||\n        e.button === 2 ||\n        (e.button === 0 && dragWithPrimary)\n      )\n        return changeDragging(false)\n      if (e.button === 0) {\n        const { iw, ih } = layoutParams.current\n        onMouseUp({ x: projMouse.x / iw, y: projMouse.y / ih })\n      }\n    },\n    onWheel: (e) => {\n      const direction = e.deltaY > 0 ? 1 : e.deltaY < 0 ? -1 : 0\n      zoomIn(direction, mousePosition.current)\n      // e.preventDefault()\n    },\n    onContextMenu: (e) => {\n      e.preventDefault()\n    },\n  }\n  return { mouseEvents, mousePosition }\n}\n","// @flow weak\nimport useEventCallback from \"use-event-callback\"\nimport { getEnclosingBox } from \"./region-tools.js\"\n\nexport default ({ layoutParams, mat }) => {\n  return useEventCallback((r) => {\n    const { iw, ih } = layoutParams.current\n    const bbox = getEnclosingBox(r)\n    const margin = r.type === \"point\" ? 15 : 2\n    const cbox = {\n      x: bbox.x * iw - margin,\n      y: bbox.y * ih - margin,\n      w: bbox.w * iw + margin * 2,\n      h: bbox.h * ih + margin * 2,\n    }\n    const pbox = {\n      ...mat.clone().inverse().applyToPoint(cbox.x, cbox.y),\n      w: cbox.w / mat.a,\n      h: cbox.h / mat.d,\n    }\n    return pbox\n  })\n}\n","// @flow\n\nexport type BaseRegion = {\n  id: string | number,\n  cls?: string,\n  locked?: boolean,\n  visible?: boolean,\n  color: string,\n  editingLabels?: boolean,\n  highlighted?: boolean,\n  tags?: Array<string>,\n}\n\nexport type Point = {|\n  ...$Exact<BaseRegion>,\n  type: \"point\",\n  x: number,\n  y: number,\n|}\n\nexport type PixelRegion =\n  | {|\n      ...$Exact<BaseRegion>,\n      type: \"pixel\",\n      sx: number,\n      sy: number,\n      w: number,\n      h: number,\n      src: string,\n    |}\n  | {|\n      ...$Exact<BaseRegion>,\n      type: \"pixel\",\n      points: Array<[number, number]>,\n    |}\nexport type Box = {|\n  ...$Exact<BaseRegion>,\n  type: \"box\",\n  x: number,\n  y: number,\n  w: number,\n  h: number,\n|}\n\nexport type Polygon = {|\n  ...$Exact<BaseRegion>,\n  type: \"polygon\",\n  open?: boolean,\n  points: Array<[number, number]>,\n|}\n\nexport type Line = {|\n  ...$Exact<BaseRegion>,\n  type: \"line\",\n  x1: number,\n  y1: number,\n  x2: number,\n  y2: number,\n|}\n\nexport type ExpandingLine = {|\n  ...$Exact<BaseRegion>,\n  type: \"expanding-line\",\n  points: Array<{ x: number, y: number, angle: number, width: number }>,\n|}\n\nexport type KeypointDefinition = {|\n  label: string,\n  color: string,\n  defaultPosition: [number, number],\n|}\n\nexport type KeypointId = string\n\nexport type KeypointsDefinition = {|\n  [id: string]: {\n    connections: Array<[KeypointId, KeypointId]>,\n    landmarks: {\n      [KeypointId]: KeypointDefinition,\n    },\n  },\n|}\n\nexport type Keypoints = {|\n  ...$Exact<BaseRegion>,\n  type: \"keypoints\",\n  keypointsDefinitionId: string,\n  points: {\n    [string]: { x: number, y: number },\n  },\n|}\n\nexport type Region =\n  | Point\n  | PixelRegion\n  | Box\n  | Polygon\n  | ExpandingLine\n  | Keypoints\n\nexport const getEnclosingBox = (region: Region) => {\n  switch (region.type) {\n    case \"polygon\": {\n      const box = {\n        x: Math.min(...region.points.map(([x, y]) => x)),\n        y: Math.min(...region.points.map(([x, y]) => y)),\n        w: 0,\n        h: 0,\n      }\n      box.w = Math.max(...region.points.map(([x, y]) => x)) - box.x\n      box.h = Math.max(...region.points.map(([x, y]) => y)) - box.y\n      return box\n    }\n    case \"keypoints\": {\n      const minX = Math.min(\n        ...Object.values(region.points).map(({ x, y }) => x)\n      )\n      const minY = Math.min(\n        ...Object.values(region.points).map(({ x, y }) => y)\n      )\n      const maxX = Math.max(\n        ...Object.values(region.points).map(({ x, y }) => x)\n      )\n      const maxY = Math.max(\n        ...Object.values(region.points).map(({ x, y }) => y)\n      )\n      return {\n        x: minX,\n        y: minY,\n        w: maxX - minX,\n        h: maxY - minY,\n      }\n    }\n    case \"expanding-line\": {\n      const box = {\n        x: Math.min(...region.points.map(({ x, y }) => x)),\n        y: Math.min(...region.points.map(({ x, y }) => y)),\n        w: 0,\n        h: 0,\n      }\n      box.w = Math.max(...region.points.map(({ x, y }) => x)) - box.x\n      box.h = Math.max(...region.points.map(({ x, y }) => y)) - box.y\n      return box\n    }\n    case \"line\": {\n      return { x: region.x1, y: region.y1, w: 0, h: 0 }\n    }\n    case \"box\": {\n      return { x: region.x, y: region.y, w: region.w, h: region.h }\n    }\n    case \"point\": {\n      return { x: region.x, y: region.y, w: 0, h: 0 }\n    }\n    default: {\n      return { x: 0, y: 0, w: 0, h: 0 }\n    }\n  }\n  throw new Error(\"unknown region\")\n}\n\nexport const moveRegion = (region: Region, x: number, y: number) => {\n  switch (region.type) {\n    case \"point\": {\n      return { ...region, x, y }\n    }\n    case \"box\": {\n      return { ...region, x: x - region.w / 2, y: y - region.h / 2 }\n    }\n  }\n  return region\n}\n","// @flow weak\n\nimport React, { Fragment } from \"react\"\nimport { styled } from \"@material-ui/core/styles\"\n\nconst Svg = styled(\"svg\")({\n  pointerEvents: \"none\",\n  position: \"absolute\",\n  zIndex: 1,\n  left: 0,\n  top: 0,\n  width: \"100%\",\n  height: \"100%\",\n  \"& text\": {\n    fill: \"#fff\",\n  },\n  \"& path\": {\n    vectorEffect: \"non-scaling-stroke\",\n    strokeWidth: 2,\n    opacity: 0.5,\n    stroke: \"#FFF\",\n    fill: \"none\",\n    strokeDasharray: 5,\n    animationDuration: \"4s\",\n    animationTimingFunction: \"linear\",\n    animationIterationCount: \"infinite\",\n    animationPlayState: \"running\",\n  },\n})\n\nexport const PointDistances = ({\n  projectRegionBox,\n  regions,\n  pointDistancePrecision,\n  realSize,\n}) => {\n  return (\n    <Svg>\n      {regions\n        .filter((r1) => r1.type === \"point\")\n        .flatMap((r1, i1) =>\n          regions\n            .filter((r2, i2) => i2 > i1)\n            .filter((r2) => r2.type === \"point\")\n            .map((r2) => {\n              const pr1 = projectRegionBox(r1)\n              const pr2 = projectRegionBox(r2)\n              const prm = {\n                x: (pr1.x + pr1.w / 2 + pr2.x + pr2.w / 2) / 2,\n                y: (pr1.y + pr1.h / 2 + pr2.y + pr2.h / 2) / 2,\n              }\n              let displayDistance\n              if (realSize) {\n                const { w, h, unitName } = realSize\n                displayDistance =\n                  Math.sqrt(\n                    Math.pow(r1.x * w - r2.x * w, 2) +\n                      Math.pow(r1.y * h - r2.y * h, 2)\n                  ).toFixed(pointDistancePrecision) + unitName\n              } else {\n                displayDistance =\n                  (\n                    Math.sqrt(\n                      Math.pow(r1.x - r2.x, 2) + Math.pow(r1.y - r2.y, 2)\n                    ) * 100\n                  ).toFixed(pointDistancePrecision) + \"%\"\n              }\n              return (\n                <Fragment>\n                  <path\n                    d={`M${pr1.x + pr1.w / 2},${pr1.y + pr1.h / 2} L${\n                      pr2.x + pr2.w / 2\n                    },${pr2.y + pr2.h / 2}`}\n                  />\n                  <text x={prm.x} y={prm.y}>\n                    {displayDistance}\n                  </text>\n                </Fragment>\n              )\n            })\n        )}\n    </Svg>\n  )\n}\n\nexport default PointDistances\n","// @flow\n\nimport { grey } from \"@material-ui/core/colors\"\n\nexport default {\n  regionInfo: {\n    fontSize: 12,\n    cursor: \"default\",\n    transition: \"opacity 200ms\",\n    opacity: 0.5,\n    \"&:hover\": {\n      opacity: 0.9,\n      cursor: \"pointer\",\n    },\n    \"&.highlighted\": {\n      opacity: 0.9,\n      \"&:hover\": {\n        opacity: 1,\n      },\n    },\n    // pointerEvents: \"none\",\n    fontWeight: 600,\n    color: grey[900],\n    padding: 8,\n    \"& .name\": {\n      display: \"flex\",\n      flexDirection: \"row\",\n      alignItems: \"center\",\n      \"& .circle\": {\n        marginRight: 4,\n        boxShadow: \"0px 0px 2px rgba(0,0,0,0.4)\",\n        width: 10,\n        height: 10,\n        borderRadius: 5,\n      },\n    },\n    \"& .tags\": {\n      \"& .tag\": {\n        color: grey[700],\n        display: \"inline-block\",\n        margin: 1,\n        fontSize: 10,\n        textDecoration: \"underline\",\n      },\n    },\n  },\n  commentBox: {\n    fontWeight: 400,\n    fontSize: 13,\n  },\n}\n","// @flow\n\nimport React, { useRef, memo } from \"react\"\nimport Paper from \"@material-ui/core/Paper\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport styles from \"./styles\"\nimport classnames from \"classnames\"\nimport type { Region } from \"../ImageCanvas/region-tools.js\"\nimport IconButton from \"@material-ui/core/IconButton\"\nimport Button from \"@material-ui/core/Button\"\nimport TrashIcon from \"@material-ui/icons/Delete\"\nimport CheckIcon from \"@material-ui/icons/Check\"\nimport TextField from \"@material-ui/core/TextField\"\nimport Select from \"react-select\"\nimport CreatableSelect from \"react-select/creatable\"\n\nimport { asMutable } from \"seamless-immutable\"\n\nconst useStyles = makeStyles(styles)\n\ntype Props = {\n  region: Region,\n  editing?: boolean,\n  allowedClasses?: Array<string>,\n  allowedTags?: Array<string>,\n  cls?: string,\n  tags?: Array<string>,\n  onDelete: (Region) => null,\n  onChange: (Region) => null,\n  onClose: (Region) => null,\n  onOpen: (Region) => null,\n  onRegionClassAdded: () => {},\n  allowComments?: boolean,\n}\n\nexport const RegionLabel = ({\n  region,\n  editing,\n  allowedClasses,\n  allowedTags,\n  onDelete,\n  onChange,\n  onClose,\n  onOpen,\n  onRegionClassAdded,\n  allowComments,\n}: Props) => {\n  const classes = useStyles()\n  const commentInputRef = useRef(null)\n  const onCommentInputClick = (_) => {\n    // The TextField wraps the <input> tag with two divs\n    const commentInput = commentInputRef.current.children[0].children[0]\n\n    if (commentInput) return commentInput.focus()\n  }\n\n  return (\n    <Paper\n      onClick={() => (!editing ? onOpen(region) : null)}\n      className={classnames(classes.regionInfo, {\n        highlighted: region.highlighted,\n      })}\n    >\n      {!editing ? (\n        <div>\n          {region.cls && (\n            <div className=\"name\">\n              <div\n                className=\"circle\"\n                style={{ backgroundColor: region.color }}\n              />\n              {region.cls}\n            </div>\n          )}\n          {region.tags && (\n            <div className=\"tags\">\n              {region.tags.map((t) => (\n                <div key={t} className=\"tag\">\n                  {t}\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      ) : (\n        <div style={{ width: 200 }}>\n          <div style={{ display: \"flex\", flexDirection: \"row\" }}>\n            <div\n              style={{\n                display: \"flex\",\n                backgroundColor: region.color || \"#888\",\n                color: \"#fff\",\n                padding: 4,\n                paddingLeft: 8,\n                paddingRight: 8,\n                borderRadius: 4,\n                fontWeight: \"bold\",\n                textShadow: \"0px 0px 5px rgba(0,0,0,0.4)\",\n              }}\n            >\n              {region.type}\n            </div>\n            <div style={{ flexGrow: 1 }} />\n            <IconButton\n              onClick={() => onDelete(region)}\n              tabIndex={-1}\n              style={{ width: 22, height: 22 }}\n              size=\"small\"\n              variant=\"outlined\"\n            >\n              <TrashIcon style={{ marginTop: -8, width: 16, height: 16 }} />\n            </IconButton>\n          </div>\n          {(allowedClasses || []).length > 0 && (\n            <div style={{ marginTop: 6 }}>\n              <CreatableSelect\n                placeholder=\"Classification\"\n                onChange={(o, actionMeta) => {\n                  if (actionMeta.action == \"create-option\") {\n                    onRegionClassAdded(o.value)\n                  }\n                  return onChange({\n                    ...(region: any),\n                    cls: o.value,\n                  })\n                }}\n                value={\n                  region.cls ? { label: region.cls, value: region.cls } : null\n                }\n                options={asMutable(\n                  allowedClasses.map((c) => ({ value: c, label: c }))\n                )}\n              />\n            </div>\n          )}\n          {(allowedTags || []).length > 0 && (\n            <div style={{ marginTop: 4 }}>\n              <Select\n                onChange={(newTags) =>\n                  onChange({\n                    ...(region: any),\n                    tags: newTags.map((t) => t.value),\n                  })\n                }\n                placeholder=\"Tags\"\n                value={(region.tags || []).map((c) => ({ label: c, value: c }))}\n                isMulti\n                options={asMutable(\n                  allowedTags.map((c) => ({ value: c, label: c }))\n                )}\n              />\n            </div>\n          )}\n          {allowComments && (\n            <TextField\n              InputProps={{\n                className: classes.commentBox,\n              }}\n              fullWidth\n              multiline\n              rows={3}\n              ref={commentInputRef}\n              onClick={onCommentInputClick}\n              value={region.comment || \"\"}\n              onChange={(event) =>\n                onChange({ ...(region: any), comment: event.target.value })\n              }\n            />\n          )}\n          {onClose && (\n            <div style={{ marginTop: 4, display: \"flex\" }}>\n              <div style={{ flexGrow: 1 }} />\n              <Button\n                onClick={() => onClose(region)}\n                size=\"small\"\n                variant=\"contained\"\n                color=\"primary\"\n              >\n                <CheckIcon />\n              </Button>\n            </div>\n          )}\n        </div>\n      )}\n    </Paper>\n  )\n}\n\nexport default memo(\n  RegionLabel,\n  (prevProps, nextProps) =>\n    prevProps.editing === nextProps.editing &&\n    prevProps.region === nextProps.region\n)\n","// @flow weak\n\nimport React from \"react\"\nimport Paper from \"@material-ui/core/Paper\"\nimport DefaultRegionLabel from \"../RegionLabel\"\nimport LockIcon from \"@material-ui/icons/Lock\"\n\nconst copyWithout = (obj, ...args) => {\n  const newObj = { ...obj }\n  for (const arg of args) {\n    delete newObj[arg]\n  }\n  return newObj\n}\n\nexport const RegionTags = ({\n  regions,\n  projectRegionBox,\n  mouseEvents,\n  regionClsList,\n  regionTagList,\n  onBeginRegionEdit,\n  onChangeRegion,\n  onCloseRegionEdit,\n  onDeleteRegion,\n  layoutParams,\n  imageSrc,\n  RegionEditLabel,\n  onRegionClassAdded,\n  allowComments,\n}) => {\n  const RegionLabel =\n    RegionEditLabel != null ? RegionEditLabel : DefaultRegionLabel\n  return regions\n    .filter((r) => r.visible || r.visible === undefined)\n    .map((region) => {\n      const pbox = projectRegionBox(region)\n      const { iw, ih } = layoutParams.current\n      let margin = 8\n      if (region.highlighted && region.type === \"box\") margin += 6\n      const labelBoxHeight =\n        region.editingLabels && !region.locked ? 170 : region.tags ? 60 : 50\n      const displayOnTop = pbox.y > labelBoxHeight\n\n      const coords = displayOnTop\n        ? {\n            left: pbox.x,\n            top: pbox.y - margin / 2,\n          }\n        : { left: pbox.x, top: pbox.y + pbox.h + margin / 2 }\n      if (region.locked) {\n        return (\n          <div\n            key={region.id}\n            style={{\n              position: \"absolute\",\n              ...coords,\n              zIndex: 10 + (region.editingLabels ? 5 : 0),\n            }}\n          >\n            <Paper\n              style={{\n                position: \"absolute\",\n                left: 0,\n                ...(displayOnTop ? { bottom: 0 } : { top: 0 }),\n                zIndex: 10,\n                backgroundColor: \"#fff\",\n                borderRadius: 4,\n                padding: 2,\n                paddingBottom: 0,\n                opacity: 0.5,\n                pointerEvents: \"none\",\n              }}\n            >\n              <LockIcon style={{ width: 16, height: 16, color: \"#333\" }} />\n            </Paper>\n          </div>\n        )\n      }\n      return (\n        <div\n          key={region.id}\n          style={{\n            position: \"absolute\",\n            ...coords,\n            zIndex: 10 + (region.editingLabels ? 5 : 0),\n            width: 200,\n          }}\n          onMouseDown={(e) => e.preventDefault()}\n          onMouseUp={(e) => e.preventDefault()}\n          onMouseEnter={(e) => {\n            if (region.editingLabels) {\n              mouseEvents.onMouseUp(e)\n              e.button = 1\n              mouseEvents.onMouseUp(e)\n            }\n          }}\n        >\n          <div\n            style={{\n              position: \"absolute\",\n              zIndex: 20,\n              left: 0,\n              ...(displayOnTop ? { bottom: 0 } : { top: 0 }),\n            }}\n            {...(!region.editingLabels\n              ? copyWithout(mouseEvents, \"onMouseDown\", \"onMouseUp\")\n              : {})}\n          >\n            <RegionLabel\n              allowedClasses={regionClsList}\n              allowedTags={regionTagList}\n              onOpen={onBeginRegionEdit}\n              onChange={onChangeRegion}\n              onClose={onCloseRegionEdit}\n              onDelete={onDeleteRegion}\n              editing={region.editingLabels}\n              region={region}\n              regions={regions}\n              imageSrc={imageSrc}\n              onRegionClassAdded={onRegionClassAdded}\n              allowComments={allowComments}\n            />\n          </div>\n        </div>\n      )\n    })\n}\n\nexport default RegionTags\n","// @flow\n\nimport * as muiColors from \"@material-ui/core/colors\"\n\nexport const colors = [\n  muiColors.red[500],\n  muiColors.blue[500],\n  muiColors.green[500],\n  muiColors.orange[800],\n  muiColors.brown[500],\n  muiColors.lightGreen[700],\n  muiColors.pink[500],\n  muiColors.purple[500],\n  muiColors.indigo[500],\n  muiColors.teal[500],\n  muiColors.lime[500],\n  muiColors.blueGrey[500],\n]\n\nconst transparency = 0x88000000\n\nfunction reverseParseColor(rrggbb) {\n  rrggbb = rrggbb.replace(\"#\", \"\")\n  const bbggrr = rrggbb.substr(4, 2) + rrggbb.substr(2, 2) + rrggbb.substr(0, 2)\n  return parseInt(bbggrr, 16)\n}\n\nexport const colorInts: Array<number> = colors.map(\n  (c) => (reverseParseColor(c) | transparency) >>> 0\n)\n\nexport default colors\n","export const loadImage = (imageSrc) => {\n  // Check if image is already loaded in a page element\n  let image = Array.from(document.getElementsByTagName(\"img\")).find(\n    (img) => img.src === imageSrc\n  )\n\n  const canvas = document.createElement(\"canvas\")\n  const ctx = canvas.getContext(\"2d\")\n\n  if (!image) {\n    image = new Image()\n    image.crossOrigin = \"anonymous\"\n    image.src = imageSrc\n  }\n\n  return new Promise((resolve, reject) => {\n    image.onload = () => {\n      canvas.width = image.naturalWidth\n      canvas.height = image.naturalHeight\n      ctx.drawImage(image, 0, 0)\n      const imageData = ctx.getImageData(\n        0,\n        0,\n        image.naturalWidth,\n        image.naturalHeight\n      )\n      resolve(imageData)\n    }\n  })\n}\n\nexport default loadImage\n","// @flow\n\nimport React, { useState, useEffect, useMemo, useRef } from \"react\"\nimport { colorInts } from \"../colors\"\nimport { useDebounce } from \"react-use\"\nimport loadImage from \"./load-image\"\nimport autoseg from \"autoseg/webworker\"\n\nfunction convertToUDTRegions(regions) {\n  return regions\n    .map((r) => {\n      switch (r.type) {\n        case \"point\": {\n          return {\n            regionType: \"point\",\n            classification: r.cls,\n            x: r.x,\n            y: r.y,\n          }\n        }\n        case \"polygon\": {\n          return {\n            regionType: \"polygon\",\n            classification: r.cls,\n            points: r.points.map(([x, y]) => ({ x, y })),\n          }\n        }\n        case \"box\": {\n          return {\n            regionType: \"bounding-box\",\n            classification: r.cls,\n            centerX: r.x + r.w / 2,\n            centerY: r.y + r.h / 2,\n            width: r.w,\n            height: r.h,\n          }\n        }\n        default: {\n          return null\n        }\n      }\n    })\n    .filter(Boolean)\n}\n\nexport const ImageMask = ({\n  regions,\n  regionClsList,\n  imageSrc,\n  imagePosition,\n  zIndex = 1,\n  hide = false,\n  autoSegmentationOptions = { type: \"simple\" },\n}) => {\n  // if (!window.mmgc) window.mmgc = MMGC_INIT()\n  // const mmgc = window.mmgc\n  const [canvasRef, setCanvasRef] = useState(null)\n\n  const [sampleImageData, setSampleImageData] = useState()\n\n  useEffect(() => {\n    if (!imageSrc) return\n\n    loadImage(imageSrc).then((imageData) => {\n      autoseg.setConfig({\n        classNames: regionClsList,\n        ...autoSegmentationOptions,\n      })\n      autoseg.loadImage(imageData)\n      setSampleImageData(imageData)\n    })\n  }, [imageSrc])\n\n  useDebounce(\n    () => {\n      if (hide) return\n      if (!canvasRef) return\n      if (!sampleImageData) return\n      if (regions.filter((cp) => cp.cls).length < 2) return\n\n      const udtRegions = convertToUDTRegions(regions)\n\n      autoseg.getMask(udtRegions).then((maskImageData) => {\n        const context = canvasRef.getContext(\"2d\")\n        context.clearRect(0, 0, maskImageData.width, maskImageData.height)\n        context.putImageData(maskImageData, 0, 0)\n      })\n    },\n    1000,\n    [canvasRef, sampleImageData, regions, hide]\n  )\n\n  const style = useMemo(() => {\n    let width = imagePosition.bottomRight.x - imagePosition.topLeft.x\n    let height = imagePosition.bottomRight.y - imagePosition.topLeft.y\n    return {\n      display: hide ? \"none\" : undefined,\n      imageRendering: \"pixelated\",\n      transform: \"translateZ(0px)\",\n      left: imagePosition.topLeft.x,\n      top: imagePosition.topLeft.y,\n      width: isNaN(width) ? 0 : width,\n      height: isNaN(height) ? 0 : height,\n      zIndex,\n      position: \"absolute\",\n      pointerEvents: \"none\",\n    }\n  }, [\n    imagePosition.topLeft.x,\n    imagePosition.topLeft.y,\n    imagePosition.bottomRight.x,\n    imagePosition.bottomRight.y,\n    zIndex,\n    hide,\n  ])\n\n  return (\n    <canvas\n      style={style}\n      width={sampleImageData ? sampleImageData.width : 0}\n      height={sampleImageData ? sampleImageData.height : 0}\n      ref={setCanvasRef}\n    />\n  )\n}\n\nexport default ImageMask\n","// @flow\n\nimport React from \"react\"\nimport classnames from \"classnames\"\nimport { makeStyles } from \"@material-ui/core/styles\"\n\nconst useStyles = makeStyles({\n  \"@keyframes borderDance\": {\n    from: { strokeDashoffset: 0 },\n    to: { strokeDashoffset: 100 },\n  },\n  highlightBox: {\n    zIndex: 2,\n    transition: \"opacity 500ms\",\n    \"&.highlighted\": {\n      zIndex: 3,\n    },\n    \"&:not(.highlighted)\": {\n      opacity: 0,\n    },\n    \"&:not(.highlighted):hover\": {\n      opacity: 0.6,\n    },\n    \"& path\": {\n      vectorEffect: \"non-scaling-stroke\",\n      strokeWidth: 2,\n      stroke: \"#FFF\",\n      fill: \"none\",\n      strokeDasharray: 5,\n      animationName: \"$borderDance\",\n      animationDuration: \"4s\",\n      animationTimingFunction: \"linear\",\n      animationIterationCount: \"infinite\",\n      animationPlayState: \"running\",\n    },\n  },\n})\n\nexport const HighlightBox = ({\n  mouseEvents,\n  dragWithPrimary,\n  zoomWithPrimary,\n  createWithPrimary,\n  onBeginMovePoint,\n  onSelectRegion,\n  region: r,\n  pbox,\n}: {\n  mouseEvents: any,\n  dragWithPrimary: boolean,\n  zoomWithPrimary: boolean,\n  createWithPrimary: boolean,\n  onBeginMovePoint: Function,\n  onSelectRegion: Function,\n  region: any,\n  pbox: { x: number, y: number, w: number, h: number },\n}) => {\n  const classes = useStyles()\n  if (!pbox.w || pbox.w === Infinity) return null\n  if (!pbox.h || pbox.h === Infinity) return null\n  if (r.unfinished) return null\n\n  const styleCoords =\n    r.type === \"point\"\n      ? {\n          left: pbox.x + pbox.w / 2 - 30,\n          top: pbox.y + pbox.h / 2 - 30,\n          width: 60,\n          height: 60,\n        }\n      : {\n          left: pbox.x - 5,\n          top: pbox.y - 5,\n          width: pbox.w + 10,\n          height: pbox.h + 10,\n        }\n\n  const pathD =\n    r.type === \"point\"\n      ? `M5,5 L${styleCoords.width - 5} 5L${styleCoords.width - 5} ${\n          styleCoords.height - 5\n        }L5 ${styleCoords.height - 5}Z`\n      : `M5,5 L${pbox.w + 5},5 L${pbox.w + 5},${pbox.h + 5} L5,${pbox.h + 5} Z`\n\n  return (\n    <svg\n      key={r.id}\n      className={classnames(classes.highlightBox, {\n        highlighted: r.highlighted,\n      })}\n      {...mouseEvents}\n      {...(!zoomWithPrimary && !dragWithPrimary\n        ? {\n            onMouseDown: (e) => {\n              if (\n                !r.locked &&\n                r.type === \"point\" &&\n                r.highlighted &&\n                e.button === 0\n              ) {\n                return onBeginMovePoint(r)\n              }\n              if (e.button === 0 && !createWithPrimary) return onSelectRegion(r)\n              mouseEvents.onMouseDown(e)\n            },\n          }\n        : {})}\n      style={{\n        ...(r.highlighted\n          ? {\n              pointerEvents: r.type !== \"point\" ? \"none\" : undefined,\n              cursor: \"grab\",\n            }\n          : {\n              cursor: !(zoomWithPrimary || dragWithPrimary || createWithPrimary)\n                ? \"pointer\"\n                : undefined,\n              pointerEvents:\n                zoomWithPrimary ||\n                dragWithPrimary ||\n                (createWithPrimary && !r.highlighted)\n                  ? \"none\"\n                  : undefined,\n            }),\n        position: \"absolute\",\n        ...styleCoords,\n      }}\n    >\n      <path d={pathD} />\n    </svg>\n  )\n}\n\nexport default HighlightBox\n","import React, { Fragment, memo } from \"react\"\nimport HighlightBox from \"../HighlightBox\"\nimport { styled } from \"@material-ui/core/styles\"\nimport PreventScrollToParents from \"../PreventScrollToParents\"\nimport { Tooltip } from \"@material-ui/core\"\n\nconst TransformGrabber = styled(\"div\")({\n  width: 8,\n  height: 8,\n  zIndex: 2,\n  border: \"2px solid #FFF\",\n  position: \"absolute\",\n})\n\nconst boxCursorMap = [\n  [\"nw-resize\", \"n-resize\", \"ne-resize\"],\n  [\"w-resize\", \"grab\", \"e-resize\"],\n  [\"sw-resize\", \"s-resize\", \"se-resize\"],\n]\n\nconst arePropsEqual = (prev, next) => {\n  return (\n    prev.region === next.region &&\n    prev.dragWithPrimary === next.dragWithPrimary &&\n    prev.createWithPrimary === next.createWithPrimary &&\n    prev.zoomWithPrimary === next.zoomWithPrimary &&\n    prev.mat === next.mat\n  )\n}\n\nexport const RegionSelectAndTransformBox = memo(\n  ({\n    region: r,\n    mouseEvents,\n    projectRegionBox,\n    dragWithPrimary,\n    createWithPrimary,\n    zoomWithPrimary,\n    onBeginMovePoint,\n    onSelectRegion,\n    layoutParams,\n    fullImageSegmentationMode = false,\n    mat,\n    onBeginBoxTransform,\n    onBeginMovePolygonPoint,\n    onBeginMoveKeypoint,\n    onAddPolygonPoint,\n    showHighlightBox,\n  }) => {\n    const pbox = projectRegionBox(r)\n    const { iw, ih } = layoutParams.current\n    return (\n      <Fragment>\n        <PreventScrollToParents>\n          {showHighlightBox && r.type !== \"polygon\" && (\n            <HighlightBox\n              region={r}\n              mouseEvents={mouseEvents}\n              dragWithPrimary={dragWithPrimary}\n              createWithPrimary={createWithPrimary}\n              zoomWithPrimary={zoomWithPrimary}\n              onBeginMovePoint={onBeginMovePoint}\n              onSelectRegion={onSelectRegion}\n              pbox={pbox}\n            />\n          )}\n          {r.type === \"box\" &&\n            !dragWithPrimary &&\n            !zoomWithPrimary &&\n            !r.locked &&\n            r.highlighted &&\n            mat.a < 1.2 &&\n            [\n              [0, 0],\n              [0.5, 0],\n              [1, 0],\n              [1, 0.5],\n              [1, 1],\n              [0.5, 1],\n              [0, 1],\n              [0, 0.5],\n              [0.5, 0.5],\n            ].map(([px, py], i) => (\n              <TransformGrabber\n                key={i}\n                {...mouseEvents}\n                onMouseDown={(e) => {\n                  if (e.button === 0)\n                    return onBeginBoxTransform(r, [px * 2 - 1, py * 2 - 1])\n                  mouseEvents.onMouseDown(e)\n                }}\n                style={{\n                  left: pbox.x - 4 - 2 + pbox.w * px,\n                  top: pbox.y - 4 - 2 + pbox.h * py,\n                  cursor: boxCursorMap[py * 2][px * 2],\n                  borderRadius: px === 0.5 && py === 0.5 ? 4 : undefined,\n                }}\n              />\n            ))}\n          {r.type === \"polygon\" &&\n            !dragWithPrimary &&\n            !zoomWithPrimary &&\n            !r.locked &&\n            r.highlighted &&\n            r.points.map(([px, py], i) => {\n              const proj = mat\n                .clone()\n                .inverse()\n                .applyToPoint(px * iw, py * ih)\n              return (\n                <TransformGrabber\n                  key={i}\n                  {...mouseEvents}\n                  onMouseDown={(e) => {\n                    if (e.button === 0 && (!r.open || i === 0))\n                      return onBeginMovePolygonPoint(r, i)\n                    mouseEvents.onMouseDown(e)\n                  }}\n                  style={{\n                    cursor: !r.open ? \"move\" : i === 0 ? \"pointer\" : undefined,\n                    zIndex: 10,\n                    pointerEvents:\n                      r.open && i === r.points.length - 1 ? \"none\" : undefined,\n                    left: proj.x - 4,\n                    top: proj.y - 4,\n                  }}\n                />\n              )\n            })}\n          {r.type === \"polygon\" &&\n            r.highlighted &&\n            !dragWithPrimary &&\n            !zoomWithPrimary &&\n            !r.locked &&\n            !r.open &&\n            r.points.length > 1 &&\n            r.points\n              .map((p1, i) => [p1, r.points[(i + 1) % r.points.length]])\n              .map(([p1, p2]) => [(p1[0] + p2[0]) / 2, (p1[1] + p2[1]) / 2])\n              .map((pa, i) => {\n                const proj = mat\n                  .clone()\n                  .inverse()\n                  .applyToPoint(pa[0] * iw, pa[1] * ih)\n                return (\n                  <TransformGrabber\n                    key={i}\n                    {...mouseEvents}\n                    onMouseDown={(e) => {\n                      if (e.button === 0) return onAddPolygonPoint(r, pa, i + 1)\n                      mouseEvents.onMouseDown(e)\n                    }}\n                    style={{\n                      cursor: \"copy\",\n                      zIndex: 10,\n                      left: proj.x - 4,\n                      top: proj.y - 4,\n                      border: \"2px dotted #fff\",\n                      opacity: 0.5,\n                    }}\n                  />\n                )\n              })}\n          {r.type === \"keypoints\" &&\n            !dragWithPrimary &&\n            !zoomWithPrimary &&\n            !r.locked &&\n            r.highlighted &&\n            Object.entries(r.points).map(\n              ([keypointId, { x: px, y: py }], i) => {\n                const proj = mat\n                  .clone()\n                  .inverse()\n                  .applyToPoint(px * iw, py * ih)\n                return (\n                  <Tooltip title={keypointId} key={i}>\n                    <TransformGrabber\n                      key={i}\n                      {...mouseEvents}\n                      onMouseDown={(e) => {\n                        if (e.button === 0 && (!r.open || i === 0))\n                          return onBeginMoveKeypoint(r, keypointId)\n                        mouseEvents.onMouseDown(e)\n                      }}\n                      style={{\n                        cursor: !r.open\n                          ? \"move\"\n                          : i === 0\n                          ? \"pointer\"\n                          : undefined,\n                        zIndex: 10,\n                        pointerEvents:\n                          r.open && i === r.points.length - 1\n                            ? \"none\"\n                            : undefined,\n                        left: proj.x - 4,\n                        top: proj.y - 4,\n                      }}\n                    />\n                  </Tooltip>\n                )\n              }\n            )}\n        </PreventScrollToParents>\n      </Fragment>\n    )\n  },\n  arePropsEqual\n)\n\nexport const RegionSelectAndTransformBoxes = memo(\n  (props) => {\n    return props.regions\n      .filter((r) => r.visible || r.visible === undefined)\n      .filter((r) => !r.locked)\n      .map((r, i) => {\n        return <RegionSelectAndTransformBox key={r.id} {...props} region={r} />\n      })\n  },\n  (n, p) => n.regions === p.regions && n.mat === p.mat\n)\n\nexport default RegionSelectAndTransformBoxes\n","// @flow\n\nimport React, { createContext, useContext, useState } from \"react\"\n\nconst defaultSettings = {\n  showCrosshairs: false,\n  showHighlightBox: true,\n  wasdMode: true,\n}\n\nexport const SettingsContext = createContext(defaultSettings)\n\nconst pullSettingsFromLocalStorage = () => {\n  if (!window || !window.localStorage) return {}\n  let settings = {}\n  for (let i = 0; i < window.localStorage.length; i++) {\n    const key = window.localStorage.key(i)\n    if (key.startsWith(\"settings_\")) {\n      try {\n        settings[key.replace(\"settings_\", \"\")] = JSON.parse(\n          window.localStorage.getItem(key)\n        )\n      } catch (e) {}\n    }\n  }\n  return settings\n}\n\nexport const useSettings = () => useContext(SettingsContext)\n\nexport const SettingsProvider = ({ children }) => {\n  const [state, changeState] = useState(() => pullSettingsFromLocalStorage())\n  const changeSetting = (setting: string, value: any) => {\n    changeState({ ...state, [setting]: value })\n    window.localStorage.setItem(`settings_${setting}`, JSON.stringify(value))\n  }\n  return (\n    <SettingsContext.Provider value={{ ...state, changeSetting }}>\n      {children}\n    </SettingsContext.Provider>\n  )\n}\n\nexport default SettingsProvider\n","// @flow weak\n\nimport React, { useRef, useEffect, useMemo, useState } from \"react\"\nimport { styled } from \"@material-ui/core/styles\"\nimport useEventCallback from \"use-event-callback\"\nimport { useSettings } from \"../SettingsProvider\"\n\nconst Video = styled(\"video\")({\n  zIndex: 0,\n  position: \"absolute\",\n})\n\nconst StyledImage = styled(\"img\")({\n  zIndex: 0,\n  position: \"absolute\",\n})\n\nconst Error = styled(\"div\")({\n  zIndex: 0,\n  position: \"absolute\",\n  left: 0,\n  right: 0,\n  bottom: 0,\n  top: 0,\n  backgroundColor: \"rgba(255,0,0,0.2)\",\n  color: \"#ff0000\",\n  fontWeight: \"bold\",\n  whiteSpace: \"pre-wrap\",\n  padding: 50,\n})\n\nexport default ({\n  imagePosition,\n  mouseEvents,\n  videoTime,\n  videoSrc,\n  imageSrc,\n  onLoad,\n  useCrossOrigin = false,\n  videoPlaying,\n  onChangeVideoTime,\n  onChangeVideoPlaying,\n}) => {\n  const settings = useSettings()\n  const videoRef = useRef()\n  const imageRef = useRef()\n  const [error, setError] = useState()\n\n  useEffect(() => {\n    if (!videoPlaying && videoRef.current) {\n      videoRef.current.currentTime = (videoTime || 0) / 1000\n    }\n  }, [videoTime])\n\n  useEffect(() => {\n    let renderLoopRunning = false\n    if (videoRef.current) {\n      if (videoPlaying) {\n        videoRef.current.play()\n        renderLoopRunning = true\n        if (settings.videoPlaybackSpeed) {\n          videoRef.current.playbackRate = parseFloat(\n            settings.videoPlaybackSpeed\n          )\n        }\n      } else {\n        videoRef.current.pause()\n      }\n    }\n\n    function checkForNewFrame() {\n      if (!renderLoopRunning) return\n      if (!videoRef.current) return\n      const newVideoTime = Math.floor(videoRef.current.currentTime * 1000)\n      if (videoTime !== newVideoTime) {\n        onChangeVideoTime(newVideoTime)\n      }\n      if (videoRef.current.paused) {\n        renderLoopRunning = false\n        onChangeVideoPlaying(false)\n      }\n      requestAnimationFrame(checkForNewFrame)\n    }\n    checkForNewFrame()\n\n    return () => {\n      renderLoopRunning = false\n    }\n  }, [videoPlaying])\n\n  const onLoadedVideoMetadata = useEventCallback((event) => {\n    const videoElm = event.currentTarget\n    videoElm.currentTime = (videoTime || 0) / 1000\n    if (onLoad)\n      onLoad({\n        naturalWidth: videoElm.videoWidth,\n        naturalHeight: videoElm.videoHeight,\n        videoElm: videoElm,\n        duration: videoElm.duration,\n      })\n  })\n  const onImageLoaded = useEventCallback((event) => {\n    const imageElm = event.currentTarget\n    if (onLoad)\n      onLoad({\n        naturalWidth: imageElm.naturalWidth,\n        naturalHeight: imageElm.naturalHeight,\n        imageElm,\n      })\n  })\n  const onImageError = useEventCallback((event) => {\n    setError(\n      `Could not load image\\n\\nMake sure your image works by visiting ${\n        imageSrc || videoSrc\n      } in a web browser. If that URL works, the server hosting the URL may be not allowing you to access the image from your current domain. Adjust server settings to enable the image to be viewed.${\n        !useCrossOrigin\n          ? \"\"\n          : `\\n\\nYour image may be blocked because it's not being sent with CORs headers. To do pixel segmentation, browser web security requires CORs headers in order for the algorithm to read the pixel data from the image. CORs headers are easy to add if you're using an S3 bucket or own the server hosting your images.`\n      }\\n\\n If you need a hand, reach out to the community at universaldatatool.slack.com`\n    )\n  })\n\n  const stylePosition = useMemo(() => {\n    let width = imagePosition.bottomRight.x - imagePosition.topLeft.x\n    let height = imagePosition.bottomRight.y - imagePosition.topLeft.y\n    return {\n      imageRendering: \"pixelated\",\n      left: imagePosition.topLeft.x,\n      top: imagePosition.topLeft.y,\n      width: isNaN(width) ? 0 : width,\n      height: isNaN(height) ? 0 : height,\n    }\n  }, [\n    imagePosition.topLeft.x,\n    imagePosition.topLeft.y,\n    imagePosition.bottomRight.x,\n    imagePosition.bottomRight.y,\n  ])\n\n  if (!videoSrc && !imageSrc)\n    return <Error>No imageSrc or videoSrc provided</Error>\n\n  if (error) return <Error>{error}</Error>\n\n  return imageSrc && videoTime === undefined ? (\n    <StyledImage\n      {...mouseEvents}\n      src={imageSrc}\n      ref={imageRef}\n      style={stylePosition}\n      onLoad={onImageLoaded}\n      onError={onImageError}\n      crossOrigin={useCrossOrigin ? \"anonymous\" : undefined}\n    />\n  ) : (\n    <Video\n      {...mouseEvents}\n      ref={videoRef}\n      style={stylePosition}\n      onLoadedMetadata={onLoadedVideoMetadata}\n      src={videoSrc || imageSrc}\n    />\n  )\n}\n","// @flow\n\nimport React, { memo } from \"react\"\nimport colorAlpha from \"color-alpha\"\n\nfunction clamp(num, min, max) {\n  return num <= min ? min : num >= max ? max : num\n}\n\nconst RegionComponents = {\n  point: memo(({ region, iw, ih }) => (\n    <g transform={`translate(${region.x * iw} ${region.y * ih})`}>\n      <path\n        d={\"M0 8L8 0L0 -8L-8 0Z\"}\n        strokeWidth={2}\n        stroke={region.color}\n        fill=\"transparent\"\n      />\n    </g>\n  )),\n  line: memo(({ region, iw, ih }) => (\n    <g transform={`translate(${region.x1 * iw} ${region.y1 * ih})`}>\n      <line\n        strokeWidth={2}\n        x1={0}\n        y1={0}\n        x2={(region.x2 - region.x1) * iw}\n        y2={(region.y2 - region.y1) * ih}\n        stroke={colorAlpha(region.color, 0.75)}\n        fill={colorAlpha(region.color, 0.25)}\n      />\n    </g>\n  )),\n  box: memo(({ region, iw, ih }) => (\n    <g transform={`translate(${region.x * iw} ${region.y * ih})`}>\n      <rect\n        strokeWidth={2}\n        x={0}\n        y={0}\n        width={Math.max(region.w * iw, 0)}\n        height={Math.max(region.h * ih, 0)}\n        stroke={colorAlpha(region.color, 0.75)}\n        fill={colorAlpha(region.color, 0.25)}\n      />\n    </g>\n  )),\n  polygon: memo(({ region, iw, ih, fullSegmentationMode }) => {\n    const Component = region.open ? \"polyline\" : \"polygon\"\n    const alphaBase = fullSegmentationMode ? 0.5 : 1\n    return (\n      <Component\n        points={region.points\n          .map(([x, y]) => [x * iw, y * ih])\n          .map((a) => a.join(\" \"))\n          .join(\" \")}\n        strokeWidth={2}\n        stroke={colorAlpha(region.color, 0.75)}\n        fill={colorAlpha(region.color, 0.25)}\n      />\n    )\n  }),\n  keypoints: ({ region, iw, ih, keypointDefinitions }) => {\n    const { points, keypointsDefinitionId } = region\n    if (!keypointDefinitions[keypointsDefinitionId]) {\n      throw new Error(\n        `No definition for keypoint configuration \"${keypointsDefinitionId}\"`\n      )\n    }\n    const { landmarks, connections } = keypointDefinitions[\n      keypointsDefinitionId\n    ]\n    return (\n      <g>\n        {Object.entries(points).map(([keypointId, { x, y }], i) => (\n          <g key={i} transform={`translate(${x * iw} ${y * ih})`}>\n            <path\n              d={\"M0 8L8 0L0 -8L-8 0Z\"}\n              strokeWidth={2}\n              stroke={landmarks[keypointId].color}\n              fill=\"transparent\"\n            />\n          </g>\n        ))}\n        {connections.map(([kp1Id, kp2Id]) => {\n          const kp1 = points[kp1Id]\n          const kp2 = points[kp2Id]\n          const midPoint = { x: (kp1.x + kp2.x) / 2, y: (kp1.y + kp2.y) / 2 }\n\n          return (\n            <g key={`${kp1.x},${kp1.y}.${kp2.x},${kp2.y}`}>\n              <line\n                x1={kp1.x * iw}\n                y1={kp1.y * ih}\n                x2={midPoint.x * iw}\n                y2={midPoint.y * ih}\n                strokeWidth={2}\n                stroke={landmarks[kp1Id].color}\n              />\n              <line\n                x1={kp2.x * iw}\n                y1={kp2.y * ih}\n                x2={midPoint.x * iw}\n                y2={midPoint.y * ih}\n                strokeWidth={2}\n                stroke={landmarks[kp2Id].color}\n              />\n            </g>\n          )\n        })}\n      </g>\n    )\n  },\n  \"expanding-line\": memo(({ region, iw, ih }) => {\n    let { expandingWidth = 0.005, points } = region\n    expandingWidth = points.slice(-1)[0].width || expandingWidth\n    const pointPairs = points.map(({ x, y, angle, width }, i) => {\n      if (!angle) {\n        const n = points[clamp(i + 1, 0, points.length - 1)]\n        const p = points[clamp(i - 1, 0, points.length - 1)]\n        angle = Math.atan2(p.x - n.x, p.y - n.y) + Math.PI / 2\n      }\n      const dx = (Math.sin(angle) * (width || expandingWidth)) / 2\n      const dy = (Math.cos(angle) * (width || expandingWidth)) / 2\n      return [\n        { x: x + dx, y: y + dy },\n        { x: x - dx, y: y - dy },\n      ]\n    })\n    const firstSection = pointPairs.map(([p1, p2]) => p1)\n    const secondSection = pointPairs.map(([p1, p2]) => p2).asMutable()\n    secondSection.reverse()\n    const lastPoint = points.slice(-1)[0]\n    return (\n      <>\n        <polygon\n          points={firstSection\n            .concat(region.candidatePoint ? [region.candidatePoint] : [])\n            .concat(secondSection)\n            .map((p) => `${p.x * iw} ${p.y * ih}`)\n            .join(\" \")}\n          strokeWidth={2}\n          stroke={colorAlpha(region.color, 0.75)}\n          fill={colorAlpha(region.color, 0.25)}\n        />\n        {points.map(({ x, y, angle }, i) => (\n          <g\n            key={i}\n            transform={`translate(${x * iw} ${y * ih}) rotate(${\n              (-(angle || 0) * 180) / Math.PI\n            })`}\n          >\n            <g>\n              <rect\n                x={-5}\n                y={-5}\n                width={10}\n                height={10}\n                strokeWidth={2}\n                stroke={colorAlpha(region.color, 0.75)}\n                fill={colorAlpha(region.color, 0.25)}\n              />\n            </g>\n          </g>\n        ))}\n        <rect\n          x={lastPoint.x * iw - 8}\n          y={lastPoint.y * ih - 8}\n          width={16}\n          height={16}\n          strokeWidth={4}\n          stroke={colorAlpha(region.color, 0.5)}\n          fill={\"transparent\"}\n        />\n      </>\n    )\n  }),\n  pixel: () => null,\n}\n\nexport const WrappedRegionList = memo(\n  ({ regions, keypointDefinitions, iw, ih, fullSegmentationMode }) => {\n    return regions\n      .filter((r) => r.visible !== false)\n      .map((r) => {\n        const Component = RegionComponents[r.type]\n        return (\n          <Component\n            key={r.regionId}\n            region={r}\n            iw={iw}\n            ih={ih}\n            keypointDefinitions={keypointDefinitions}\n            fullSegmentationMode={fullSegmentationMode}\n          />\n        )\n      })\n  },\n  (n, p) => n.regions === p.regions && n.iw === p.iw && n.ih === p.ih\n)\n\nexport const RegionShapes = ({\n  mat,\n  imagePosition,\n  regions = [],\n  keypointDefinitions,\n  fullSegmentationMode,\n}) => {\n  const iw = imagePosition.bottomRight.x - imagePosition.topLeft.x\n  const ih = imagePosition.bottomRight.y - imagePosition.topLeft.y\n  if (isNaN(iw) || isNaN(ih)) return null\n  return (\n    <svg\n      width={iw}\n      height={ih}\n      style={{\n        position: \"absolute\",\n        zIndex: 2,\n        left: imagePosition.topLeft.x,\n        top: imagePosition.topLeft.y,\n        pointerEvents: \"none\",\n        width: iw,\n        height: ih,\n      }}\n    >\n      <WrappedRegionList\n        key=\"wrapped-region-list\"\n        regions={regions}\n        iw={iw}\n        ih={ih}\n        keypointDefinitions={keypointDefinitions}\n        fullSegmentationMode={fullSegmentationMode}\n      />\n    </svg>\n  )\n}\n\nexport default RegionShapes\n","import React, { useMemo } from \"react\"\nimport { HotKeys } from \"react-hotkeys\"\n\nexport const defaultHotkeys = [\n  {\n    id: \"select_tool\",\n    description: \"Switch to the Select Tool\",\n    binding: \"escape\",\n  },\n  {\n    id: \"zoom_tool\",\n    description: \"Select the Zoom Tool\",\n    binding: \"z\",\n  },\n  {\n    id: \"create_point\",\n    description: \"Create a point\",\n  },\n  {\n    id: \"create_bounding_box\",\n    description: \"Create a bounding box\",\n    binding: \"b\",\n  },\n  {\n    id: \"pan_tool\",\n    description: \"Select the Pan Tool\",\n    binding: \"m\",\n  },\n  {\n    id: \"create_polygon\",\n    description: \"Create a Polygon\",\n    binding: \"p\",\n  },\n  {\n    id: \"create_pixel\",\n    description: \"Create a Pixel Mask\",\n  },\n  {\n    id: \"save_and_previous_sample\",\n    description: \"Save and go to previous sample\",\n    binding: \"ArrowLeft\",\n  },\n  {\n    id: \"save_and_next_sample\",\n    description: \"Save and go to next sample\",\n    binding: \"ArrowRight\",\n  },\n  {\n    id: \"save_and_exit_sample\",\n    description: \"Save and exit current sample\",\n  },\n  {\n    id: \"exit_sample\",\n    description: \"Exit sample without saving\",\n  },\n  {\n    id: \"delete_region\",\n    description: \"Delete selected region\",\n    binding: \"d\",\n  },\n  {\n    id: \"undo\",\n    description: \"Undo latest change\",\n    binding: \"Ctrl+z\",\n  },\n]\nexport const defaultKeyMap = {}\nfor (const { id, binding } of defaultHotkeys) defaultKeyMap[id] = binding\n\nexport const useDispatchHotkeyHandlers = ({ dispatch }) => {\n  const handlers = useMemo(\n    () => ({\n      select_tool: () => {\n        dispatch({\n          type: \"SELECT_TOOL\",\n          selectedTool: \"select\",\n        })\n      },\n      zoom_tool: () => {\n        dispatch({\n          type: \"SELECT_TOOL\",\n          selectedTool: \"zoom\",\n        })\n      },\n      create_point: () => {\n        dispatch({\n          type: \"SELECT_TOOL\",\n          selectedTool: \"create-point\",\n        })\n      },\n      create_bounding_box: () => {\n        dispatch({\n          type: \"SELECT_TOOL\",\n          selectedTool: \"create-box\",\n        })\n      },\n      pan_tool: () => {\n        dispatch({\n          type: \"SELECT_TOOL\",\n          selectedTool: \"pan\",\n        })\n      },\n      create_polygon: () => {\n        dispatch({\n          type: \"SELECT_TOOL\",\n          selectedTool: \"create-polygon\",\n        })\n      },\n      create_pixel: () => {\n        dispatch({\n          type: \"SELECT_TOOL\",\n          selectedTool: \"create-pixel\",\n        })\n      },\n      save_and_previous_sample: () => {\n        dispatch({\n          type: \"HEADER_BUTTON_CLICKED\",\n          buttonName: \"Prev\",\n        })\n      },\n      save_and_next_sample: () => {\n        dispatch({\n          type: \"HEADER_BUTTON_CLICKED\",\n          buttonName: \"Next\",\n        })\n      },\n      save_and_exit_sample: () => {\n        dispatch({\n          type: \"HEADER_BUTTON_CLICKED\",\n          buttonName: \"Save\",\n        })\n      },\n      delete_region: () => {\n        dispatch({\n          type: \"DELETE_SELECTED_REGION\",\n        })\n      },\n      undo: () => {\n        dispatch({\n          type: \"RESTORE_HISTORY\",\n        })\n      },\n      // TODO\n      // exit_sample: () => {\n      //   dispatch({\n      //     type: \"\",\n      //   })\n      // }\n    }),\n    [dispatch]\n  )\n  return handlers\n}\n\nexport default ({ children, dispatch }) => {\n  const handlers = useDispatchHotkeyHandlers({ dispatch })\n  return (\n    <HotKeys allowChanges handlers={handlers}>\n      {children}\n    </HotKeys>\n  )\n}\n","// @flow weak\n\nimport React, {\n  useRef,\n  useState,\n  useLayoutEffect,\n  useEffect,\n  useMemo,\n} from \"react\"\nimport type { Node } from \"react\"\nimport { Matrix } from \"transformation-matrix-js\"\nimport Crosshairs from \"../Crosshairs\"\nimport type {\n  Region,\n  Point,\n  Polygon,\n  Box,\n  Keypoints,\n  KeypointsDefinition,\n} from \"./region-tools.js\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport styles from \"./styles\"\nimport PreventScrollToParents from \"../PreventScrollToParents\"\nimport useWindowSize from \"../hooks/use-window-size.js\"\nimport useMouse from \"./use-mouse\"\nimport useProjectRegionBox from \"./use-project-box\"\nimport useExcludePattern from \"../hooks/use-exclude-pattern\"\nimport { useRafState } from \"react-use\"\nimport PointDistances from \"../PointDistances\"\nimport RegionTags from \"../RegionTags\"\nimport RegionLabel from \"../RegionLabel\"\nimport ImageMask from \"../ImageMask\"\nimport RegionSelectAndTransformBoxes from \"../RegionSelectAndTransformBoxes\"\nimport VideoOrImageCanvasBackground from \"../VideoOrImageCanvasBackground\"\nimport useEventCallback from \"use-event-callback\"\nimport RegionShapes from \"../RegionShapes\"\nimport useWasdMode from \"./use-wasd-mode\"\n\nconst useStyles = makeStyles(styles)\n\ntype Props = {\n  regions: Array<Region>,\n  imageSrc?: string,\n  videoSrc?: string,\n  videoTime?: number,\n  keypointDefinitions?: KeypointDefinitions,\n  onMouseMove?: ({ x: number, y: number }) => any,\n  onMouseDown?: ({ x: number, y: number }) => any,\n  onMouseUp?: ({ x: number, y: number }) => any,\n  dragWithPrimary?: boolean,\n  zoomWithPrimary?: boolean,\n  createWithPrimary?: boolean,\n  showTags?: boolean,\n  realSize?: { width: number, height: number, unitName: string },\n  showCrosshairs?: boolean,\n  showMask?: boolean,\n  showHighlightBox?: boolean,\n  showPointDistances?: boolean,\n  pointDistancePrecision?: number,\n  regionClsList?: Array<string>,\n  regionTagList?: Array<string>,\n  allowedArea?: { x: number, y: number, w: number, h: number },\n  RegionEditLabel?: Node,\n  videoPlaying?: boolean,\n  zoomOnAllowedArea?: boolean,\n  fullImageSegmentationMode?: boolean,\n  autoSegmentationOptions?: Object,\n  modifyingAllowedArea?: boolean,\n  allowComments?: Boolean,\n  onChangeRegion: (Region) => any,\n  onBeginRegionEdit: (Region) => any,\n  onCloseRegionEdit: (Region) => any,\n  onDeleteRegion: (Region) => any,\n  onBeginBoxTransform: (Box, [number, number]) => any,\n  onBeginMovePolygonPoint: (Polygon, index: number) => any,\n  onBeginMoveKeypoint: (Keypoints, index: number) => any,\n  onAddPolygonPoint: (Polygon, point: [number, number], index: number) => any,\n  onSelectRegion: (Region) => any,\n  onBeginMovePoint: (Point) => any,\n  onImageOrVideoLoaded: ({\n    naturalWidth: number,\n    naturalHeight: number,\n    duration?: number,\n  }) => any,\n  onChangeVideoTime: (number) => any,\n  onRegionClassAdded: () => {},\n  onChangeVideoPlaying?: Function,\n}\n\nconst getDefaultMat = (allowedArea = null, { iw, ih } = {}) => {\n  let mat = Matrix.from(1, 0, 0, 1, -10, -10)\n  if (allowedArea && iw) {\n    mat = mat\n      .translate(allowedArea.x * iw, allowedArea.y * ih)\n      .scaleU(allowedArea.w + 0.05)\n  }\n  return mat\n}\n\nexport const ImageCanvas = ({\n  regions,\n  imageSrc,\n  videoSrc,\n  videoTime,\n  realSize,\n  showTags,\n  onMouseMove = (p) => null,\n  onMouseDown = (p) => null,\n  onMouseUp = (p) => null,\n  dragWithPrimary = false,\n  zoomWithPrimary = false,\n  createWithPrimary = false,\n  pointDistancePrecision = 0,\n  regionClsList,\n  regionTagList,\n  showCrosshairs,\n  showHighlightBox = true,\n  showPointDistances,\n  allowedArea,\n  RegionEditLabel = null,\n  videoPlaying = false,\n  showMask = true,\n  fullImageSegmentationMode,\n  autoSegmentationOptions,\n  onImageOrVideoLoaded,\n  onChangeRegion,\n  onBeginRegionEdit,\n  onCloseRegionEdit,\n  onBeginBoxTransform,\n  onBeginMovePolygonPoint,\n  onAddPolygonPoint,\n  onBeginMoveKeypoint,\n  onSelectRegion,\n  onBeginMovePoint,\n  onDeleteRegion,\n  onChangeVideoTime,\n  onChangeVideoPlaying,\n  onRegionClassAdded,\n  zoomOnAllowedArea = true,\n  modifyingAllowedArea = false,\n  keypointDefinitions,\n  allowComments,\n}: Props) => {\n  const classes = useStyles()\n\n  const canvasEl = useRef(null)\n  const layoutParams = useRef({})\n  const [dragging, changeDragging] = useRafState(false)\n  const [maskImagesLoaded, changeMaskImagesLoaded] = useRafState(0)\n  const [zoomStart, changeZoomStart] = useRafState(null)\n  const [zoomEnd, changeZoomEnd] = useRafState(null)\n  const [mat, changeMat] = useRafState(getDefaultMat())\n  const maskImages = useRef({})\n  const windowSize = useWindowSize()\n\n  const getLatestMat = useEventCallback(() => mat)\n  useWasdMode({ getLatestMat, changeMat })\n\n  const { mouseEvents, mousePosition } = useMouse({\n    canvasEl,\n    dragging,\n    mat,\n    layoutParams,\n    changeMat,\n    zoomStart,\n    zoomEnd,\n    changeZoomStart,\n    changeZoomEnd,\n    changeDragging,\n    zoomWithPrimary,\n    dragWithPrimary,\n    onMouseMove,\n    onMouseDown,\n    onMouseUp,\n  })\n\n  useLayoutEffect(() => changeMat(mat.clone()), [windowSize])\n\n  const innerMousePos = mat.applyToPoint(\n    mousePosition.current.x,\n    mousePosition.current.y\n  )\n\n  const projectRegionBox = useProjectRegionBox({ layoutParams, mat })\n\n  const [imageDimensions, changeImageDimensions] = useState()\n  const imageLoaded = Boolean(imageDimensions && imageDimensions.naturalWidth)\n\n  const onVideoOrImageLoaded = useEventCallback(\n    ({ naturalWidth, naturalHeight, duration }) => {\n      const dims = { naturalWidth, naturalHeight, duration }\n      if (onImageOrVideoLoaded) onImageOrVideoLoaded(dims)\n      changeImageDimensions(dims)\n      // Redundant update to fix rerendering issues\n      setTimeout(() => changeImageDimensions(dims), 10)\n    }\n  )\n\n  const excludePattern = useExcludePattern()\n\n  const canvas = canvasEl.current\n  if (canvas && imageLoaded) {\n    const { clientWidth, clientHeight } = canvas\n\n    const fitScale = Math.max(\n      imageDimensions.naturalWidth / (clientWidth - 20),\n      imageDimensions.naturalHeight / (clientHeight - 20)\n    )\n\n    const [iw, ih] = [\n      imageDimensions.naturalWidth / fitScale,\n      imageDimensions.naturalHeight / fitScale,\n    ]\n\n    layoutParams.current = {\n      iw,\n      ih,\n      fitScale,\n      canvasWidth: clientWidth,\n      canvasHeight: clientHeight,\n    }\n  }\n\n  useEffect(() => {\n    if (!imageLoaded) return\n    changeMat(\n      getDefaultMat(\n        zoomOnAllowedArea ? allowedArea : null,\n        layoutParams.current\n      )\n    )\n    // eslint-disable-next-line\n  }, [imageLoaded])\n\n  useLayoutEffect(() => {\n    if (!imageDimensions) return\n    const { clientWidth, clientHeight } = canvas\n    canvas.width = clientWidth\n    canvas.height = clientHeight\n    const context = canvas.getContext(\"2d\")\n\n    context.save()\n    context.transform(...mat.clone().inverse().toArray())\n\n    const { iw, ih } = layoutParams.current\n\n    if (allowedArea) {\n      // Pattern to indicate the NOT allowed areas\n      const { x, y, w, h } = allowedArea\n      context.save()\n      context.globalAlpha = 1\n      const outer = [\n        [0, 0],\n        [iw, 0],\n        [iw, ih],\n        [0, ih],\n      ]\n      const inner = [\n        [x * iw, y * ih],\n        [x * iw + w * iw, y * ih],\n        [x * iw + w * iw, y * ih + h * ih],\n        [x * iw, y * ih + h * ih],\n      ]\n      context.moveTo(...outer[0])\n      outer.forEach((p) => context.lineTo(...p))\n      context.lineTo(...outer[0])\n      context.closePath()\n\n      inner.reverse()\n      context.moveTo(...inner[0])\n      inner.forEach((p) => context.lineTo(...p))\n      context.lineTo(...inner[0])\n\n      context.fillStyle = excludePattern || \"#f00\"\n      context.fill()\n\n      context.restore()\n    }\n\n    context.restore()\n  })\n\n  const { iw, ih } = layoutParams.current\n\n  let zoomBox =\n    !zoomStart || !zoomEnd\n      ? null\n      : {\n          ...mat.clone().inverse().applyToPoint(zoomStart.x, zoomStart.y),\n          w: (zoomEnd.x - zoomStart.x) / mat.a,\n          h: (zoomEnd.y - zoomStart.y) / mat.d,\n        }\n  if (zoomBox) {\n    if (zoomBox.w < 0) {\n      zoomBox.x += zoomBox.w\n      zoomBox.w *= -1\n    }\n    if (zoomBox.h < 0) {\n      zoomBox.y += zoomBox.h\n      zoomBox.h *= -1\n    }\n  }\n\n  const imagePosition = {\n    topLeft: mat.clone().inverse().applyToPoint(0, 0),\n    bottomRight: mat.clone().inverse().applyToPoint(iw, ih),\n  }\n\n  const highlightedRegion = useMemo(() => {\n    const highlightedRegions = regions.filter((r) => r.highlighted)\n    if (highlightedRegions.length !== 1) return null\n    return highlightedRegions[0]\n  }, [regions])\n\n  return (\n    <div\n      style={{\n        width: \"100%\",\n        height: \"100%\",\n        maxHeight: \"calc(100vh - 68px)\",\n        position: \"relative\",\n        overflow: \"hidden\",\n        cursor: createWithPrimary\n          ? \"crosshair\"\n          : dragging\n          ? \"grabbing\"\n          : dragWithPrimary\n          ? \"grab\"\n          : zoomWithPrimary\n          ? mat.a < 1\n            ? \"zoom-out\"\n            : \"zoom-in\"\n          : undefined,\n      }}\n    >\n      {showCrosshairs && (\n        <Crosshairs key=\"crossHairs\" mousePosition={mousePosition} />\n      )}\n      {imageLoaded && !dragging && (\n        <RegionSelectAndTransformBoxes\n          key=\"regionSelectAndTransformBoxes\"\n          regions={\n            !modifyingAllowedArea || !allowedArea\n              ? regions\n              : [\n                  {\n                    type: \"box\",\n                    id: \"$$allowed_area\",\n                    cls: \"allowed_area\",\n                    highlighted: true,\n                    x: allowedArea.x,\n                    y: allowedArea.y,\n                    w: allowedArea.w,\n                    h: allowedArea.h,\n                    visible: true,\n                    color: \"#ff0\",\n                  },\n                ]\n          }\n          mouseEvents={mouseEvents}\n          projectRegionBox={projectRegionBox}\n          dragWithPrimary={dragWithPrimary}\n          createWithPrimary={createWithPrimary}\n          zoomWithPrimary={zoomWithPrimary}\n          onBeginMovePoint={onBeginMovePoint}\n          onSelectRegion={onSelectRegion}\n          layoutParams={layoutParams}\n          mat={mat}\n          onBeginBoxTransform={onBeginBoxTransform}\n          onBeginMovePolygonPoint={onBeginMovePolygonPoint}\n          onBeginMoveKeypoint={onBeginMoveKeypoint}\n          onAddPolygonPoint={onAddPolygonPoint}\n          showHighlightBox={showHighlightBox}\n        />\n      )}\n      {imageLoaded && showTags && !dragging && (\n        <PreventScrollToParents key=\"regionTags\">\n          <RegionTags\n            regions={regions}\n            projectRegionBox={projectRegionBox}\n            mouseEvents={mouseEvents}\n            regionClsList={regionClsList}\n            regionTagList={regionTagList}\n            onBeginRegionEdit={onBeginRegionEdit}\n            onChangeRegion={onChangeRegion}\n            onCloseRegionEdit={onCloseRegionEdit}\n            onDeleteRegion={onDeleteRegion}\n            layoutParams={layoutParams}\n            imageSrc={imageSrc}\n            RegionEditLabel={RegionEditLabel}\n            onRegionClassAdded={onRegionClassAdded}\n            allowComments={allowComments}\n          />\n        </PreventScrollToParents>\n      )}\n      {!showTags && highlightedRegion && (\n        <div key=\"topLeftTag\" className={classes.fixedRegionLabel}>\n          <RegionLabel\n            disableClose\n            allowedClasses={regionClsList}\n            allowedTags={regionTagList}\n            onChange={onChangeRegion}\n            onDelete={onDeleteRegion}\n            editing\n            region={highlightedRegion}\n            imageSrc={imageSrc}\n            allowComments={allowComments}\n          />\n        </div>\n      )}\n\n      {zoomWithPrimary && zoomBox !== null && (\n        <div\n          key=\"zoomBox\"\n          style={{\n            position: \"absolute\",\n            zIndex: 1,\n            border: \"1px solid #fff\",\n            pointerEvents: \"none\",\n            left: zoomBox.x,\n            top: zoomBox.y,\n            width: zoomBox.w,\n            height: zoomBox.h,\n          }}\n        />\n      )}\n      {showPointDistances && (\n        <PointDistances\n          key=\"pointDistances\"\n          regions={regions}\n          realSize={realSize}\n          projectRegionBox={projectRegionBox}\n          pointDistancePrecision={pointDistancePrecision}\n        />\n      )}\n      <PreventScrollToParents\n        style={{ width: \"100%\", height: \"100%\" }}\n        {...mouseEvents}\n      >\n        <>\n          {fullImageSegmentationMode && (\n            <ImageMask\n              hide={!showMask}\n              autoSegmentationOptions={autoSegmentationOptions}\n              imagePosition={imagePosition}\n              regionClsList={regionClsList}\n              imageSrc={imageSrc}\n              regions={regions}\n            />\n          )}\n          <canvas\n            style={{ opacity: 0.25 }}\n            className={classes.canvas}\n            ref={canvasEl}\n          />\n          <RegionShapes\n            mat={mat}\n            keypointDefinitions={keypointDefinitions}\n            imagePosition={imagePosition}\n            regions={regions}\n            fullSegmentationMode={fullImageSegmentationMode}\n          />\n          <VideoOrImageCanvasBackground\n            videoPlaying={videoPlaying}\n            imagePosition={imagePosition}\n            mouseEvents={mouseEvents}\n            onLoad={onVideoOrImageLoaded}\n            videoTime={videoTime}\n            videoSrc={videoSrc}\n            imageSrc={imageSrc}\n            useCrossOrigin={fullImageSegmentationMode}\n            onChangeVideoTime={onChangeVideoTime}\n            onChangeVideoPlaying={onChangeVideoPlaying}\n          />\n        </>\n      </PreventScrollToParents>\n      <div className={classes.zoomIndicator}>\n        {((1 / mat.a) * 100).toFixed(0)}%\n      </div>\n    </div>\n  )\n}\n\nexport default ImageCanvas\n","import { grey } from \"@material-ui/core/colors\"\n\nexport default {\n  canvas: { width: \"100%\", height: \"100%\", position: \"relative\", zIndex: 1 },\n  zoomIndicator: {\n    position: \"absolute\",\n    bottom: 16,\n    right: 0,\n    backgroundColor: \"rgba(0,0,0,0.4)\",\n    color: \"#fff\",\n    opacity: 0.5,\n    fontWeight: \"bolder\",\n    fontSize: 14,\n    padding: 4,\n  },\n  fixedRegionLabel: {\n    position: \"absolute\",\n    zIndex: 10,\n    top: 10,\n    left: 10,\n    opacity: 0.5,\n    transition: \"opacity 500ms\",\n    \"&:hover\": {\n      opacity: 1,\n    },\n  },\n}\n","import { useEffect } from \"react\"\nimport { useSettings } from \"../SettingsProvider\"\n\nexport default ({ getLatestMat, changeMat }) => {\n  const { wasdMode } = useSettings()\n  useEffect(() => {\n    if (!wasdMode) return\n    const vel = 10\n    const dirs = {\n      w: [0, -vel],\n      a: [-vel, 0],\n      s: [0, vel],\n      d: [vel, 0],\n    }\n    const keysDown = {}\n    const keys = Object.keys(dirs)\n    const keyDownListener = (e) => {\n      if (keys.includes(e.key)) {\n        keysDown[e.key] = true\n        e.preventDefault()\n        e.stopPropagation()\n      }\n    }\n    const keyUpListener = (e) => {\n      if (keys.includes(e.key)) {\n        keysDown[e.key] = false\n        e.preventDefault()\n        e.stopPropagation()\n      }\n    }\n    const interval = setInterval(() => {\n      let newMat = getLatestMat().clone()\n      let somethingChanged = false\n      for (const key in keysDown) {\n        if (keysDown[key]) {\n          newMat = newMat.translate(...dirs[key])\n          somethingChanged = true\n        }\n      }\n      if (somethingChanged) changeMat(newMat)\n    }, 16)\n    window.addEventListener(\"keydown\", keyDownListener)\n    window.addEventListener(\"keyup\", keyUpListener)\n    return () => {\n      clearInterval(interval)\n      window.removeEventListener(\"keydown\", keyDownListener)\n      window.removeEventListener(\"keyup\", keyUpListener)\n    }\n  }, [wasdMode])\n}\n","// @flow weak\n\nimport { useRef } from \"react\"\nimport excludePatternSrc from \"./xpattern.js\"\n\nexport default () => {\n  const excludePattern = useRef(null)\n  if (excludePattern.current === null) {\n    excludePattern.current = {\n      image: new Image(),\n      pattern: null,\n    }\n    const canvas = document.createElement(\"canvas\")\n    canvas.width = 100\n    canvas.height = 100\n    const context = canvas.getContext(\"2d\")\n\n    excludePattern.current.image.onload = () => {\n      excludePattern.current.pattern = context.createPattern(\n        excludePattern.current.image,\n        \"repeat\"\n      )\n    }\n    excludePattern.current.image.src = excludePatternSrc\n  }\n  return excludePattern.current.pattern\n}\n","export default `data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAB3RJTUUH4wMSAxY5oG+lzgAAABl0RVh0Q29tbWVudABDcmVhdGVkIHdpdGggR0lNUFeBDhcAAAAcSURBVAjXY/jPwPCfAQnA+TAGugLcAhhakRUAAK3lEe8m9qZhAAAAAElFTkSuQmCC`\n","import { grey } from \"@material-ui/core/colors\"\n\nexport default {\n  container: {\n    display: \"flex\",\n    flexGrow: 1,\n    flexDirection: \"column\",\n    height: \"100%\",\n    maxHeight: \"100vh\",\n    backgroundColor: \"#fff\",\n    overflow: \"hidden\",\n    \"&.fullscreen\": {\n      position: \"absolute\",\n      zIndex: 99999,\n      left: 0,\n      right: 0,\n      top: 0,\n      bottom: 0,\n    },\n  },\n  headerTitle: {\n    fontWeight: \"bold\",\n    color: grey[700],\n    paddingLeft: 16,\n  },\n}\n","// @flow\n\nimport React from \"react\"\nimport Dialog from \"@material-ui/core/Dialog\"\nimport DialogTitle from \"@material-ui/core/DialogTitle\"\nimport DialogContent from \"@material-ui/core/DialogContent\"\nimport DialogActions from \"@material-ui/core/DialogActions\"\nimport Button from \"@material-ui/core/Button\"\nimport Survey from \"material-survey/components/Survey\"\nimport { useSettings } from \"../SettingsProvider\"\n\nexport const SettingsDialog = ({ open, onClose }) => {\n  const settings = useSettings()\n  return (\n    <Dialog open={open || false} onClose={onClose}>\n      <DialogTitle>Settings</DialogTitle>\n      <DialogContent style={{ minWidth: 400 }}>\n        <Survey\n          variant=\"flat\"\n          noActions\n          defaultAnswers={settings}\n          onQuestionChange={(q, a, answers) => settings.changeSetting(q, a)}\n          form={{\n            questions: [\n              {\n                type: \"boolean\",\n                title: \"Show Crosshairs\",\n                name: \"showCrosshairs\",\n              },\n              {\n                type: \"boolean\",\n                title: \"Show Highlight Box\",\n                name: \"showHighlightBox\",\n              },\n              {\n                type: \"boolean\",\n                title: \"WASD Mode\",\n                name: \"wasdMode\",\n              },\n              {\n                type: \"dropdown\",\n                title: \"Video Playback Speed\",\n                name: \"videoPlaybackSpeed\",\n                defaultValue: \"1x\",\n                choices: [\"0.25x\", \"0.5x\", \"1x\", \"2x\"],\n              },\n            ],\n          }}\n        />\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={onClose}>Close</Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nexport default SettingsDialog\n","import { getIn } from \"seamless-immutable\"\n\nexport default (state) => {\n  let currentImageIndex = null,\n    pathToActiveImage,\n    activeImage\n  if (state.annotationType === \"image\") {\n    currentImageIndex = state.selectedImage\n    if (currentImageIndex === -1) {\n      currentImageIndex = null\n      activeImage = null\n    } else {\n      pathToActiveImage = [\"images\", currentImageIndex]\n      activeImage = getIn(state, pathToActiveImage)\n    }\n  } else if (state.annotationType === \"video\") {\n    pathToActiveImage = [\"keyframes\", state.currentVideoTime || 0]\n    activeImage = getIn(state, pathToActiveImage) || null\n  }\n  return { currentImageIndex, pathToActiveImage, activeImage }\n}\n","// @flow\n\nimport type { Region } from \"../../ImageCanvas/region-tools.js\"\n\nconst emptyArr = []\n\nexport default (\n  keyframes: { [string | number]: { regions: Array<Region> } },\n  time: number\n) => {\n  if (keyframes[time || 0]) {\n    return keyframes[time || 0].regions\n  }\n  // Get surrounding video keyframes\n  const keyframeTimes = Object.keys(keyframes)\n    .map((a) => parseInt(a))\n    .filter((a) => !isNaN(a))\n  if (keyframeTimes.length === 0) return emptyArr\n  keyframeTimes.sort((a, b) => a - b)\n  let nextKeyframeTimeIndex = keyframeTimes.findIndex((kt) => kt >= time)\n  if (nextKeyframeTimeIndex === -1) {\n    return (\n      keyframes[keyframeTimes[keyframeTimes.length - 1]].regions || emptyArr\n    )\n  } else if (nextKeyframeTimeIndex === 0) {\n    return emptyArr\n  }\n\n  const t1 = keyframeTimes[nextKeyframeTimeIndex - 1]\n  const prevKeyframe = keyframes[t1]\n  const t2 = keyframeTimes[nextKeyframeTimeIndex]\n  const nextKeyframe = keyframes[t2]\n\n  const [prevRegionMap, nextRegionMap] = [{}, {}]\n  for (const region of prevKeyframe.regions) prevRegionMap[region.id] = region\n  for (const region of nextKeyframe.regions) nextRegionMap[region.id] = region\n\n  const impliedRegions = []\n\n  // Weighted time coefficients for linear transition\n  const w1 = (t2 - time) / (t2 - t1)\n  const w2 = 1 - w1\n\n  for (const regionId in prevRegionMap) {\n    const [prev, next] = [prevRegionMap[regionId], nextRegionMap[regionId]]\n    if (!next) {\n      impliedRegions.push({\n        ...prev,\n        highlighted: false,\n        editingLabels: false,\n      })\n      continue\n    }\n    switch (prev.type) {\n      case \"point\": {\n        impliedRegions.push({\n          ...prev,\n          highlighted: false,\n          editingLabels: false,\n          x: prev.x * w1 + next.x * w2,\n          y: prev.y * w1 + next.y * w2,\n        })\n        break\n      }\n      case \"box\": {\n        impliedRegions.push({\n          ...prev,\n          highlighted: false,\n          editingLabels: false,\n          x: prev.x * w1 + next.x * w2,\n          y: prev.y * w1 + next.y * w2,\n          w: prev.w * w1 + next.w * w2,\n          h: prev.h * w1 + next.h * w2,\n        })\n        break\n      }\n      case \"polygon\": {\n        if (next.points.length === prev.points.length) {\n          impliedRegions.push({\n            ...prev,\n            highlighted: false,\n            editingLabels: false,\n            points: prev.points.map((pp, i) => [\n              pp[0] * w1 + next.points[i][0] * w2,\n              pp[1] * w1 + next.points[i][1] * w2,\n            ]),\n          })\n        } else {\n          impliedRegions.push(prev)\n        }\n        break\n      }\n      case \"keypoints\": {\n        const newPoints = {}\n        for (const [pointId, prevPoint] of Object.entries(prev.points)) {\n          newPoints[pointId] = {\n            x: prevPoint.x * w1 + next.points[pointId].x * w2,\n            y: prevPoint.y * w1 + next.points[pointId].y * w2,\n          }\n        }\n        impliedRegions.push({\n          ...prev,\n          highlighted: false,\n          editingLabels: false,\n          points: newPoints,\n        })\n        break\n      }\n      default:\n        break\n    }\n  }\n\n  return impliedRegions\n}\n","// @flow\n\nimport { useMemo } from \"react\"\nimport type { MainLayoutVideoAnnotationState } from \"../Annotator/types\"\nimport getImpliedVideoRegions from \"../Annotator/reducers/get-implied-video-regions.js\"\n\nconst emptyArr = []\n\nexport default (state: MainLayoutVideoAnnotationState) => {\n  if (state.annotationType !== \"video\") return emptyArr\n  const { keyframes, currentVideoTime = 0 } = state\n  // TODO memoize\n  return useMemo(() => getImpliedVideoRegions(keyframes, currentVideoTime), [\n    keyframes,\n    currentVideoTime,\n  ])\n}\n","// @flow\n\nimport React from \"react\"\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\nimport {\n  faArrowsAlt,\n  faMousePointer,\n  faExpandArrowsAlt,\n  faGripLines,\n  faTag,\n  faPaintBrush,\n  faCrosshairs,\n  faDrawPolygon,\n  faVectorSquare,\n  faHandPaper,\n  faSearch,\n  faMask,\n  faEdit,\n  faChartLine,\n} from \"@fortawesome/free-solid-svg-icons\"\nimport FullscreenIcon from \"@material-ui/icons/Fullscreen\"\nimport AccessibilityNewIcon from \"@material-ui/icons/AccessibilityNew\"\n\nconst faStyle = { marginTop: 4, width: 16, height: 16, marginBottom: 4 }\n\nexport const iconDictionary = {\n  select: () => (\n    <FontAwesomeIcon\n      style={faStyle}\n      size=\"xs\"\n      fixedWidth\n      icon={faMousePointer}\n    />\n  ),\n  pan: () => (\n    <FontAwesomeIcon style={faStyle} size=\"xs\" fixedWidth icon={faHandPaper} />\n  ),\n  zoom: () => (\n    <FontAwesomeIcon style={faStyle} size=\"xs\" fixedWidth icon={faSearch} />\n  ),\n  \"show-tags\": () => (\n    <FontAwesomeIcon style={faStyle} size=\"xs\" fixedWidth icon={faTag} />\n  ),\n  \"create-point\": () => (\n    <FontAwesomeIcon style={faStyle} size=\"xs\" fixedWidth icon={faCrosshairs} />\n  ),\n  \"create-box\": () => (\n    <FontAwesomeIcon\n      style={faStyle}\n      size=\"xs\"\n      fixedWidth\n      icon={faVectorSquare}\n    />\n  ),\n  \"create-polygon\": () => (\n    <FontAwesomeIcon\n      style={faStyle}\n      size=\"xs\"\n      fixedWidth\n      icon={faDrawPolygon}\n    />\n  ),\n  \"create-expanding-line\": () => (\n    <FontAwesomeIcon style={faStyle} size=\"xs\" fixedWidth icon={faGripLines} />\n  ),\n  \"create-line\": () => (\n    <FontAwesomeIcon style={faStyle} size=\"xs\" fixedWidth icon={faChartLine} />\n  ),\n  \"show-mask\": () => (\n    <FontAwesomeIcon style={faStyle} size=\"xs\" fixedWidth icon={faMask} />\n  ),\n  \"modify-allowed-area\": () => (\n    <FontAwesomeIcon style={faStyle} size=\"xs\" fixedWidth icon={faEdit} />\n  ),\n  \"create-keypoints\": AccessibilityNewIcon,\n  window: FullscreenIcon,\n}\n\nexport default iconDictionary\n","// @flow\n\nconst getTimeString = (ms, precision = 1) => {\n  if (ms < 1000) {\n    return ms + \"ms\"\n  } else {\n    const secs = ms / 1000\n    if (secs < 60) {\n      if (Number.isInteger(secs)) {\n        return secs + \"s\"\n      } else {\n        return secs.toFixed(precision) + \"s\"\n      }\n    } else {\n      const mins = secs / 60\n      if (Number.isInteger(mins)) {\n        return mins + \"m\"\n      } else {\n        return mins.toFixed(precision) + \"m\"\n      }\n    }\n  }\n}\n\nexport default getTimeString\n","// @flow weak\n\nimport React, { useMemo, useState, useEffect } from \"react\"\nimport { styled } from \"@material-ui/core/styles\"\nimport range from \"lodash/range\"\nimport * as colors from \"@material-ui/core/colors\"\nimport useMeasure from \"react-use-measure\"\nimport useEventCallback from \"use-event-callback\"\nimport { useRafState } from \"react-use\"\nimport getTimeString from \"./get-time-string\"\n\nconst Container = styled(\"div\")({\n  position: \"relative\",\n  display: \"flex\",\n  flexGrow: 1,\n  minWidth: 240,\n  height: 64,\n  marginLeft: 16,\n  marginRight: 16,\n})\n\nconst Tick = styled(\"div\")({\n  position: \"absolute\",\n  width: 2,\n  marginLeft: -1,\n  height: \"100%\",\n  backgroundColor: colors.grey[300],\n  bottom: 0,\n})\nconst TickText = styled(\"div\")({\n  position: \"absolute\",\n  userSelect: \"none\",\n  fontSize: 10,\n  color: colors.grey[600],\n  fontWeight: \"bold\",\n  bottom: 0,\n})\n\nconst PositionCursor = styled(\"div\")({\n  position: \"absolute\",\n  bottom: \"calc(50% + 6px)\",\n  fontSize: 10,\n  fontWeight: \"bold\",\n  color: \"#fff\",\n  display: \"grid\",\n  placeItems: \"center\",\n  width: 48,\n  marginLeft: -24,\n  borderRadius: 2,\n  height: 24,\n  backgroundColor: colors.blue[500],\n  userSelect: \"none\",\n  fontVariantNumeric: \"tabular-nums\",\n\n  \"&::before\": {\n    position: \"absolute\",\n    bottom: -6,\n    left: 24 - 8,\n    content: '\"\"',\n    width: 0,\n    height: 0,\n    borderTop: `8px solid ${colors.blue[500]}`,\n    borderLeft: \"8px solid transparent\",\n    borderRight: \"8px solid transparent\",\n  },\n})\n\nconst KeyframeMarker = styled(\"div\")({\n  position: \"absolute\",\n  bottom: 8,\n  cursor: \"pointer\",\n  opacity: 0.75,\n  fontSize: 10,\n  fontWeight: \"bold\",\n  color: \"#fff\",\n  display: \"grid\",\n  placeItems: \"center\",\n  width: 16,\n  marginLeft: 0,\n  borderTopLeftRadius: 2,\n  borderTopRightRadius: 2,\n  height: 12,\n  marginLeft: -8,\n  backgroundColor: colors.red[500],\n  userSelect: \"none\",\n  fontVariantNumeric: \"tabular-nums\",\n\n  \"&::before\": {\n    position: \"absolute\",\n    bottom: -8,\n    left: 0,\n    content: '\"\"',\n    width: 0,\n    height: 0,\n    borderTop: `8px solid ${colors.red[500]}`,\n    borderLeft: \"8px solid transparent\",\n    borderRight: \"8px solid transparent\",\n  },\n})\n\nconst min = 60000\nconst displayIntervalPairs = [\n  [50, 250],\n  [100, 500],\n  [250, 1000],\n  [1000, 5000],\n  [5000, 30000],\n  [10000, min],\n  [30000, min * 2],\n  [min, min * 5],\n  [min * 5, min * 30],\n  [min * 10, min * 60],\n  [min * 30, min * 60 * 3],\n  [min * 60, min * 60 * 5],\n]\n\nconst getMajorInterval = (duration) => {\n  for (const [minor, major] of displayIntervalPairs) {\n    if (duration / major < 6 && duration / major > 2) {\n      return [minor, major]\n    }\n  }\n  return [duration / 4, duration]\n}\n\nexport default ({\n  currentTime = 0,\n  duration,\n  onChangeCurrentTime,\n  keyframes,\n}) => {\n  const [ref, bounds] = useMeasure()\n  const [instantCurrentTime, changeInstantCurrentTime] = useState(currentTime)\n  const [draggingTime, changeDraggingTime] = useRafState(false)\n  const keyframeTimes = Object.keys(keyframes || {})\n    .map((t) => parseInt(t))\n    .filter((t) => !isNaN(t))\n    .sort((a, b) => a - b)\n\n  useEffect(() => {\n    if (currentTime !== instantCurrentTime) {\n      changeInstantCurrentTime(currentTime)\n    }\n  }, [currentTime])\n\n  const [minorInterval, majorInterval] = useMemo(\n    () => getMajorInterval(duration),\n    [duration]\n  )\n\n  const onMouseMove = useEventCallback((e) => {\n    if (draggingTime) {\n      const px = (e.clientX - bounds.left) / bounds.width\n      changeInstantCurrentTime(\n        Math.min(duration, Math.max(0, Math.floor(px * duration)))\n      )\n    }\n  })\n\n  const onMouseUp = useEventCallback((e) => {\n    changeDraggingTime(false)\n    const px = (e.clientX - bounds.left) / bounds.width\n    const newTime = Math.min(duration, Math.max(0, Math.floor(px * duration)))\n    changeInstantCurrentTime(newTime)\n    onChangeCurrentTime(newTime)\n  })\n\n  // TODO skeleton\n  if (!duration) return null\n\n  return (\n    <Container onMouseMove={onMouseMove} onMouseUp={onMouseUp} ref={ref}>\n      {range(0, duration, majorInterval).map((a) => (\n        <>\n          <Tick\n            key={a}\n            style={{ left: (a / duration) * bounds.width, height: \"50%\" }}\n          />\n          <TickText\n            style={{\n              left: (a / duration) * bounds.width + 8,\n              bottom: \"calc(50% - 12px)\",\n            }}\n          >\n            {getTimeString(a)}\n          </TickText>\n        </>\n      ))}\n      {range(0, duration, minorInterval)\n        .filter((a) => !Number.isInteger(a / majorInterval))\n        .map((a) => (\n          <Tick\n            key={a}\n            style={{\n              left: (a / duration) * bounds.width,\n              height: \"25%\",\n            }}\n          />\n        ))}\n      {keyframeTimes.map((kt) => (\n        <KeyframeMarker\n          onClick={() => onChangeCurrentTime(kt)}\n          key={kt}\n          style={{ left: (kt / duration) * bounds.width }}\n        />\n      ))}\n      <PositionCursor\n        onMouseDown={(e) => changeDraggingTime(true)}\n        style={{\n          cursor: draggingTime ? \"grabbing\" : \"grab\",\n          left: (instantCurrentTime / duration) * bounds.width,\n        }}\n      >\n        {getTimeString(instantCurrentTime)}\n      </PositionCursor>\n    </Container>\n  )\n}\n","// @flow\n\nimport React, { useState, memo } from \"react\"\nimport Paper from \"@material-ui/core/Paper\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport ExpandIcon from \"@material-ui/icons/ExpandMore\"\nimport IconButton from \"@material-ui/core/IconButton\"\nimport Collapse from \"@material-ui/core/Collapse\"\nimport { grey } from \"@material-ui/core/colors\"\nimport classnames from \"classnames\"\nimport useEventCallback from \"use-event-callback\"\nimport SidebarBox from \"react-material-workspace-layout/SidebarBox\"\n\nconst useStyles = makeStyles({\n  container: { margin: 8 },\n  header: {\n    display: \"flex\",\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    padding: 8,\n    paddingLeft: 16,\n    paddingRight: 16,\n  },\n  title: {\n    fontSize: 14,\n    fontWeight: \"bold\",\n    flexGrow: 1,\n    paddingLeft: 8,\n    color: grey[800],\n    \"& span\": {\n      color: grey[600],\n      fontSize: 12,\n    },\n  },\n  expandButton: {\n    padding: 0,\n    width: 30,\n    height: 30,\n    \"& .icon\": {\n      marginTop: -6,\n      width: 20,\n      height: 20,\n      transition: \"500ms transform\",\n      \"&.expanded\": {\n        transform: \"rotate(180deg)\",\n      },\n    },\n  },\n  expandedContent: {\n    maxHeight: 300,\n    overflowY: \"auto\",\n    \"&.noScroll\": {\n      overflowY: \"visible\",\n      overflow: \"visible\",\n    },\n  },\n})\n\nexport const SidebarBoxContainer = ({\n  icon,\n  title,\n  subTitle,\n  children,\n  noScroll = false,\n  expandedByDefault = false,\n}) => {\n  const classes = useStyles()\n  const content = (\n    <div\n      className={classnames(classes.expandedContent, noScroll && \"noScroll\")}\n    >\n      {children}\n    </div>\n  )\n\n  const [expanded, changeExpanded] = useState(expandedByDefault)\n  const toggleExpanded = useEventCallback(() => changeExpanded(!expanded))\n\n  return (\n    <SidebarBox icon={icon} title={title}>\n      {children}\n    </SidebarBox>\n  )\n}\n\nexport default memo(\n  SidebarBoxContainer,\n  (prev, next) => prev.title === next.title && prev.children === next.children\n)\n","// @flow\n\nimport React from \"react\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\n\nexport const DebugSidebarBox = ({ state, lastAction }: any) => {\n  const image = (state.images || [])[state.selectedImage]\n  const region = image\n    ? (image.regions || []).filter((r) => r.highlighted)\n    : null\n\n  return (\n    <SidebarBoxContainer title=\"Debug\" icon={<span />} expandedByDefault>\n      <div style={{ padding: 4 }}>\n        <div>\n          <b>region</b>:\n        </div>\n        <pre>{JSON.stringify(region, null, \"  \")}</pre>\n        <div>\n          <b>lastAction</b>:\n        </div>\n        <pre>{JSON.stringify(lastAction, null, \"  \")}</pre>\n        <div>\n          <b>mode</b>:\n        </div>\n        <pre>{JSON.stringify(state.mode, null, \"  \")}</pre>\n        <div>\n          <b>frame:</b>\n        </div>\n        <pre>{JSON.stringify(state.selectedImageFrameTime, null, \"  \")}</pre>\n      </div>\n    </SidebarBoxContainer>\n  )\n}\n\nexport default DebugSidebarBox\n","// @flow\n\nimport React, { useMemo, memo } from \"react\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport StyleIcon from \"@material-ui/icons/Style\"\nimport { grey } from \"@material-ui/core/colors\"\nimport Select from \"react-select\"\nimport useEventCallback from \"use-event-callback\"\nimport { asMutable } from \"seamless-immutable\"\n\nconst useStyles = makeStyles({})\n\ntype Props = {\n  tags: Array<string>,\n  currentImage: { cls?: string, tags?: Array<string> },\n  imageClsList?: Array<string>,\n  imageTagList?: Array<string>,\n  onChangeImage: (Array<string>) => any,\n}\n\nconst emptyArr = []\nconst noop = () => null\n\nexport const TagsSidebarBox = ({\n  currentImage,\n  imageClsList = emptyArr,\n  imageTagList = emptyArr,\n  onChangeImage = noop,\n}: Props) => {\n  const { tags = [], cls = null } = currentImage || {}\n  const onChangeClassification = useEventCallback((o) =>\n    onChangeImage({ cls: o.value })\n  )\n  const onChangeTags = useEventCallback((o) =>\n    onChangeImage({ tags: o.map((a) => a.value) })\n  )\n  const selectValue = useMemo(() => (cls ? { value: cls, label: cls } : null), [\n    cls,\n  ])\n  const memoImgClsList = useMemo(\n    () => asMutable(imageClsList.map((c) => ({ value: c, label: c }))),\n    [imageClsList]\n  )\n  const memoImgTagList = useMemo(\n    () => asMutable(imageTagList.map((c) => ({ value: c, label: c }))),\n    [imageTagList]\n  )\n  const memoCurrentTags = useMemo(\n    () => tags.map((r) => ({ value: r, label: r })),\n    [tags]\n  )\n\n  if (!currentImage) return null\n\n  return (\n    <SidebarBoxContainer\n      title=\"Image Tags\"\n      expandedByDefault\n      noScroll\n      icon={<StyleIcon style={{ color: grey[700] }} />}\n    >\n      {imageClsList.length > 0 && (\n        <div style={{ padding: 8 }}>\n          <Select\n            placeholder=\"Image Classification\"\n            onChange={onChangeClassification}\n            value={selectValue}\n            options={memoImgClsList}\n          />\n        </div>\n      )}\n      {imageTagList.length > 0 && (\n        <div style={{ padding: 8, paddingTop: 0 }}>\n          <Select\n            isMulti\n            placeholder=\"Image Tags\"\n            onChange={onChangeTags}\n            value={memoCurrentTags}\n            options={memoImgTagList}\n          />\n        </div>\n      )}\n    </SidebarBoxContainer>\n  )\n}\n\nexport default memo(\n  TagsSidebarBox,\n  (prevProps, nextProps) =>\n    prevProps.currentImage.cls === nextProps.currentImage.cls &&\n    prevProps.currentImage.tags === nextProps.currentImage.tags &&\n    prevProps.imageClsList === nextProps.imageClsList &&\n    prevProps.imageTagList === nextProps.imageTagList\n)\n","// @flow weak\n\nimport React from \"react\"\nimport AddLocationIcon from \"@material-ui/icons/AddLocation\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\nimport * as colors from \"@material-ui/core/colors\"\nimport getTimeString from \"../KeyframeTimeline/get-time-string.js\"\nimport TrashIcon from \"@material-ui/icons/Delete\"\nimport { styled } from \"@material-ui/core/styles\"\n\nconst KeyframeRow = styled(\"div\")({\n  cursor: \"pointer\",\n  display: \"flex\",\n  alignItems: \"center\",\n  padding: 8,\n  fontSize: 14,\n  color: colors.grey[700],\n  \"&.current\": {\n    backgroundColor: colors.blue[100],\n  },\n  \"&:hover\": {\n    backgroundColor: colors.grey[100],\n  },\n  \"& .time\": {\n    flexGrow: 1,\n    fontWeight: \"bold\",\n    \"& .regionCount\": {\n      marginLeft: 8,\n      fontWeight: \"normal\",\n      color: colors.grey[500],\n    },\n  },\n  \"& .trash\": {\n    \"& .icon\": {\n      fontSize: 18,\n      color: colors.grey[600],\n      transition: \"transform 80ms\",\n      \"&:hover\": {\n        color: colors.grey[800],\n        transform: \"scale(1.25,1.25)\",\n      },\n    },\n  },\n})\n\nconst KeyframesSelectorSidebarBox = ({\n  currentVideoTime,\n  keyframes,\n  onChangeVideoTime,\n  onDeleteKeyframe,\n}) => {\n  const keyframeTimes = Object.keys(keyframes).map((t) => parseInt(t))\n\n  return (\n    <SidebarBoxContainer\n      title=\"Keyframes\"\n      subTitle=\"\"\n      icon={<AddLocationIcon style={{ color: colors.grey[700] }} />}\n      expandedByDefault\n    >\n      {keyframeTimes.map((t) => (\n        <KeyframeRow\n          fullWidth\n          key={t}\n          className={currentVideoTime === t ? \"current\" : \"\"}\n          onClick={() => onChangeVideoTime(t)}\n        >\n          <div className=\"time\">\n            {getTimeString(t, 2)}\n            <span className=\"regionCount\">\n              ({(keyframes[t]?.regions || []).length})\n            </span>\n          </div>\n          <div className=\"trash\">\n            <TrashIcon\n              onClick={(e) => {\n                onDeleteKeyframe(t)\n                e.stopPropagation()\n              }}\n              className=\"icon\"\n            />\n          </div>\n        </KeyframeRow>\n      ))}\n    </SidebarBoxContainer>\n  )\n}\n\nexport default KeyframesSelectorSidebarBox\n","// @flow\n\nimport React, { memo } from \"react\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\nimport DescriptionIcon from \"@material-ui/icons/Description\"\nimport { styled } from \"@material-ui/core/styles\"\nimport { grey } from \"@material-ui/core/colors\"\nimport Markdown from \"react-markdown\"\n\nconst MarkdownContainer = styled(\"div\")({\n  paddingLeft: 16,\n  paddingRight: 16,\n  fontSize: 12,\n  \"& h1\": { fontSize: 18 },\n  \"& h2\": { fontSize: 14 },\n  \"& h3\": { fontSize: 12 },\n  \"& h4\": { fontSize: 12 },\n  \"& h5\": { fontSize: 12 },\n  \"& h6\": { fontSize: 12 },\n  \"& p\": { fontSize: 12 },\n  \"& a\": {},\n  \"& img\": { width: \"100%\" },\n})\n\nexport const TaskDescriptionSidebarBox = ({ description }) => {\n  return (\n    <SidebarBoxContainer\n      title=\"Task Description\"\n      icon={<DescriptionIcon style={{ color: grey[700] }} />}\n      expandedByDefault={description && description !== \"\" ? false : true}\n    >\n      <MarkdownContainer>\n        <Markdown source={description} />\n      </MarkdownContainer>\n    </SidebarBoxContainer>\n  )\n}\n\nexport default memo(TaskDescriptionSidebarBox)\n","import { grey, blue, orange, purple } from \"@material-ui/core/colors\"\n\nexport default {\n  container: {\n    fontSize: 11,\n    fontWeight: \"bold\",\n    color: grey[700],\n    \"& .icon\": {\n      marginTop: 4,\n      width: 16,\n      height: 16,\n    },\n    \"& .icon2\": {\n      opacity: 0.5,\n      width: 16,\n      height: 16,\n      transition: \"200ms opacity\",\n      \"&:hover\": {\n        cursor: \"pointer\",\n        opacity: 1,\n      },\n    },\n  },\n  row: {\n    padding: 4,\n    cursor: \"pointer\",\n    \"&.header:hover\": {\n      backgroundColor: \"#fff\",\n    },\n    \"&.highlighted\": {\n      backgroundColor: blue[100],\n    },\n    \"&:hover\": {\n      backgroundColor: blue[50],\n      color: grey[800],\n    },\n  },\n  chip: {\n    display: \"flex\",\n    flexDirection: \"row\",\n    padding: 2,\n    borderRadius: 2,\n    paddingLeft: 4,\n    paddingRight: 4,\n    alignItems: \"center\",\n    \"& .color\": {\n      borderRadius: 5,\n      width: 10,\n      height: 10,\n      marginRight: 4,\n    },\n    \"& .text\": {},\n  },\n}\n","// @flow\n\nimport React, { Fragment, useState, memo } from \"react\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\nimport { makeStyles, styled } from \"@material-ui/core/styles\"\nimport { grey } from \"@material-ui/core/colors\"\nimport RegionIcon from \"@material-ui/icons/PictureInPicture\"\nimport Grid from \"@material-ui/core/Grid\"\nimport ReorderIcon from \"@material-ui/icons/SwapVert\"\nimport PieChartIcon from \"@material-ui/icons/PieChart\"\nimport TrashIcon from \"@material-ui/icons/Delete\"\nimport LockIcon from \"@material-ui/icons/Lock\"\nimport UnlockIcon from \"@material-ui/icons/LockOpen\"\nimport VisibleIcon from \"@material-ui/icons/Visibility\"\nimport VisibleOffIcon from \"@material-ui/icons/VisibilityOff\"\nimport styles from \"./styles\"\nimport classnames from \"classnames\"\nimport isEqual from \"lodash/isEqual\"\n\nconst useStyles = makeStyles(styles)\n\nconst HeaderSep = styled(\"div\")({\n  borderTop: `1px solid ${grey[200]}`,\n  marginTop: 2,\n  marginBottom: 2,\n})\n\nconst Chip = ({ color, text }) => {\n  const classes = useStyles()\n  return (\n    <span className={classes.chip}>\n      <div className=\"color\" style={{ backgroundColor: color }} />\n      <div className=\"text\">{text}</div>\n    </span>\n  )\n}\n\nconst RowLayout = ({\n  header,\n  highlighted,\n  order,\n  classification,\n  area,\n  tags,\n  trash,\n  lock,\n  visible,\n  onClick,\n}) => {\n  const classes = useStyles()\n  const [mouseOver, changeMouseOver] = useState(false)\n  return (\n    <div\n      onClick={onClick}\n      onMouseEnter={() => changeMouseOver(true)}\n      onMouseLeave={() => changeMouseOver(false)}\n      className={classnames(classes.row, { header, highlighted })}\n    >\n      <Grid container alignItems=\"center\">\n        <Grid item xs={2}>\n          <div style={{ textAlign: \"right\", paddingRight: 10 }}>{order}</div>\n        </Grid>\n        <Grid item xs={5}>\n          {classification}\n        </Grid>\n        <Grid item xs={2}>\n          <div style={{ textAlign: \"right\", paddingRight: 6 }}>{area}</div>\n        </Grid>\n        <Grid item xs={1}>\n          {trash}\n        </Grid>\n        <Grid item xs={1}>\n          {lock}\n        </Grid>\n        <Grid item xs={1}>\n          {visible}\n        </Grid>\n      </Grid>\n    </div>\n  )\n}\n\nconst RowHeader = () => {\n  return (\n    <RowLayout\n      header\n      highlighted={false}\n      order={<ReorderIcon className=\"icon\" />}\n      classification={<div style={{ paddingLeft: 10 }}>Class</div>}\n      area={<PieChartIcon className=\"icon\" />}\n      trash={<TrashIcon className=\"icon\" />}\n      lock={<LockIcon className=\"icon\" />}\n      visible={<VisibleIcon className=\"icon\" />}\n    />\n  )\n}\n\nconst MemoRowHeader = memo(RowHeader)\n\nconst Row = ({\n  region: r,\n  highlighted,\n  onSelectRegion,\n  onDeleteRegion,\n  onChangeRegion,\n  visible,\n  locked,\n  color,\n  cls,\n  index,\n}) => {\n  return (\n    <RowLayout\n      header={false}\n      highlighted={highlighted}\n      onClick={() => onSelectRegion(r)}\n      order={`#${index + 1}`}\n      classification={<Chip text={cls || \"\"} color={color || \"#ddd\"} />}\n      area=\"\"\n      trash={<TrashIcon onClick={() => onDeleteRegion(r)} className=\"icon2\" />}\n      lock={\n        r.locked ? (\n          <LockIcon\n            onClick={() => onChangeRegion({ ...r, locked: false })}\n            className=\"icon2\"\n          />\n        ) : (\n          <UnlockIcon\n            onClick={() => onChangeRegion({ ...r, locked: true })}\n            className=\"icon2\"\n          />\n        )\n      }\n      visible={\n        r.visible || r.visible === undefined ? (\n          <VisibleIcon\n            onClick={() => onChangeRegion({ ...r, visible: false })}\n            className=\"icon2\"\n          />\n        ) : (\n          <VisibleOffIcon\n            onClick={() => onChangeRegion({ ...r, visible: true })}\n            className=\"icon2\"\n          />\n        )\n      }\n    />\n  )\n}\n\nconst MemoRow = memo(\n  Row,\n  (prevProps, nextProps) =>\n    prevProps.highlighted === nextProps.highlighted &&\n    prevProps.visible === nextProps.visible &&\n    prevProps.locked === nextProps.locked &&\n    prevProps.id === nextProps.id &&\n    prevProps.index === nextProps.index &&\n    prevProps.cls === nextProps.cls &&\n    prevProps.color === nextProps.color\n)\n\nconst emptyArr = []\n\nexport const RegionSelectorSidebarBox = ({\n  regions = emptyArr,\n  onDeleteRegion,\n  onChangeRegion,\n  onSelectRegion,\n}) => {\n  const classes = useStyles()\n  return (\n    <SidebarBoxContainer\n      title=\"Regions\"\n      subTitle=\"\"\n      icon={<RegionIcon style={{ color: grey[700] }} />}\n      expandedByDefault\n    >\n      <div className={classes.container}>\n        <MemoRowHeader />\n        <HeaderSep />\n        {regions.map((r, i) => (\n          <MemoRow\n            key={r.id}\n            {...r}\n            region={r}\n            index={i}\n            onSelectRegion={onSelectRegion}\n            onDeleteRegion={onDeleteRegion}\n            onChangeRegion={onChangeRegion}\n          />\n        ))}\n      </div>\n    </SidebarBoxContainer>\n  )\n}\n\nconst mapUsedRegionProperties = (r) => [\n  r.id,\n  r.color,\n  r.locked,\n  r.visible,\n  r.highlighted,\n]\n\nexport default memo(RegionSelectorSidebarBox, (prevProps, nextProps) =>\n  isEqual(\n    (prevProps.regions || emptyArr).map(mapUsedRegionProperties),\n    (nextProps.regions || emptyArr).map(mapUsedRegionProperties)\n  )\n)\n","// @flow\n\nimport React, { memo } from \"react\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\nimport CollectionsIcon from \"@material-ui/icons/Collections\"\nimport { grey } from \"@material-ui/core/colors\"\nimport List from \"@material-ui/core/List\"\nimport ListItem from \"@material-ui/core/ListItem\"\nimport ListItemText from \"@material-ui/core/ListItemText\"\nimport Avatar from \"@material-ui/core/Avatar\"\nimport isEqual from \"lodash/isEqual\"\n\nconst useStyles = makeStyles({\n  img: { width: 40, height: 40, borderRadius: 8 },\n})\n\nexport const ImageSelectorSidebarBox = ({ images, onSelect }) => {\n  const classes = useStyles()\n  return (\n    <SidebarBoxContainer\n      title=\"Images\"\n      subTitle={`(${images.length})`}\n      icon={<CollectionsIcon style={{ color: grey[700] }} />}\n    >\n      <div>\n        <List>\n          {images.map((img, i) => (\n            <ListItem button onClick={() => onSelect(img)} dense key={i}>\n              <img className={classes.img} src={img.src} />\n              <ListItemText\n                primary={img.name}\n                secondary={`${(img.regions || []).length} Labels`}\n              />\n            </ListItem>\n          ))}\n        </List>\n      </div>\n    </SidebarBoxContainer>\n  )\n}\n\nconst mapUsedImageProps = (a) => [a.name, (a.regions || []).length, a.src]\n\nexport default memo(ImageSelectorSidebarBox, (prevProps, nextProps) =>\n  isEqual(\n    prevProps.images.map(mapUsedImageProps),\n    nextProps.images.map(mapUsedImageProps)\n  )\n)\n","// @flow\n\nimport React, { setState, memo } from \"react\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\nimport HistoryIcon from \"@material-ui/icons/History\"\nimport List from \"@material-ui/core/List\"\nimport ListItem from \"@material-ui/core/ListItem\"\nimport ListItemText from \"@material-ui/core/ListItemText\"\nimport IconButton from \"@material-ui/core/IconButton\"\nimport ListItemSecondaryAction from \"@material-ui/core/ListItemSecondaryAction\"\nimport UndoIcon from \"@material-ui/icons/Undo\"\nimport moment from \"moment\"\nimport { grey } from \"@material-ui/core/colors\"\nimport isEqual from \"lodash/isEqual\"\nimport Box from \"@material-ui/core/Box\"\n\nconst useStyles = makeStyles({\n  emptyText: {\n    fontSize: 14,\n    fontWeight: \"bold\",\n    color: grey[500],\n    textAlign: \"center\",\n    padding: 20,\n  },\n})\n\nconst listItemTextStyle = { paddingLeft: 16 }\n\nexport const HistorySidebarBox = ({\n  history,\n  onRestoreHistory,\n}: {\n  history: Array<{ name: string, time: Date }>,\n}) => {\n  const classes = useStyles()\n\n  return (\n    <SidebarBoxContainer\n      title=\"History\"\n      icon={<HistoryIcon style={{ color: grey[700] }} />}\n      expandedByDefault\n    >\n      <List>\n        {history.length === 0 && (\n          <div className={classes.emptyText}>No History Yet</div>\n        )}\n        {history.map(({ name, time }, i) => (\n          <ListItem button dense key={i}>\n            <ListItemText\n              style={listItemTextStyle}\n              primary={name}\n              secondary={moment(time).format(\"LT\")}\n            />\n            {i === 0 && (\n              <ListItemSecondaryAction onClick={() => onRestoreHistory()}>\n                <IconButton>\n                  <UndoIcon />\n                </IconButton>\n              </ListItemSecondaryAction>\n            )}\n          </ListItem>\n        ))}\n      </List>\n    </SidebarBoxContainer>\n  )\n}\n\nexport default memo(HistorySidebarBox, (prevProps, nextProps) =>\n  isEqual(\n    prevProps.history.map((a) => [a.name, a.time]),\n    nextProps.history.map((a) => [a.name, a.time])\n  )\n)\n","import { getApplicationKeyMap } from \"react-hotkeys\"\n\nexport const getHotkeyHelpText = (commandName) => {\n  const firstSequence = getApplicationKeyMap()[commandName]?.sequences?.[0]\n    ?.sequence\n\n  if (!firstSequence) return \"\"\n  return ` (${firstSequence})`\n}\n\nexport default getHotkeyHelpText\n","import React, { useEffect } from \"react\"\nimport { styled } from \"@material-ui/core/styles\"\nimport Box from \"@material-ui/core/Box\"\nimport * as muiColors from \"@material-ui/core/colors\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\nimport colors from \"../colors\"\nimport BallotIcon from \"@material-ui/icons/Ballot\"\nimport capitalize from \"lodash/capitalize\"\nimport classnames from \"classnames\"\n\nconst LabelContainer = styled(\"div\")({\n  display: \"flex\",\n  paddingTop: 4,\n  paddingBottom: 4,\n  paddingLeft: 16,\n  paddingRight: 16,\n  alignItems: \"center\",\n  cursor: \"pointer\",\n  opacity: 0.7,\n  backgroundColor: \"#fff\",\n  \"&:hover\": {\n    opacity: 1,\n  },\n  \"&.selected\": {\n    opacity: 1,\n    fontWeight: \"bold\",\n  },\n})\nconst Circle = styled(\"div\")({\n  width: 12,\n  height: 12,\n  borderRadius: 12,\n  marginRight: 8,\n})\nconst Label = styled(\"div\")({\n  fontSize: 11,\n})\nconst DashSep = styled(\"div\")({\n  flexGrow: 1,\n  borderBottom: `2px dotted ${muiColors.grey[300]}`,\n  marginLeft: 8,\n  marginRight: 8,\n})\nconst Number = styled(\"div\")({\n  fontSize: 11,\n  textAlign: \"center\",\n  minWidth: 14,\n  paddingTop: 2,\n  paddingBottom: 2,\n  fontWeight: \"bold\",\n  color: muiColors.grey[700],\n})\n\nexport const ClassSelectionMenu = ({\n  selectedCls,\n  regionClsList,\n  onSelectCls,\n}) => {\n  useEffect(() => {\n    const keyMapping = {}\n    for (let i = 0; i < 9 && i < regionClsList.length; i++) {\n      keyMapping[i + 1] = () => onSelectCls(regionClsList[i])\n    }\n    const onKeyDown = (e) => {\n      if (keyMapping[e.key]) {\n        keyMapping[e.key]()\n        e.preventDefault()\n        e.stopPropagation()\n      }\n    }\n    window.addEventListener(\"keydown\", onKeyDown)\n    return () => window.removeEventListener(\"keydown\", onKeyDown)\n  }, [regionClsList, selectedCls])\n\n  return (\n    <SidebarBoxContainer\n      title=\"Classifications\"\n      subTitle=\"\"\n      icon={<BallotIcon style={{ color: muiColors.grey[700] }} />}\n      expandedByDefault\n    >\n      {regionClsList.map((label, index) => (\n        <LabelContainer\n          className={classnames({ selected: label === selectedCls })}\n          onClick={() => onSelectCls(label)}\n        >\n          <Circle style={{ backgroundColor: colors[index % colors.length] }} />\n          <Label className={classnames({ selected: label === selectedCls })}>\n            {capitalize(label)}\n          </Label>\n          <DashSep />\n          <Number className={classnames({ selected: label === selectedCls })}>\n            {index < 9 ? `Key [${index + 1}]` : \"\"}\n          </Number>\n        </LabelContainer>\n      ))}\n      <Box pb={2} />\n    </SidebarBoxContainer>\n  )\n}\n\nexport default ClassSelectionMenu\n","// @flow\n\nimport React, { useRef, useCallback } from \"react\"\nimport type { Node } from \"react\"\nimport { makeStyles, styled } from \"@material-ui/core/styles\"\nimport ImageCanvas from \"../ImageCanvas\"\nimport styles from \"./styles\"\nimport type { MainLayoutState, Action } from \"./types\"\nimport useKey from \"use-key-hook\"\nimport classnames from \"classnames\"\nimport { useSettings } from \"../SettingsProvider\"\nimport SettingsDialog from \"../SettingsDialog\"\n// import Fullscreen from \"../Fullscreen\"\nimport { FullScreen, useFullScreenHandle } from \"react-full-screen\"\nimport getActiveImage from \"../Annotator/reducers/get-active-image\"\nimport useImpliedVideoRegions from \"./use-implied-video-regions\"\nimport { useDispatchHotkeyHandlers } from \"../ShortcutsManager\"\nimport { withHotKeys } from \"react-hotkeys\"\nimport iconDictionary from \"./icon-dictionary\"\nimport KeyframeTimeline from \"../KeyframeTimeline\"\nimport Workspace from \"react-material-workspace-layout/Workspace\"\nimport DebugBox from \"../DebugSidebarBox\"\nimport TagsSidebarBox from \"../TagsSidebarBox\"\nimport KeyframesSelector from \"../KeyframesSelectorSidebarBox\"\nimport TaskDescription from \"../TaskDescriptionSidebarBox\"\nimport RegionSelector from \"../RegionSelectorSidebarBox\"\nimport ImageSelector from \"../ImageSelectorSidebarBox\"\nimport HistorySidebarBox from \"../HistorySidebarBox\"\nimport useEventCallback from \"use-event-callback\"\nimport getHotkeyHelpText from \"../utils/get-hotkey-help-text\"\nimport ClassSelectionMenu from \"../ClassSelectionMenu\"\n\nconst emptyArr = []\nconst useStyles = makeStyles(styles)\n\nconst HotkeyDiv = withHotKeys(({ hotKeys, children, divRef, ...props }) => (\n  <div {...{ ...hotKeys, ...props }} ref={divRef}>\n    {children}\n  </div>\n))\n\nconst FullScreenContainer = styled(\"div\")({\n  width: \"100%\",\n  height: \"100%\",\n  \"& .fullscreen\": {\n    width: \"100%\",\n    height: \"100%\",\n  },\n})\n\ntype Props = {\n  state: MainLayoutState,\n  RegionEditLabel?: Node,\n  dispatch: (Action) => any,\n  alwaysShowNextButton?: boolean,\n  alwaysShowPrevButton?: boolean,\n  onRegionClassAdded: () => {},\n  hideHeader?: boolean,\n  hideHeaderText?: boolean,\n}\n\nexport const MainLayout = ({\n  state,\n  dispatch,\n  alwaysShowNextButton = false,\n  alwaysShowPrevButton = false,\n  RegionEditLabel,\n  onRegionClassAdded,\n  hideHeader,\n  hideHeaderText,\n  hideNext = false,\n  hidePrev = false,\n}: Props) => {\n  const classes = useStyles()\n  const settings = useSettings()\n  const fullScreenHandle = useFullScreenHandle()\n\n  const memoizedActionFns = useRef({})\n  const action = (type: string, ...params: Array<string>) => {\n    const fnKey = `${type}(${params.join(\",\")})`\n    if (memoizedActionFns.current[fnKey])\n      return memoizedActionFns.current[fnKey]\n\n    const fn = (...args: any) =>\n      params.length > 0\n        ? dispatch(\n            ({\n              type,\n              ...params.reduce((acc, p, i) => ((acc[p] = args[i]), acc), {}),\n            }: any)\n          )\n        : dispatch({ type, ...args[0] })\n    memoizedActionFns.current[fnKey] = fn\n    return fn\n  }\n\n  const { currentImageIndex, activeImage } = getActiveImage(state)\n  let nextImage\n  if (currentImageIndex !== null) {\n    nextImage = state.images[currentImageIndex + 1]\n  }\n\n  useKey(() => dispatch({ type: \"CANCEL\" }), {\n    detectKeys: [27],\n  })\n\n  const isAVideoFrame = activeImage && activeImage.frameTime !== undefined\n  const innerContainerRef = useRef()\n  const hotkeyHandlers = useDispatchHotkeyHandlers({ dispatch })\n\n  let impliedVideoRegions = useImpliedVideoRegions(state)\n\n  const refocusOnMouseEvent = useCallback((e) => {\n    if (!innerContainerRef.current) return\n    if (innerContainerRef.current.contains(document.activeElement)) return\n    if (innerContainerRef.current.contains(e.target)) {\n      innerContainerRef.current.focus()\n      e.target.focus()\n    }\n  }, [])\n\n  const canvas = (\n    <ImageCanvas\n      {...settings}\n      showCrosshairs={\n        settings.showCrosshairs &&\n        ![\"select\", \"pan\", \"zoom\"].includes(state.selectedTool)\n      }\n      key={state.selectedImage}\n      showMask={state.showMask}\n      fullImageSegmentationMode={state.fullImageSegmentationMode}\n      autoSegmentationOptions={state.autoSegmentationOptions}\n      showTags={state.showTags}\n      allowedArea={state.allowedArea}\n      modifyingAllowedArea={state.selectedTool === \"modify-allowed-area\"}\n      regionClsList={state.regionClsList}\n      regionTagList={state.regionTagList}\n      regions={\n        state.annotationType === \"image\"\n          ? activeImage.regions || []\n          : impliedVideoRegions\n      }\n      realSize={activeImage ? activeImage.realSize : undefined}\n      videoPlaying={state.videoPlaying}\n      imageSrc={state.annotationType === \"image\" ? activeImage.src : null}\n      videoSrc={state.annotationType === \"video\" ? state.videoSrc : null}\n      pointDistancePrecision={state.pointDistancePrecision}\n      createWithPrimary={state.selectedTool.includes(\"create\")}\n      dragWithPrimary={state.selectedTool === \"pan\"}\n      zoomWithPrimary={state.selectedTool === \"zoom\"}\n      showPointDistances={state.showPointDistances}\n      videoTime={\n        state.annotationType === \"image\"\n          ? state.selectedImageFrameTime\n          : state.currentVideoTime\n      }\n      keypointDefinitions={state.keypointDefinitions}\n      onMouseMove={action(\"MOUSE_MOVE\")}\n      onMouseDown={action(\"MOUSE_DOWN\")}\n      onMouseUp={action(\"MOUSE_UP\")}\n      onChangeRegion={action(\"CHANGE_REGION\", \"region\")}\n      onBeginRegionEdit={action(\"OPEN_REGION_EDITOR\", \"region\")}\n      onCloseRegionEdit={action(\"CLOSE_REGION_EDITOR\", \"region\")}\n      onDeleteRegion={action(\"DELETE_REGION\", \"region\")}\n      onBeginBoxTransform={action(\"BEGIN_BOX_TRANSFORM\", \"box\", \"directions\")}\n      onBeginMovePolygonPoint={action(\n        \"BEGIN_MOVE_POLYGON_POINT\",\n        \"polygon\",\n        \"pointIndex\"\n      )}\n      onBeginMoveKeypoint={action(\n        \"BEGIN_MOVE_KEYPOINT\",\n        \"region\",\n        \"keypointId\"\n      )}\n      onAddPolygonPoint={action(\n        \"ADD_POLYGON_POINT\",\n        \"polygon\",\n        \"point\",\n        \"pointIndex\"\n      )}\n      onSelectRegion={action(\"SELECT_REGION\", \"region\")}\n      onBeginMovePoint={action(\"BEGIN_MOVE_POINT\", \"point\")}\n      onImageLoaded={action(\"IMAGE_LOADED\", \"image\")}\n      RegionEditLabel={RegionEditLabel}\n      onImageOrVideoLoaded={action(\"IMAGE_OR_VIDEO_LOADED\", \"metadata\")}\n      onChangeVideoTime={action(\"CHANGE_VIDEO_TIME\", \"newTime\")}\n      onChangeVideoPlaying={action(\"CHANGE_VIDEO_PLAYING\", \"isPlaying\")}\n      onRegionClassAdded={onRegionClassAdded}\n      allowComments={state.allowComments}\n    />\n  )\n\n  const onClickIconSidebarItem = useEventCallback((item) => {\n    dispatch({ type: \"SELECT_TOOL\", selectedTool: item.name })\n  })\n\n  const onClickHeaderItem = useEventCallback((item) => {\n    if (item.name === \"Fullscreen\") {\n      fullScreenHandle.enter()\n    } else if (item.name === \"Window\") {\n      fullScreenHandle.exit()\n    }\n    dispatch({ type: \"HEADER_BUTTON_CLICKED\", buttonName: item.name })\n  })\n\n  const debugModeOn = Boolean(window.localStorage.$ANNOTATE_DEBUG_MODE && state)\n  const nextImageHasRegions =\n    !nextImage || (nextImage.regions && nextImage.regions.length > 0)\n\n  return (\n    <FullScreenContainer>\n      <FullScreen\n        handle={fullScreenHandle}\n        onChange={(open) => {\n          if (!open) {\n            fullScreenHandle.exit()\n            action(\"HEADER_BUTTON_CLICKED\", \"buttonName\")(\"Window\")\n          }\n        }}\n      >\n        <HotkeyDiv\n          tabIndex={-1}\n          divRef={innerContainerRef}\n          onMouseDown={refocusOnMouseEvent}\n          onMouseOver={refocusOnMouseEvent}\n          allowChanges\n          handlers={hotkeyHandlers}\n          className={classnames(\n            classes.container,\n            state.fullScreen && \"Fullscreen\"\n          )}\n        >\n          <Workspace\n            allowFullscreen\n            iconDictionary={iconDictionary}\n            hideHeader={hideHeader}\n            hideHeaderText={hideHeaderText}\n            headerLeftSide={[\n              state.annotationType === \"video\" ? (\n                <KeyframeTimeline\n                  currentTime={state.currentVideoTime}\n                  duration={state.videoDuration}\n                  onChangeCurrentTime={action(\"CHANGE_VIDEO_TIME\", \"newTime\")}\n                  keyframes={state.keyframes}\n                />\n              ) : activeImage ? (\n                <div className={classes.headerTitle}>{activeImage.name}</div>\n              ) : null,\n            ].filter(Boolean)}\n            headerItems={[\n              !hidePrev && { name: \"Prev\" },\n              !hideNext && { name: \"Next\" },\n              state.annotationType !== \"video\"\n                ? null\n                : !state.videoPlaying\n                ? { name: \"Play\" }\n                : { name: \"Pause\" },\n              !nextImageHasRegions && activeImage.regions && { name: \"Clone\" },\n              { name: \"Settings\" },\n              state.fullScreen ? { name: \"Window\" } : { name: \"Fullscreen\" },\n              { name: \"Save\" },\n            ].filter(Boolean)}\n            onClickHeaderItem={onClickHeaderItem}\n            onClickIconSidebarItem={onClickIconSidebarItem}\n            selectedTools={[\n              state.selectedTool,\n              state.showTags && \"show-tags\",\n              state.showMask && \"show-mask\",\n            ].filter(Boolean)}\n            iconSidebarItems={[\n              {\n                name: \"select\",\n                helperText: \"Select\" + getHotkeyHelpText(\"select_tool\"),\n                alwaysShowing: true,\n              },\n              {\n                name: \"pan\",\n                helperText:\n                  \"Drag/Pan (right or middle click)\" +\n                  getHotkeyHelpText(\"pan_tool\"),\n                alwaysShowing: true,\n              },\n              {\n                name: \"zoom\",\n                helperText:\n                  \"Zoom In/Out (scroll)\" + getHotkeyHelpText(\"zoom_tool\"),\n                alwaysShowing: true,\n              },\n              {\n                name: \"show-tags\",\n                helperText: \"Show / Hide Tags\",\n                alwaysShowing: true,\n              },\n              {\n                name: \"create-point\",\n                helperText: \"Add Point\" + getHotkeyHelpText(\"create_point\"),\n              },\n              {\n                name: \"create-box\",\n                helperText:\n                  \"Add Bounding Box\" + getHotkeyHelpText(\"create_bounding_box\"),\n              },\n              {\n                name: \"create-polygon\",\n                helperText: \"Add Polygon\" + getHotkeyHelpText(\"create_polygon\"),\n              },\n              {\n                name: \"create-line\",\n                helperText: \"Add Line\",\n              },\n              {\n                name: \"create-expanding-line\",\n                helperText: \"Add Expanding Line\",\n              },\n              {\n                name: \"create-keypoints\",\n                helperText: \"Add Keypoints (Pose)\",\n              },\n              state.fullImageSegmentationMode && {\n                name: \"show-mask\",\n                alwaysShowing: true,\n                helperText: \"Show / Hide Mask\",\n              },\n              {\n                name: \"modify-allowed-area\",\n                helperText: \"Modify Allowed Area\",\n              },\n            ]\n              .filter(Boolean)\n              .filter(\n                (a) => a.alwaysShowing || state.enabledTools.includes(a.name)\n              )}\n            rightSidebarItems={[\n              debugModeOn && (\n                <DebugBox state={debugModeOn} lastAction={state.lastAction} />\n              ),\n              state.taskDescription && (\n                <TaskDescription description={state.taskDescription} />\n              ),\n              state.regionClsList && (\n                <ClassSelectionMenu\n                  selectedCls={state.selectedCls}\n                  regionClsList={state.regionClsList}\n                  onSelectCls={action(\"SELECT_CLASSIFICATION\", \"cls\")}\n                />\n              ),\n              state.labelImages && (\n                <TagsSidebarBox\n                  currentImage={activeImage}\n                  imageClsList={state.imageClsList}\n                  imageTagList={state.imageTagList}\n                  onChangeImage={action(\"CHANGE_IMAGE\", \"delta\")}\n                  expandedByDefault\n                />\n              ),\n              // (state.images?.length || 0) > 1 && (\n              //   <ImageSelector\n              //     onSelect={action(\"SELECT_REGION\", \"region\")}\n              //     images={state.images}\n              //   />\n              // ),\n              <RegionSelector\n                regions={activeImage ? activeImage.regions : emptyArr}\n                onSelectRegion={action(\"SELECT_REGION\", \"region\")}\n                onDeleteRegion={action(\"DELETE_REGION\", \"region\")}\n                onChangeRegion={action(\"CHANGE_REGION\", \"region\")}\n              />,\n              state.keyframes && (\n                <KeyframesSelector\n                  onChangeVideoTime={action(\"CHANGE_VIDEO_TIME\", \"newTime\")}\n                  onDeleteKeyframe={action(\"DELETE_KEYFRAME\", \"time\")}\n                  onChangeCurrentTime={action(\"CHANGE_VIDEO_TIME\", \"newTime\")}\n                  currentTime={state.currentVideoTime}\n                  duration={state.videoDuration}\n                  keyframes={state.keyframes}\n                />\n              ),\n              <HistorySidebarBox\n                history={state.history}\n                onRestoreHistory={action(\"RESTORE_HISTORY\")}\n              />,\n            ].filter(Boolean)}\n          >\n            {canvas}\n          </Workspace>\n          <SettingsDialog\n            open={state.settingsOpen}\n            onClose={() =>\n              dispatch({\n                type: \"HEADER_BUTTON_CLICKED\",\n                buttonName: \"Settings\",\n              })\n            }\n          />\n        </HotkeyDiv>\n      </FullScreen>\n    </FullScreenContainer>\n  )\n}\n\nexport default MainLayout\n","// @flow\n\nimport type { MainLayoutState, Action } from \"../../MainLayout/types\"\nimport { setIn, updateIn, asMutable, without } from \"seamless-immutable\"\nimport moment from \"moment\"\n\nconst typesToSaveWithHistory = {\n  BEGIN_BOX_TRANSFORM: \"Transform/Move Box\",\n  BEGIN_MOVE_POINT: \"Move Point\",\n  DELETE_REGION: \"Delete Region\",\n}\n\nexport const saveToHistory = (state: MainLayoutState, name: string) =>\n  updateIn(state, [\"history\"], (h) =>\n    [\n      {\n        time: moment().toDate(),\n        state: without(state, \"history\"),\n        name,\n      },\n    ].concat((h || []).slice(0, 9))\n  )\n\nexport default (reducer) => {\n  return (state: MainLayoutState, action: Action) => {\n    const prevState = state\n    const nextState = reducer(state, action)\n\n    if (action.type === \"RESTORE_HISTORY\") {\n      if (state.history.length > 0) {\n        return setIn(\n          nextState.history[0].state,\n          [\"history\"],\n          nextState.history.slice(1)\n        )\n      }\n    } else {\n      if (\n        prevState !== nextState &&\n        Object.keys(typesToSaveWithHistory).includes(action.type)\n      ) {\n        return setIn(\n          nextState,\n          [\"history\"],\n          [\n            {\n              time: moment().toDate(),\n              state: without(prevState, \"history\"),\n              name: typesToSaveWithHistory[action.type] || action.type,\n            },\n          ]\n            .concat(nextState.history || [])\n            .slice(0, 9)\n        )\n      }\n    }\n\n    return nextState\n  }\n}\n","// @flow\n\nfunction clamp(num, min, max) {\n  return num <= min ? min : num >= max ? max : num\n}\n\nexport default (expandingLine) => {\n  const expandingWidth = expandingLine.expandingWidth || 0.005\n  const pointPairs = expandingLine.points.map(({ x, y, angle, width }, i) => {\n    if (!angle) {\n      const n =\n        expandingLine.points[clamp(i + 1, 0, expandingLine.points.length - 1)]\n      const p =\n        expandingLine.points[clamp(i - 1, 0, expandingLine.points.length - 1)]\n      angle = Math.atan2(p.x - n.x, p.y - n.y) + Math.PI / 2\n    }\n    const dx = (Math.sin(angle) * (width || expandingWidth)) / 2\n    const dy = (Math.cos(angle) * (width || expandingWidth)) / 2\n    return [\n      { x: x + dx, y: y + dy },\n      { x: x - dx, y: y - dy },\n    ]\n  })\n  const firstSection = pointPairs.map(([p1, p2]) => p1)\n  const secondSection = pointPairs.map(([p1, p2]) => p2).asMutable()\n  secondSection.reverse()\n\n  const newPoints = firstSection.concat(secondSection).map(({ x, y }) => [x, y])\n\n  return {\n    ...expandingLine,\n    type: \"polygon\",\n    open: false,\n    points: newPoints,\n    unfinished: undefined,\n    candidatePoint: undefined,\n  }\n\n  // let { expandingWidth = 0.005, points } = region\n  // expandingWidth = points.slice(-1)[0].width || expandingWidth\n  // const lastPoint = points.slice(-1)[0]\n  // return (\n  //   <>\n  //     <polygon\n  //       points={\n  //         .map((p) => `${p.x * iw} ${p.y * ih}`)\n  //         .join(\" \")}\n  // return {\n  //   ...expandingLine,\n  //   unfinished: undefined,\n  //   candidatePoint: undefined,\n  // }\n}\n","// @flow\nimport type { KeypointDefinition } from \"../ImageCanvas/region-tools\"\n\ntype Parameters = {\n  center: { x: number, y: number },\n  scale: number,\n  landmarks: {\n    [string]: KeypointDefinition,\n  },\n}\n\nexport default ({ center, scale, landmarks }: Parameters) => {\n  const points = {}\n  for (const [keypointId, { defaultPosition }] of (Object.entries(\n    landmarks\n  ): any)) {\n    points[keypointId] = {\n      x: defaultPosition[0] * scale + center.x,\n      y: defaultPosition[1] * scale + center.y,\n    }\n  }\n  return points\n}\n","// @flow\nimport type { MainLayoutState, Action } from \"../../MainLayout/types\"\nimport { moveRegion } from \"../../ImageCanvas/region-tools.js\"\nimport { getIn, setIn, updateIn } from \"seamless-immutable\"\nimport moment from \"moment\"\nimport isEqual from \"lodash/isEqual\"\nimport getActiveImage from \"./get-active-image\"\nimport { saveToHistory } from \"./history-handler.js\"\nimport colors from \"../../colors\"\nimport fixTwisted from \"./fix-twisted\"\nimport convertExpandingLineToPolygon from \"./convert-expanding-line-to-polygon\"\nimport clamp from \"clamp\"\nimport getLandmarksWithTransform from \"../../utils/get-landmarks-with-transform\"\nimport setInLocalStorage from \"../../utils/set-in-local-storage\"\n\nconst getRandomId = () => Math.random().toString().split(\".\")[1]\n\nexport default (state: MainLayoutState, action: Action) => {\n  if (\n    state.allowedArea &&\n    state.selectedTool !== \"modify-allowed-area\" &&\n    [\"MOUSE_DOWN\", \"MOUSE_UP\", \"MOUSE_MOVE\"].includes(action.type)\n  ) {\n    const aa = state.allowedArea\n    action.x = clamp(action.x, aa.x, aa.x + aa.w)\n    action.y = clamp(action.y, aa.y, aa.y + aa.h)\n  }\n\n  if (action.type === \"ON_CLS_ADDED\" && action.cls && action.cls !== \"\") {\n    const oldRegionClsList = state.regionClsList\n    const newState = {\n      ...state,\n      regionClsList: oldRegionClsList.concat(action.cls),\n    }\n    return newState\n  }\n\n  // Throttle certain actions\n  if (action.type === \"MOUSE_MOVE\") {\n    if (Date.now() - ((state: any).lastMouseMoveCall || 0) < 16) return state\n    state = setIn(state, [\"lastMouseMoveCall\"], Date.now())\n  }\n  if (!action.type.includes(\"MOUSE\")) {\n    state = setIn(state, [\"lastAction\"], action)\n  }\n\n  const { currentImageIndex, pathToActiveImage, activeImage } = getActiveImage(\n    state\n  )\n\n  const getRegionIndex = (region) => {\n    const regionId =\n      typeof region === \"string\" || typeof region === \"number\"\n        ? region\n        : region.id\n    if (!activeImage) return null\n    const regionIndex = (activeImage.regions || []).findIndex(\n      (r) => r.id === regionId\n    )\n    return regionIndex === -1 ? null : regionIndex\n  }\n  const getRegion = (regionId) => {\n    if (!activeImage) return null\n    const regionIndex = getRegionIndex(regionId)\n    if (regionIndex === null) return [null, null]\n    const region = activeImage.regions[regionIndex]\n    return [region, regionIndex]\n  }\n  const modifyRegion = (regionId, obj) => {\n    const [region, regionIndex] = getRegion(regionId)\n    if (!region) return state\n    if (obj !== null) {\n      return setIn(state, [...pathToActiveImage, \"regions\", regionIndex], {\n        ...region,\n        ...obj,\n      })\n    } else {\n      // delete region\n      const regions = activeImage.regions\n      return setIn(\n        state,\n        [...pathToActiveImage, \"regions\"],\n        (regions || []).filter((r) => r.id !== region.id)\n      )\n    }\n  }\n  const unselectRegions = (state: MainLayoutState) => {\n    if (!activeImage) return state\n    return setIn(\n      state,\n      [...pathToActiveImage, \"regions\"],\n      (activeImage.regions || []).map((r) => ({\n        ...r,\n        highlighted: false,\n      }))\n    )\n  }\n\n  const closeEditors = (state: MainLayoutState) => {\n    if (currentImageIndex === null) return state\n    return setIn(\n      state,\n      [...pathToActiveImage, \"regions\"],\n      (activeImage.regions || []).map((r) => ({\n        ...r,\n        editingLabels: false,\n      }))\n    )\n  }\n\n  const setNewImage = (img: string | Object, index: number) => {\n    let { src, frameTime } = typeof img === \"object\" ? img : { src: img }\n    return setIn(\n      setIn(state, [\"selectedImage\"], index),\n      [\"selectedImageFrameTime\"],\n      frameTime\n    )\n  }\n\n  switch (action.type) {\n    case \"@@INIT\": {\n      return state\n    }\n    case \"SELECT_IMAGE\": {\n      return setNewImage(action.image, action.imageIndex)\n    }\n    case \"SELECT_CLASSIFICATION\": {\n      return setIn(state, [\"selectedCls\"], action.cls)\n    }\n    case \"CHANGE_REGION\": {\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      const oldRegion = activeImage.regions[regionIndex]\n      if (oldRegion.cls !== action.region.cls) {\n        state = saveToHistory(state, \"Change Region Classification\")\n        const clsIndex = state.regionClsList.indexOf(action.region.cls)\n        if (clsIndex !== -1) {\n          state = setIn(state, [\"selectedCls\"], action.region.cls)\n          action.region.color = colors[clsIndex % colors.length]\n        }\n      }\n      if (!isEqual(oldRegion.tags, action.region.tags)) {\n        state = saveToHistory(state, \"Change Region Tags\")\n      }\n      if (!isEqual(oldRegion.comment, action.region.comment)) {\n        state = saveToHistory(state, \"Change Region Comment\")\n      }\n      return setIn(\n        state,\n        [...pathToActiveImage, \"regions\", regionIndex],\n        action.region\n      )\n    }\n    case \"CHANGE_IMAGE\": {\n      if (!activeImage) return state\n      const { delta } = action\n      for (const key of Object.keys(delta)) {\n        if (key === \"cls\") saveToHistory(state, \"Change Image Class\")\n        if (key === \"tags\") saveToHistory(state, \"Change Image Tags\")\n        state = setIn(state, [...pathToActiveImage, key], delta[key])\n      }\n      return state\n    }\n    case \"SELECT_REGION\": {\n      const { region } = action\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      const regions = [...(activeImage.regions || [])].map((r) => ({\n        ...r,\n        highlighted: r.id === region.id,\n        editingLabels: r.id === region.id,\n      }))\n      return setIn(state, [...pathToActiveImage, \"regions\"], regions)\n    }\n    case \"BEGIN_MOVE_POINT\": {\n      state = closeEditors(state)\n      return setIn(state, [\"mode\"], {\n        mode: \"MOVE_REGION\",\n        regionId: action.point.id,\n      })\n    }\n    case \"BEGIN_BOX_TRANSFORM\": {\n      const { box, directions } = action\n      state = closeEditors(state)\n      if (directions[0] === 0 && directions[1] === 0) {\n        return setIn(state, [\"mode\"], { mode: \"MOVE_REGION\", regionId: box.id })\n      } else {\n        return setIn(state, [\"mode\"], {\n          mode: \"RESIZE_BOX\",\n          regionId: box.id,\n          freedom: directions,\n          original: { x: box.x, y: box.y, w: box.w, h: box.h },\n        })\n      }\n    }\n    case \"BEGIN_MOVE_POLYGON_POINT\": {\n      const { polygon, pointIndex } = action\n      state = closeEditors(state)\n      if (\n        state.mode &&\n        state.mode.mode === \"DRAW_POLYGON\" &&\n        pointIndex === 0\n      ) {\n        return setIn(\n          modifyRegion(polygon, {\n            points: polygon.points.slice(0, -1),\n            open: false,\n          }),\n          [\"mode\"],\n          null\n        )\n      } else {\n        state = saveToHistory(state, \"Move Polygon Point\")\n      }\n      return setIn(state, [\"mode\"], {\n        mode: \"MOVE_POLYGON_POINT\",\n        regionId: polygon.id,\n        pointIndex,\n      })\n    }\n    case \"BEGIN_MOVE_KEYPOINT\": {\n      const { region, keypointId } = action\n      state = closeEditors(state)\n      state = saveToHistory(state, \"Move Keypoint\")\n      return setIn(state, [\"mode\"], {\n        mode: \"MOVE_KEYPOINT\",\n        regionId: region.id,\n        keypointId,\n      })\n    }\n    case \"ADD_POLYGON_POINT\": {\n      const { polygon, point, pointIndex } = action\n      const regionIndex = getRegionIndex(polygon)\n      if (regionIndex === null) return state\n      const points = [...polygon.points]\n      points.splice(pointIndex, 0, point)\n      return setIn(state, [...pathToActiveImage, \"regions\", regionIndex], {\n        ...polygon,\n        points,\n      })\n    }\n    case \"MOUSE_MOVE\": {\n      const { x, y } = action\n\n      if (!state.mode) return state\n      if (!activeImage) return state\n      const { mouseDownAt } = state\n      switch (state.mode.mode) {\n        case \"MOVE_POLYGON_POINT\": {\n          const { pointIndex, regionId } = state.mode\n          const regionIndex = getRegionIndex(regionId)\n          if (regionIndex === null) return state\n          return setIn(\n            state,\n            [\n              ...pathToActiveImage,\n              \"regions\",\n              regionIndex,\n              \"points\",\n              pointIndex,\n            ],\n            [x, y]\n          )\n        }\n        case \"MOVE_KEYPOINT\": {\n          const { keypointId, regionId } = state.mode\n          const [region, regionIndex] = getRegion(regionId)\n          if (regionIndex === null) return state\n          return setIn(\n            state,\n            [\n              ...pathToActiveImage,\n              \"regions\",\n              regionIndex,\n              \"points\",\n              keypointId,\n            ],\n            { ...(region: any).points[keypointId], x, y }\n          )\n        }\n        case \"MOVE_REGION\": {\n          const { regionId } = state.mode\n          if (regionId === \"$$allowed_area\") {\n            const {\n              allowedArea: { w, h },\n            } = state\n            return setIn(state, [\"allowedArea\"], {\n              x: x - w / 2,\n              y: y - h / 2,\n              w,\n              h,\n            })\n          }\n          const regionIndex = getRegionIndex(regionId)\n          if (regionIndex === null) return state\n          return setIn(\n            state,\n            [...pathToActiveImage, \"regions\", regionIndex],\n            moveRegion(activeImage.regions[regionIndex], x, y)\n          )\n        }\n        case \"RESIZE_BOX\": {\n          const {\n            regionId,\n            freedom: [xFree, yFree],\n            original: { x: ox, y: oy, w: ow, h: oh },\n          } = state.mode\n\n          const dx = xFree === 0 ? ox : xFree === -1 ? Math.min(ox + ow, x) : ox\n          const dw =\n            xFree === 0\n              ? ow\n              : xFree === -1\n              ? ow + (ox - dx)\n              : Math.max(0, ow + (x - ox - ow))\n          const dy = yFree === 0 ? oy : yFree === -1 ? Math.min(oy + oh, y) : oy\n          const dh =\n            yFree === 0\n              ? oh\n              : yFree === -1\n              ? oh + (oy - dy)\n              : Math.max(0, oh + (y - oy - oh))\n\n          // determine if we should switch the freedom\n          if (dw <= 0.001) {\n            state = setIn(state, [\"mode\", \"freedom\"], [xFree * -1, yFree])\n          }\n          if (dh <= 0.001) {\n            state = setIn(state, [\"mode\", \"freedom\"], [xFree, yFree * -1])\n          }\n\n          if (regionId === \"$$allowed_area\") {\n            return setIn(state, [\"allowedArea\"], {\n              x: dx,\n              w: dw,\n              y: dy,\n              h: dh,\n            })\n          }\n\n          const regionIndex = getRegionIndex(regionId)\n          if (regionIndex === null) return state\n          const box = activeImage.regions[regionIndex]\n\n          return setIn(state, [...pathToActiveImage, \"regions\", regionIndex], {\n            ...box,\n            x: dx,\n            w: dw,\n            y: dy,\n            h: dh,\n          })\n        }\n        case \"RESIZE_KEYPOINTS\": {\n          const { regionId, landmarks, centerX, centerY } = state.mode\n          const distFromCenter = Math.sqrt(\n            (centerX - x) ** 2 + (centerY - y) ** 2\n          )\n          const scale = distFromCenter / 0.15\n          return modifyRegion(regionId, {\n            points: getLandmarksWithTransform({\n              landmarks,\n              center: { x: centerX, y: centerY },\n              scale,\n            }),\n          })\n        }\n        case \"DRAW_POLYGON\": {\n          const { regionId } = state.mode\n          const [region, regionIndex] = getRegion(regionId)\n          if (!region) return setIn(state, [\"mode\"], null)\n          return setIn(\n            state,\n            [\n              ...pathToActiveImage,\n              \"regions\",\n              regionIndex,\n              \"points\",\n              (region: any).points.length - 1,\n            ],\n            [x, y]\n          )\n        }\n        case \"DRAW_LINE\": {\n          const { regionId } = state.mode\n          const [region, regionIndex] = getRegion(regionId)\n          if (!region) return setIn(state, [\"mode\"], null)\n          return setIn(state, [...pathToActiveImage, \"regions\", regionIndex], {\n            ...region,\n            x2: x,\n            y2: y,\n          })\n        }\n        case \"DRAW_EXPANDING_LINE\": {\n          const { regionId } = state.mode\n          const [expandingLine, regionIndex] = getRegion(regionId)\n          if (!expandingLine) return state\n          const isMouseDown = Boolean(state.mouseDownAt)\n          if (isMouseDown) {\n            // If the mouse is down, set width/angle\n            const lastPoint = expandingLine.points.slice(-1)[0]\n            const mouseDistFromLastPoint = Math.sqrt(\n              (lastPoint.x - x) ** 2 + (lastPoint.y - y) ** 2\n            )\n            if (mouseDistFromLastPoint < 0.002 && !lastPoint.width) return state\n\n            const newState = setIn(\n              state,\n              [...pathToActiveImage, \"regions\", regionIndex, \"points\"],\n              expandingLine.points.slice(0, -1).concat([\n                {\n                  ...lastPoint,\n                  width: mouseDistFromLastPoint * 2,\n                  angle: Math.atan2(lastPoint.x - x, lastPoint.y - y),\n                },\n              ])\n            )\n            return newState\n          } else {\n            // If mouse is up, move the next candidate point\n            return setIn(\n              state,\n              [...pathToActiveImage, \"regions\", regionIndex],\n              {\n                ...expandingLine,\n                candidatePoint: { x, y },\n              }\n            )\n          }\n\n          return state\n        }\n        case \"SET_EXPANDING_LINE_WIDTH\": {\n          const { regionId } = state.mode\n          const [expandingLine, regionIndex] = getRegion(regionId)\n          if (!expandingLine) return state\n          const lastPoint = expandingLine.points.slice(-1)[0]\n          const { mouseDownAt } = state\n          return setIn(\n            state,\n            [...pathToActiveImage, \"regions\", regionIndex, \"expandingWidth\"],\n            Math.sqrt((lastPoint.x - x) ** 2 + (lastPoint.y - y) ** 2)\n          )\n        }\n        default:\n          return state\n      }\n    }\n    case \"MOUSE_DOWN\": {\n      if (!activeImage) return state\n      const { x, y } = action\n\n      state = setIn(state, [\"mouseDownAt\"], { x, y })\n\n      if (state.mode) {\n        switch (state.mode.mode) {\n          case \"DRAW_POLYGON\": {\n            const [polygon, regionIndex] = getRegion(state.mode.regionId)\n            if (!polygon) break\n            return setIn(\n              state,\n              [...pathToActiveImage, \"regions\", regionIndex],\n              { ...polygon, points: polygon.points.concat([[x, y]]) }\n            )\n          }\n          case \"DRAW_LINE\": {\n            const [line, regionIndex] = getRegion(state.mode.regionId)\n            if (!line) break\n            setIn(state, [...pathToActiveImage, \"regions\", regionIndex], {\n              ...line,\n              x2: x,\n              y2: y,\n            })\n            return setIn(state, [\"mode\"], null)\n          }\n          case \"DRAW_EXPANDING_LINE\": {\n            const [expandingLine, regionIndex] = getRegion(state.mode.regionId)\n            if (!expandingLine) break\n            const lastPoint = expandingLine.points.slice(-1)[0]\n            if (\n              expandingLine.points.length > 1 &&\n              Math.sqrt((lastPoint.x - x) ** 2 + (lastPoint.y - y) ** 2) < 0.002\n            ) {\n              if (!lastPoint.width) {\n                return setIn(state, [\"mode\"], {\n                  mode: \"SET_EXPANDING_LINE_WIDTH\",\n                  regionId: state.mode.regionId,\n                })\n              } else {\n                return state\n                  .setIn(\n                    [...pathToActiveImage, \"regions\", regionIndex],\n                    convertExpandingLineToPolygon(expandingLine)\n                  )\n                  .setIn([\"mode\"], null)\n              }\n            }\n\n            // Create new point\n            return setIn(\n              state,\n              [...pathToActiveImage, \"regions\", regionIndex, \"points\"],\n              expandingLine.points.concat([{ x, y, angle: null, width: null }])\n            )\n          }\n          case \"SET_EXPANDING_LINE_WIDTH\": {\n            const [expandingLine, regionIndex] = getRegion(state.mode.regionId)\n            if (!expandingLine) break\n            const { expandingWidth } = expandingLine\n            return state\n              .setIn(\n                [...pathToActiveImage, \"regions\", regionIndex],\n                convertExpandingLineToPolygon({\n                  ...expandingLine,\n                  points: expandingLine.points.map((p) =>\n                    p.width ? p : { ...p, width: expandingWidth }\n                  ),\n                  expandingWidth: undefined,\n                })\n              )\n              .setIn([\"mode\"], null)\n          }\n          default:\n            break\n        }\n      }\n\n      let newRegion\n      let defaultRegionCls = state.selectedCls,\n        defaultRegionColor = \"#ff0000\"\n\n      const clsIndex = (state.regionClsList || []).indexOf(defaultRegionCls)\n      if (clsIndex !== -1) {\n        defaultRegionColor = colors[clsIndex % colors.length]\n      }\n\n      switch (state.selectedTool) {\n        case \"create-point\": {\n          state = saveToHistory(state, \"Create Point\")\n          newRegion = {\n            type: \"point\",\n            x,\n            y,\n            highlighted: true,\n            editingLabels: true,\n            color: defaultRegionColor,\n            id: getRandomId(),\n            cls: defaultRegionCls,\n          }\n          break\n        }\n        case \"create-box\": {\n          state = saveToHistory(state, \"Create Box\")\n          newRegion = {\n            type: \"box\",\n            x: x,\n            y: y,\n            w: 0,\n            h: 0,\n            highlighted: true,\n            editingLabels: false,\n            color: defaultRegionColor,\n            cls: defaultRegionCls,\n            id: getRandomId(),\n          }\n          state = setIn(state, [\"mode\"], {\n            mode: \"RESIZE_BOX\",\n            editLabelEditorAfter: true,\n            regionId: newRegion.id,\n            freedom: [1, 1],\n            original: { x, y, w: newRegion.w, h: newRegion.h },\n            isNew: true,\n          })\n          break\n        }\n        case \"create-polygon\": {\n          if (state.mode && state.mode.mode === \"DRAW_POLYGON\") break\n          state = saveToHistory(state, \"Create Polygon\")\n          newRegion = {\n            type: \"polygon\",\n            points: [\n              [x, y],\n              [x, y],\n            ],\n            open: true,\n            highlighted: true,\n            color: defaultRegionColor,\n            cls: defaultRegionCls,\n            id: getRandomId(),\n          }\n          state = setIn(state, [\"mode\"], {\n            mode: \"DRAW_POLYGON\",\n            regionId: newRegion.id,\n          })\n          break\n        }\n        case \"create-expanding-line\": {\n          state = saveToHistory(state, \"Create Expanding Line\")\n          newRegion = {\n            type: \"expanding-line\",\n            unfinished: true,\n            points: [{ x, y, angle: null, width: null }],\n            open: true,\n            highlighted: true,\n            color: defaultRegionColor,\n            cls: defaultRegionCls,\n            id: getRandomId(),\n          }\n          state = setIn(state, [\"mode\"], {\n            mode: \"DRAW_EXPANDING_LINE\",\n            regionId: newRegion.id,\n          })\n          break\n        }\n        case \"create-line\": {\n          if (state.mode && state.mode.mode === \"DRAW_LINE\") break\n          state = saveToHistory(state, \"Create Line\")\n          newRegion = {\n            type: \"line\",\n            x1: x,\n            y1: y,\n            x2: x,\n            y2: y,\n            highlighted: true,\n            editingLabels: false,\n            color: defaultRegionColor,\n            cls: defaultRegionCls,\n            id: getRandomId(),\n          }\n          state = setIn(state, [\"mode\"], {\n            mode: \"DRAW_LINE\",\n            regionId: newRegion.id,\n          })\n          break\n        }\n        case \"create-keypoints\": {\n          state = saveToHistory(state, \"Create Keypoints\")\n          const [\n            [keypointsDefinitionId, { landmarks, connections }],\n          ] = (Object.entries(state.keypointDefinitions): any)\n\n          newRegion = {\n            type: \"keypoints\",\n            keypointsDefinitionId,\n            points: getLandmarksWithTransform({\n              landmarks,\n              center: { x, y },\n              scale: 1,\n            }),\n            highlighted: true,\n            editingLabels: false,\n            id: getRandomId(),\n          }\n          state = setIn(state, [\"mode\"], {\n            mode: \"RESIZE_KEYPOINTS\",\n            landmarks,\n            centerX: x,\n            centerY: y,\n            regionId: newRegion.id,\n            isNew: true,\n          })\n          break\n        }\n        default:\n          break\n      }\n\n      const regions = [...(getIn(state, pathToActiveImage).regions || [])]\n        .map((r) =>\n          setIn(r, [\"editingLabels\"], false).setIn([\"highlighted\"], false)\n        )\n        .concat(newRegion ? [newRegion] : [])\n\n      return setIn(state, [...pathToActiveImage, \"regions\"], regions)\n    }\n    case \"MOUSE_UP\": {\n      const { x, y } = action\n\n      const { mouseDownAt = { x, y } } = state\n      if (!state.mode) return state\n      state = setIn(state, [\"mouseDownAt\"], null)\n      switch (state.mode.mode) {\n        case \"RESIZE_BOX\": {\n          if (state.mode.isNew) {\n            if (\n              Math.abs(state.mode.original.x - x) < 0.002 ||\n              Math.abs(state.mode.original.y - y) < 0.002\n            ) {\n              return setIn(\n                modifyRegion(state.mode.regionId, null),\n                [\"mode\"],\n                null\n              )\n            }\n          }\n          if (state.mode.editLabelEditorAfter) {\n            return {\n              ...modifyRegion(state.mode.regionId, { editingLabels: true }),\n              mode: null,\n            }\n          }\n        }\n        case \"MOVE_REGION\":\n        case \"RESIZE_KEYPOINTS\":\n        case \"MOVE_POLYGON_POINT\": {\n          return { ...state, mode: null }\n        }\n        case \"MOVE_KEYPOINT\": {\n          return { ...state, mode: null }\n        }\n        case \"CREATE_POINT_LINE\": {\n          return state\n        }\n        case \"DRAW_EXPANDING_LINE\": {\n          const [expandingLine, regionIndex] = getRegion(state.mode.regionId)\n          if (!expandingLine) return state\n          let newExpandingLine = expandingLine\n          const lastPoint =\n            expandingLine.points.length !== 0\n              ? expandingLine.points.slice(-1)[0]\n              : mouseDownAt\n          let jointStart\n          if (expandingLine.points.length > 1) {\n            jointStart = expandingLine.points.slice(-2)[0]\n          } else {\n            jointStart = lastPoint\n          }\n          const mouseDistFromLastPoint = Math.sqrt(\n            (lastPoint.x - x) ** 2 + (lastPoint.y - y) ** 2\n          )\n          if (mouseDistFromLastPoint > 0.002) {\n            // The user is drawing has drawn the width for the last point\n            const newPoints = [...expandingLine.points]\n            for (let i = 0; i < newPoints.length - 1; i++) {\n              if (newPoints[i].width) continue\n              newPoints[i] = {\n                ...newPoints[i],\n                width: lastPoint.width,\n              }\n            }\n            newExpandingLine = setIn(\n              expandingLine,\n              [\"points\"],\n              fixTwisted(newPoints)\n            )\n          } else {\n            return state\n          }\n          return setIn(\n            state,\n            [...pathToActiveImage, \"regions\", regionIndex],\n            newExpandingLine\n          )\n        }\n        default:\n          return state\n      }\n    }\n    case \"OPEN_REGION_EDITOR\": {\n      const { region } = action\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      const newRegions = setIn(\n        activeImage.regions.map((r) => ({\n          ...r,\n          highlighted: false,\n          editingLabels: false,\n        })),\n        [regionIndex],\n        {\n          ...(activeImage.regions || [])[regionIndex],\n          highlighted: true,\n          editingLabels: true,\n        }\n      )\n      return setIn(state, [...pathToActiveImage, \"regions\"], newRegions)\n    }\n    case \"CLOSE_REGION_EDITOR\": {\n      const { region } = action\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      return setIn(state, [...pathToActiveImage, \"regions\", regionIndex], {\n        ...(activeImage.regions || [])[regionIndex],\n        editingLabels: false,\n      })\n    }\n    case \"DELETE_REGION\": {\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      return setIn(\n        state,\n        [...pathToActiveImage, \"regions\"],\n        (activeImage.regions || []).filter((r) => r.id !== action.region.id)\n      )\n    }\n    case \"DELETE_SELECTED_REGION\": {\n      return setIn(\n        state,\n        [...pathToActiveImage, \"regions\"],\n        (activeImage.regions || []).filter((r) => !r.highlighted)\n      )\n    }\n    case \"HEADER_BUTTON_CLICKED\": {\n      const buttonName = action.buttonName.toLowerCase()\n      switch (buttonName) {\n        case \"prev\": {\n          if (currentImageIndex === null) return state\n          if (currentImageIndex === 0) return state\n          return setNewImage(\n            state.images[currentImageIndex - 1],\n            currentImageIndex - 1\n          )\n        }\n        case \"next\": {\n          if (currentImageIndex === null) return state\n          if (currentImageIndex === state.images.length - 1) return state\n          return setNewImage(\n            state.images[currentImageIndex + 1],\n            currentImageIndex + 1\n          )\n        }\n        case \"clone\": {\n          if (currentImageIndex === null) return state\n          if (currentImageIndex === state.images.length - 1) return state\n          return setIn(\n            setNewImage(\n              state.images[currentImageIndex + 1],\n              currentImageIndex + 1\n            ),\n            [\"images\", currentImageIndex + 1, \"regions\"],\n            activeImage.regions\n          )\n        }\n        case \"settings\": {\n          return setIn(state, [\"settingsOpen\"], !state.settingsOpen)\n        }\n        case \"help\": {\n          return state\n        }\n        case \"fullscreen\": {\n          return setIn(state, [\"fullScreen\"], true)\n        }\n        case \"exit fullscreen\":\n        case \"window\": {\n          return setIn(state, [\"fullScreen\"], false)\n        }\n        case \"hotkeys\": {\n          return state\n        }\n        case \"exit\":\n        case \"done\": {\n          return state\n        }\n        default:\n          return state\n      }\n    }\n    case \"SELECT_TOOL\": {\n      if (action.selectedTool === \"show-tags\") {\n        setInLocalStorage(\"showTags\", !state.showTags)\n        return setIn(state, [\"showTags\"], !state.showTags)\n      } else if (action.selectedTool === \"show-mask\") {\n        return setIn(state, [\"showMask\"], !state.showMask)\n      }\n      if (action.selectedTool === \"modify-allowed-area\" && !state.allowedArea) {\n        state = setIn(state, [\"allowedArea\"], { x: 0, y: 0, w: 1, h: 1 })\n      }\n      state = setIn(state, [\"mode\"], null)\n      return setIn(state, [\"selectedTool\"], action.selectedTool)\n    }\n    case \"CANCEL\": {\n      const { mode } = state\n      if (mode) {\n        switch (mode.mode) {\n          case \"DRAW_EXPANDING_LINE\":\n          case \"SET_EXPANDING_LINE_WIDTH\":\n          case \"DRAW_POLYGON\": {\n            const { regionId } = mode\n            return modifyRegion(regionId, null)\n          }\n          case \"MOVE_POLYGON_POINT\":\n          case \"RESIZE_BOX\":\n          case \"MOVE_REGION\": {\n            return setIn(state, [\"mode\"], null)\n          }\n          default:\n            return state\n        }\n      }\n      // Close any open boxes\n      const regions: any = activeImage.regions\n      if (regions && regions.some((r) => r.editingLabels)) {\n        return setIn(\n          state,\n          [...pathToActiveImage, \"regions\"],\n          regions.map((r) => ({\n            ...r,\n            editingLabels: false,\n          }))\n        )\n      } else if (regions) {\n        return setIn(\n          state,\n          [...pathToActiveImage, \"regions\"],\n          regions.map((r) => ({\n            ...r,\n            highlighted: false,\n          }))\n        )\n      }\n      break\n    }\n    default:\n      break\n  }\n  return state\n}\n","export default (key, val) => {\n  window.localStorage.setItem(\n    `__REACT_IMAGE_ANNOTATE_${key}`,\n    JSON.stringify(val)\n  )\n}\n","// @flow\n\nimport type {\n  MainLayoutImageAnnotationState,\n  Action,\n} from \"../../MainLayout/types\"\nimport { setIn } from \"seamless-immutable\"\nimport getActiveImage from \"./get-active-image\"\n\nexport default (state: MainLayoutImageAnnotationState, action: Action) => {\n  const { currentImageIndex, pathToActiveImage, activeImage } = getActiveImage(\n    state\n  )\n\n  switch (action.type) {\n    case \"IMAGE_OR_VIDEO_LOADED\": {\n      return setIn(state, [\"images\", currentImageIndex, \"pixelSize\"], {\n        w: action.metadata.naturalWidth,\n        h: action.metadata.naturalHeight,\n      })\n    }\n  }\n  return state\n}\n","// @flow\n\nimport type {\n  MainLayoutVideoAnnotationState,\n  Action,\n} from \"../../MainLayout/types\"\nimport { setIn, without } from \"seamless-immutable\"\nimport getImpliedVideoRegions from \"./get-implied-video-regions\"\nimport { saveToHistory } from \"./history-handler.js\"\n\nexport default (state: MainLayoutVideoAnnotationState, action: Action) => {\n  const copyImpliedRegions = () => {\n    return setIn(\n      saveToHistory(state, \"Add Keyframe\"),\n      [\"keyframes\", state.currentVideoTime || 0],\n      {\n        regions: getImpliedVideoRegions(\n          state.keyframes,\n          state.currentVideoTime\n        ),\n      }\n    )\n  }\n\n  switch (action.type) {\n    case \"IMAGE_OR_VIDEO_LOADED\": {\n      const { duration } = action.metadata\n      if (typeof duration === \"number\") {\n        return setIn(state, [\"videoDuration\"], duration * 1000)\n      }\n    }\n    case \"HEADER_BUTTON_CLICKED\": {\n      switch (action.buttonName.toLowerCase()) {\n        case \"play\":\n          return setIn(state, [\"videoPlaying\"], true)\n        case \"pause\":\n          return setIn(state, [\"videoPlaying\"], false)\n      }\n    }\n    case \"CHANGE_VIDEO_TIME\": {\n      return setIn(state, [\"currentVideoTime\"], action.newTime)\n    }\n    case \"CHANGE_VIDEO_PLAYING\": {\n      return setIn(state, [\"videoPlaying\"], action.isPlaying)\n    }\n    case \"DELETE_KEYFRAME\": {\n      return setIn(state, [\"keyframes\"], without(state.keyframes, action.time))\n    }\n    default:\n      break\n  }\n\n  // Before the user modifies regions, copy the interpolated regions over to a\n  // new keyframe\n  if (!state.keyframes[state.currentVideoTime]) {\n    switch (action.type) {\n      case \"BEGIN_BOX_TRANSFORM\":\n      case \"BEGIN_MOVE_POINT\":\n      case \"BEGIN_MOVE_KEYPOINT\":\n      case \"BEGIN_MOVE_POLYGON_POINT\":\n      case \"ADD_POLYGON_POINT\":\n      case \"SELECT_REGION\":\n      case \"CHANGE_REGION\":\n      case \"DELETE_REGION\":\n      case \"OPEN_REGION_EDITOR\":\n        return copyImpliedRegions()\n      case \"MOUSE_DOWN\": {\n        switch (state.selectedTool) {\n          case \"create-point\":\n          case \"create-polygon\":\n          case \"create-box\":\n          case \"create-keypoints\":\n            return copyImpliedRegions()\n          default:\n            break\n        }\n        break\n      }\n      default:\n        break\n    }\n  }\n\n  return state\n}\n","// @flow\n\nimport React, { useReducer, useEffect } from \"react\"\nimport type { Node } from \"react\"\nimport MainLayout from \"../MainLayout\"\nimport type {\n  ToolEnum,\n  Image,\n  Mode,\n  MainLayoutState,\n  Action,\n} from \"../MainLayout/types\"\nimport type { KeypointsDefinition } from \"../ImageCanvas/region-tools\"\nimport SettingsProvider from \"../SettingsProvider\"\n\nimport combineReducers from \"./reducers/combine-reducers.js\"\nimport generalReducer from \"./reducers/general-reducer.js\"\nimport imageReducer from \"./reducers/image-reducer.js\"\nimport videoReducer from \"./reducers/video-reducer.js\"\nimport historyHandler from \"./reducers/history-handler.js\"\n\nimport useEventCallback from \"use-event-callback\"\nimport makeImmutable, { without } from \"seamless-immutable\"\nimport getFromLocalStorage from \"../utils/get-from-local-storage\"\n\ntype Props = {\n  taskDescription?: string,\n  allowedArea?: { x: number, y: number, w: number, h: number },\n  regionTagList?: Array<string>,\n  regionClsList?: Array<string>,\n  imageTagList?: Array<string>,\n  imageClsList?: Array<string>,\n  enabledTools?: Array<string>,\n  selectedTool?: String,\n  showTags?: boolean,\n  selectedImage?: string | number,\n  images?: Array<Image>,\n  showPointDistances?: boolean,\n  pointDistancePrecision?: number,\n  RegionEditLabel?: Node,\n  onExit: (MainLayoutState) => any,\n  videoTime?: number,\n  videoSrc?: string,\n  keyframes?: Object,\n  videoName?: string,\n  keypointDefinitions: KeypointsDefinition,\n  fullImageSegmentationMode?: boolean,\n  autoSegmentationOptions?:\n    | {| type: \"simple\" |}\n    | {| type: \"autoseg\", maxClusters?: number, slicWeightFactor?: number |},\n  hideHeader?: boolean,\n  hideHeaderText?: boolean,\n  hideNext?: boolean,\n  hidePrev?: boolean,\n}\n\nexport const Annotator = ({\n  images,\n  allowedArea,\n  selectedImage = images && images.length > 0 ? 0 : undefined,\n  showPointDistances,\n  pointDistancePrecision,\n  showTags = getFromLocalStorage(\"showTags\", true),\n  enabledTools = [\n    \"select\",\n    \"create-point\",\n    \"create-box\",\n    \"create-polygon\",\n    \"create-line\",\n    \"create-expanding-line\",\n    \"show-mask\",\n  ],\n  selectedTool = \"select\",\n  regionTagList = [],\n  regionClsList = [],\n  imageTagList = [],\n  imageClsList = [],\n  keyframes = {},\n  taskDescription = \"\",\n  fullImageSegmentationMode = false,\n  RegionEditLabel,\n  videoSrc,\n  videoTime = 0,\n  videoName,\n  onExit,\n  onNextImage,\n  onPrevImage,\n  keypointDefinitions,\n  autoSegmentationOptions = { type: \"autoseg\" },\n  hideHeader,\n  hideHeaderText,\n  hideNext,\n  hidePrev,\n  allowComments,\n}: Props) => {\n  if (typeof selectedImage === \"string\") {\n    selectedImage = (images || []).findIndex((img) => img.src === selectedImage)\n    if (selectedImage === -1) selectedImage = undefined\n  }\n  const annotationType = images ? \"image\" : \"video\"\n  const [state, dispatchToReducer] = useReducer(\n    historyHandler(\n      combineReducers(\n        annotationType === \"image\" ? imageReducer : videoReducer,\n        generalReducer\n      )\n    ),\n    makeImmutable({\n      annotationType,\n      showTags,\n      allowedArea,\n      showPointDistances,\n      pointDistancePrecision,\n      selectedTool,\n      fullImageSegmentationMode: fullImageSegmentationMode,\n      autoSegmentationOptions,\n      mode: null,\n      taskDescription,\n      showMask: true,\n      labelImages: imageClsList.length > 0 || imageTagList.length > 0,\n      regionClsList,\n      regionTagList,\n      imageClsList,\n      imageTagList,\n      currentVideoTime: videoTime,\n      enabledTools,\n      history: [],\n      videoName,\n      keypointDefinitions,\n      allowComments,\n      ...(annotationType === \"image\"\n        ? {\n            selectedImage,\n            images,\n            selectedImageFrameTime:\n              images && images.length > 0 ? images[0].frameTime : undefined,\n          }\n        : {\n            videoSrc,\n            keyframes,\n          }),\n    })\n  )\n\n  const dispatch = useEventCallback((action: Action) => {\n    if (action.type === \"HEADER_BUTTON_CLICKED\") {\n      if ([\"Exit\", \"Done\", \"Save\", \"Complete\"].includes(action.buttonName)) {\n        return onExit(without(state, \"history\"))\n      } else if (action.buttonName === \"Next\" && onNextImage) {\n        return onNextImage(without(state, \"history\"))\n      } else if (action.buttonName === \"Prev\" && onPrevImage) {\n        return onPrevImage(without(state, \"history\"))\n      }\n    }\n    dispatchToReducer(action)\n  })\n\n  const onRegionClassAdded = useEventCallback((cls) => {\n    dispatchToReducer({\n      type: \"ON_CLS_ADDED\",\n      cls: cls,\n    })\n  })\n\n  useEffect(() => {\n    if (selectedImage === undefined) return\n    dispatchToReducer({\n      type: \"SELECT_IMAGE\",\n      imageIndex: selectedImage,\n      image: state.images[selectedImage],\n    })\n  }, [selectedImage, state.images])\n\n  if (!images && !videoSrc)\n    return 'Missing required prop \"images\" or \"videoSrc\"'\n\n  return (\n    <SettingsProvider>\n      <MainLayout\n        RegionEditLabel={RegionEditLabel}\n        alwaysShowNextButton={Boolean(onNextImage)}\n        alwaysShowPrevButton={Boolean(onPrevImage)}\n        state={state}\n        dispatch={dispatch}\n        onRegionClassAdded={onRegionClassAdded}\n        hideHeader={hideHeader}\n        hideHeaderText={hideHeaderText}\n        hideNext={hideNext}\n        hidePrev={hidePrev}\n      />\n    </SettingsProvider>\n  )\n}\n\nexport default Annotator\n","export default (key, defaultValue) => {\n  try {\n    return JSON.parse(window.localStorage[`__REACT_IMAGE_ANNOTATE_${key}`])\n  } catch (e) {\n    return defaultValue\n  }\n}\n","export default (...reducers) => (state, action) => {\n  for (const reducer of reducers) {\n    state = reducer(state, action)\n  }\n  return state\n}\n","// @flow\n\nimport React, { Component } from \"react\"\nimport Dialog from \"@material-ui/core/Dialog\"\nimport Button from \"@material-ui/core/Button\"\nimport DialogTitle from \"@material-ui/core/DialogTitle\"\nimport DialogContent from \"@material-ui/core/DialogContent\"\nimport DialogActions from \"@material-ui/core/DialogActions\"\n\nexport default class ErrorBoundaryDialog extends Component {\n  state = { hasError: false, err: \"\" }\n  componentDidCatch(err, info) {\n    this.setState({\n      hasError: true,\n      err: err.toString() + \"\\n\\n\" + info.componentStack,\n    })\n  }\n  render() {\n    if (this.state.hasError) {\n      return (\n        <Dialog open={this.state.hasError} onClose={this.props.onClose}>\n          <DialogTitle>Error Loading Annotator</DialogTitle>\n          <DialogContent>\n            <pre>{this.state.err}</pre>\n          </DialogContent>\n          <DialogActions>\n            <Button onClick={this.props.onClose}>Close</Button>\n          </DialogActions>\n        </Dialog>\n      )\n    }\n    return this.props.children\n  }\n}\n","// @flow\nimport React, { useState } from \"react\"\nimport ReactDOM from \"react-dom\"\nimport Editor, { examples } from \"./Editor\"\nimport Annotator from \"../Annotator\"\nimport ErrorBoundaryDialog from \"./ErrorBoundaryDialog.js\"\n\nexport default () => {\n  const [annotatorOpen, changeAnnotatorOpen] = useState(false)\n  const [annotatorProps, changeAnnotatorProps] = useState(examples[\"Custom\"]())\n  const [lastOutput, changeLastOutput] = useState()\n\n  return (\n    <div>\n      {annotatorOpen ? (\n        <ErrorBoundaryDialog\n          onClose={() => {\n            changeAnnotatorOpen(false)\n          }}\n        >\n          <Annotator\n            {...(annotatorProps: any)}\n            onExit={(output) => {\n              delete (output: any)[\"lastAction\"]\n              changeLastOutput(output)\n              changeAnnotatorOpen(false)\n            }}\n          />\n        </ErrorBoundaryDialog>\n      ) : (\n        <Editor\n          lastOutput={lastOutput}\n          onOpenAnnotator={(props) => {\n            changeAnnotatorProps(props)\n            changeAnnotatorOpen(true)\n          }}\n        />\n      )}\n    </div>\n  )\n}\n","// @flow\n\nimport React from \"react\"\nimport Button from \"@material-ui/core/Button\"\nimport { styled } from \"@material-ui/core/styles\"\nimport * as colors from \"@material-ui/core/colors\"\nimport Grid from \"@material-ui/core/Grid\"\nimport Markdown from \"react-markdown\"\nimport GitHubButton from \"react-github-btn\"\nimport \"./github-markdown.css\"\nimport raw from \"raw.macro\"\nimport { Prism as SyntaxHighlighter } from \"react-syntax-highlighter\"\nimport { docco } from \"react-syntax-highlighter/dist/cjs/languages/hljs/javascript\"\n\nconst contentMd = raw(\"./content.md\")\n\nconst RootContainer = styled(\"div\")({\n  display: \"flex\",\n  flexDirection: \"column\",\n  alignItems: \"center\",\n})\nconst ContentContainer = styled(\"div\")({\n  width: \"100%\",\n  boxSizing: \"border-box\",\n  display: \"flex\",\n  flexDirection: \"column\",\n  maxWidth: 1200,\n})\nconst Header = styled(\"div\")({\n  width: \"100%\",\n  display: \"flex\",\n  justifyContent: \"center\",\n  backgroundColor: colors.blue[600],\n  padding: 8,\n  boxSizing: \"border-box\",\n})\nconst HeaderButton = styled(Button)({\n  color: \"white\",\n  margin: 8,\n  padding: 16,\n  paddingLeft: 24,\n  paddingRight: 24,\n})\nconst Hero = styled(\"div\")({\n  display: \"flex\",\n  justifyContent: \"center\",\n  width: \"100%\",\n  backgroundColor: colors.blue[500],\n  padding: 16,\n  color: \"white\",\n  boxSizing: \"border-box\",\n})\nconst HeroMain = styled(\"div\")({\n  fontSize: 48,\n  fontWeight: \"bold\",\n  paddingTop: 64,\n  textShadow: \"0px 1px 5px rgba(0,0,0,0.3)\",\n})\nconst HeroSub = styled(\"div\")({\n  paddingTop: 32,\n  lineHeight: 1.5,\n  fontSize: 24,\n  textShadow: \"0px 1px 3px rgba(0,0,0,0.2)\",\n})\nconst HeroButtons = styled(\"div\")({\n  paddingTop: 32,\n  paddingBottom: 48,\n})\nconst Section = styled(\"div\")({\n  display: \"flex\",\n  padding: 16,\n  paddingTop: 32,\n  flexDirection: \"column\",\n})\n\nconst CodeBlock = ({ language, value }) => {\n  return (\n    <SyntaxHighlighter language={language} style={docco}>\n      {value}\n    </SyntaxHighlighter>\n  )\n}\n\nfunction flatten(text, child) {\n  return typeof child === \"string\"\n    ? text + child\n    : React.Children.toArray(child.props.children).reduce(flatten, text)\n}\n\nfunction HeadingRenderer(props) {\n  var children = React.Children.toArray(props.children)\n  var text = children.reduce(flatten, \"\")\n  var slug = text.toLowerCase().replace(/\\W/g, \"-\")\n  return React.createElement(\"h\" + props.level, { id: slug }, props.children)\n}\n\nconst LandingPage = () => {\n  return (\n    <RootContainer>\n      <Header id=\"about\">\n        <ContentContainer style={{ flexDirection: \"row\", flexGrow: 1 }}>\n          <HeaderButton href=\"#features\">Features</HeaderButton>\n          <HeaderButton href=\"#usage\">Usage</HeaderButton>\n          <HeaderButton href=\"#props\">Props</HeaderButton>\n          <HeaderButton href=\"./demo\">Demo Playground</HeaderButton>\n        </ContentContainer>\n      </Header>\n      <Hero>\n        <ContentContainer>\n          <HeroMain>React Image Annotate</HeroMain>\n          <HeroSub>\n            Powerful React component for image annotations with bounding boxes,\n            tagging, classification, multiple images and polygon segmentation.\n          </HeroSub>\n          <HeroButtons>\n            <GitHubButton\n              href=\"https://github.com/waoai/react-image-annotate\"\n              data-size=\"large\"\n              data-show-count=\"true\"\n              aria-label=\"Star waoai/react-image-annotate on GitHub\"\n            >\n              Star\n            </GitHubButton>\n          </HeroButtons>\n        </ContentContainer>\n      </Hero>\n      <ContentContainer className=\"markdown-body\">\n        <Section className=\"markdown-body\">\n          <Markdown\n            escapeHtml={false}\n            source={contentMd}\n            renderers={{\n              code: CodeBlock,\n              heading: HeadingRenderer,\n            }}\n          />\n        </Section>\n      </ContentContainer>\n    </RootContainer>\n  )\n}\n\nexport default LandingPage\n","// @flow\n\nimport React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport Theme from \"./Theme\"\nimport DemoSite from \"./DemoSite\"\nimport LandingPage from \"./LandingPage\"\nimport \"./site.css\"\n\nconst Site = () => {\n  const path = window.location.pathname\n    .replace(/\\/$/, \"\")\n    .split(\"/\")\n    .slice(-1)[0]\n  return <Theme>{path === \"demo\" ? <DemoSite /> : <LandingPage />}</Theme>\n}\n\nReactDOM.render(<Site />, document.getElementById(\"root\"))\n"],"sourceRoot":""}