(this["webpackJsonpreact-image-annotate"]=this["webpackJsonpreact-image-annotate"]||[]).push([[0],{1101:function(e,t,n){},1102:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(17),r=n.n(i),c=n(1105),l=n(446),s=n(1189),u=Object(c.a)({container:{fontFamily:'"Inter", sans-serif'}}),d=Object(l.a)({typography:{fontFamily:'"Inter", "Roboto", sans-serif'},overrides:{MuiButton:{root:{textTransform:"none"}}}}),g=function(e){var t=e.children,n=u();return o.a.createElement(s.a,{theme:d},o.a.createElement("div",{className:n.container},t))},m=n(9),h=n(217),f=n(81),p=n(1193),b=n(696),y=n(698),O=n(699),v=n(700),E=n(250),x=n.n(E),w=Object(c.a)({editBar:{padding:10,borderBottom:"1px solid #ccc",backgroundColor:"#f8f8f8",display:"flex",alignItems:"center","& .button":{margin:5}},select:{width:240,fontSize:14},contentArea:{padding:10},specificationArea:{padding:10}}),j=function(){try{return JSON.parse(window.localStorage.getItem("customInput")||"{}")}catch(e){return{}}},I={"Simple Bounding Box":function(){return{taskDescription:"Annotate each image according to this _markdown_ specification.",regionTagList:["has-bun"],regionClsList:["hotdog","not-hotdog"],enabledTools:["select","create-box"],images:[{src:"https://images.unsplash.com/photo-1496905583330-eb54c7e5915a?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=634&q=80",name:"hot-dogs-1"},{src:"https://www.bianchi.com/wp-content/uploads/2019/07/YPB17I555K.jpg",name:"bianchi-oltre-xr4"}],allowComments:!0}},"Simple Segmentation":function(){return{taskDescription:"Annotate each image according to this _markdown_ specification.",regionClsList:["car","truck"],enabledTools:["select","create-polygon"],images:[{src:"https://images.unsplash.com/photo-1561518776-e76a5e48f731?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=750&q=80",name:"car-image-1"}]}},Custom:function(){return j()}},T=function(e){var t=e.onOpenAnnotator,n=e.lastOutput,i=w(),r=Object(a.useState)(),c=Object(m.a)(r,2),l=c[0],s=c[1],u=Object(a.useState)(window.localStorage.getItem("customInput")?"Custom":"Simple Bounding Box"),d=Object(m.a)(u,2),g=d[0],E=d[1],T=Object(a.useState)(!1),C=Object(m.a)(T,2),S=C[0],M=C[1],N=Object(a.useState)(JSON.stringify(I[g](),null,"  ")),k=Object(m.a)(N,2),A=k[0],_=k[1];return o.a.createElement("div",null,o.a.createElement("div",{className:i.editBar},o.a.createElement("h3",null,"React Image Annotate"),o.a.createElement("div",{style:{flexGrow:1}}),o.a.createElement("div",null,o.a.createElement("div",{style:{display:"inline-flex"}},o.a.createElement(f.default,{className:i.select,value:{label:g,value:g},options:Object.keys(I).map((function(e){return{label:e,value:e}})),onChange:function(e){E(e.value),_(JSON.stringify("Custom"===e.value?j():I[e.value](),null,"  "))}})),o.a.createElement(h.a,{className:"button",disabled:!n,onClick:function(){return M(!0)}},"View Output"),o.a.createElement(h.a,{className:"button",variant:"outlined",disabled:Boolean(l),onClick:function(){t("Custom"===g?j():I[g])}},"Open Annotator"))),o.a.createElement("div",{className:i.contentArea,style:l?{border:"2px solid #f00"}:{border:"2px solid #fff"}},o.a.createElement("div",null,o.a.createElement(x.a,{value:A,language:"javascript",onChange:function(e){try{window.localStorage.setItem("customInput",JSON.stringify(JSON.parse(e))),s(null)}catch(t){s(t.toString())}_(e)},width:"100%",height:"550px"}))),o.a.createElement("div",{className:i.specificationArea},o.a.createElement("h2",null,"React Image Annotate Format"),o.a.createElement(p.a,{language:"javascript"},'\n{\n  taskDescription?: string, // markdown\n  regionTagList?: Array<string>,\n  regionClsList?: Array<string>,\n  imageTagList?: Array<string>,\n  imageClsList?: Array<string>,\n  // all tools are enabled by default\n  enabledTools?: Array< "select" | "create-point" | "create-box" | "create-polygon" | "create-line">,\n  selectedImage?: string, // initial selected image\n  images: Array<{\n    src: string,\n    thumbnailSrc?: string, // use this if you are using high-res images\n    name: string,\n    regions?: Array<{\n      id: string | number,\n      cls?: string,\n      color?: string,\n      tags?: Array<string>,\n\n      // Point\n      type: "point",\n      x: number, // [0-1] % of image width\n      y: number, // [0-1] % of image height\n\n      // Bounding Box\n      type: "box",\n      x: number, // [0-1] % of image width\n      y: number, // [0-1] % of image height\n      w: number, // [0-1] % of image width\n      h: number, // [0-1] % of image height\n\n      // Polygon\n      type: "polygon",\n      open?: boolean, // should last and first points be connected, default: true\n      points: Array<[number, number]> // [0-1] % of image width/height\n    }>\n  }>,\n}\n')),o.a.createElement(b.a,{fullScreen:!0,open:S},o.a.createElement(y.a,null,"React Image Annotate Output"),o.a.createElement(O.a,{style:{minWidth:400}},o.a.createElement(x.a,{value:JSON.stringify(n,null,"  "),language:"javascript",width:"100%",height:"550px"})),o.a.createElement(v.a,null,o.a.createElement(h.a,{onClick:function(){return M(!1)}},"Close"))))},C=n(4),S=n(119),M=n(448),N=n(10),k=n(185),A=function(e){var t=e.mousePosition,n=e.x,i=e.y,r=Object(a.useState)(),c=Object(m.a)(r,2),l=(c[0],c[1]);return t&&(n=t.current.x,i=t.current.y),Object(a.useEffect)((function(){if(t){var e=setInterval((function(){n===t.current.x&&i===t.current.y||l([t.current.x,t.current.y])}),10);return function(){return clearInterval(e)}}})),o.a.createElement(a.Fragment,null,o.a.createElement("div",{style:{position:"absolute",height:"100%",width:1,zIndex:10,backgroundColor:"#f00",left:n,pointerEvents:"none",top:0}}),o.a.createElement("div",{style:{position:"absolute",width:"100%",zIndex:10,height:1,backgroundColor:"#f00",top:i,pointerEvents:"none",left:0}}))},_=n(1192),L=n(23),D=Object(M.a)("div")({"& > div":{width:"100%",height:"100%"}}),R=function(e){var t=e.children,n=Object(S.a)(e,["children"]),i=Object(a.useState)(!1),r=Object(m.a)(i,2),c=r[0],l=r[1],s=Object(L.a)((function(e){c||l(!0),n.onMouseMove&&n.onMouseMove(e)})),u=Object(L.a)((function(e){setTimeout((function(){c&&l(!1)}),100)}));return o.a.createElement(D,Object.assign({},n,{onMouseMove:s,onMouseLeave:u}),o.a.createElement(_.a,{enabled:c,removeScrollBar:!1},t))},P=n(1195),B=n(1191),W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n="undefined"!==typeof window,o=Object(P.a)({width:n?window.innerWidth:e,height:n?window.innerHeight:t}),i=Object(m.a)(o,2),r=i[0],c=i[1];return Object(a.useEffect)((function(){if(n){var e=function(){c({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}}),[]),Object(B.a)((function(){n&&(window.innerWidth===r.width&&window.innerHeight===r.height||c({width:window.innerWidth,height:window.innerHeight}))}),100),r},z=function(e){var t=e.canvasEl,n=e.changeMat,o=e.changeDragging,i=e.zoomStart,r=(e.zoomEnd,e.changeZoomStart),c=e.changeZoomEnd,l=e.layoutParams,s=e.zoomWithPrimary,u=e.dragWithPrimary,d=e.mat,g=e.onMouseMove,m=e.onMouseUp,h=e.onMouseDown,f=e.dragging,p=Object(a.useRef)({x:0,y:0}),b=Object(a.useRef)({x:0,y:0}),y=function(e,t){var a=[t.x,t.y],o=a[0],i=a[1],r="object"===typeof e?e.to/d.a:1+.2*e;d.translate(o,i).scaleU(r),d.a>2&&d.scaleU(2/d.a),d.a<.05&&d.scaleU(.05/d.a),d.translate(-o,-i),n(d.clone())};return{mouseEvents:{onMouseMove:function(e){var a=t.current.getBoundingClientRect(),o=a.left,r=a.top;b.current.x=p.current.x,b.current.y=p.current.y,p.current.x=e.clientX-o,p.current.y=e.clientY-r;var u=d.applyToPoint(p.current.x,p.current.y);s&&i&&c(u);var m=l.current,h=m.iw,y=m.ih;g({x:u.x/h,y:u.y/y}),f&&(d.translate(b.current.x-p.current.x,b.current.y-p.current.y),n(d.clone())),e.preventDefault()},onMouseDown:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e.preventDefault(),1===e.button||2===e.button||0===e.button&&u)return o(!0);var n=d.applyToPoint(p.current.x,p.current.y);if(s&&0===e.button)return r(n),void c(n);if(0===e.button){t.type,t.type;var a=l.current,i=a.iw,g=a.ih;h({x:n.x/i,y:n.y/g})}},onMouseUp:function(e){e.preventDefault();var t=d.applyToPoint(p.current.x,p.current.y);if(i){var a=t;if(Math.abs(i.x-a.x)<10&&Math.abs(i.y-a.y)<10)d.a<1?y({to:1},p.current):y({to:.25},p.current);else{var s=l.current,g=s.iw,h=s.ih;if(i.x>a.x){var f=[a.x,i.x];i.x=f[0],a.x=f[1]}if(i.y>a.y){var b=[a.y,i.y];i.y=b[0],a.y=b[1]}var O=Math.min((a.x-i.x)/g,(a.y-i.y)/h);O<.05&&(O=.05),O>10&&(O=10);var v=k.Matrix.from(1,0,0,1,-10,-10).translate(i.x,i.y).scaleU(O);n(v.clone())}r(null),c(null)}if(1===e.button||2===e.button||0===e.button&&u)return o(!1);if(0===e.button){var E=l.current,x=E.iw,w=E.ih;m({x:t.x/x,y:t.y/w})}},onWheel:function(e){var t=e.deltaY>0?1:e.deltaY<0?-1:0;y(t,p.current)},onContextMenu:function(e){e.preventDefault()}},mousePosition:p}},G=function(e){var t=e.layoutParams,n=e.mat;return Object(L.a)((function(e){var a=t.current,o=a.iw,i=a.ih,r=function(e){switch(e.type){case"polygon":var t={x:Math.min.apply(Math,Object(N.a)(e.points.map((function(e){var t=Object(m.a)(e,2),n=t[0];t[1];return n})))),y:Math.min.apply(Math,Object(N.a)(e.points.map((function(e){var t=Object(m.a)(e,2);t[0];return t[1]})))),w:0,h:0};return t.w=Math.max.apply(Math,Object(N.a)(e.points.map((function(e){var t=Object(m.a)(e,2),n=t[0];t[1];return n}))))-t.x,t.h=Math.max.apply(Math,Object(N.a)(e.points.map((function(e){var t=Object(m.a)(e,2);t[0];return t[1]}))))-t.y,t;case"keypoints":var n=Math.min.apply(Math,Object(N.a)(Object.values(e.points).map((function(e){var t=e.x;e.y;return t})))),a=Math.min.apply(Math,Object(N.a)(Object.values(e.points).map((function(e){e.x;return e.y}))));return{x:n,y:a,w:Math.max.apply(Math,Object(N.a)(Object.values(e.points).map((function(e){var t=e.x;e.y;return t}))))-n,h:Math.max.apply(Math,Object(N.a)(Object.values(e.points).map((function(e){e.x;return e.y}))))-a};case"expanding-line":var o={x:Math.min.apply(Math,Object(N.a)(e.points.map((function(e){var t=e.x;e.y;return t})))),y:Math.min.apply(Math,Object(N.a)(e.points.map((function(e){e.x;return e.y})))),w:0,h:0};return o.w=Math.max.apply(Math,Object(N.a)(e.points.map((function(e){var t=e.x;e.y;return t}))))-o.x,o.h=Math.max.apply(Math,Object(N.a)(e.points.map((function(e){e.x;return e.y}))))-o.y,o;case"line":return{x:e.x1,y:e.y1,w:0,h:0};case"box":return{x:e.x,y:e.y,w:e.w,h:e.h};case"point":return{x:e.x,y:e.y,w:0,h:0};default:return{x:0,y:0,w:0,h:0}}throw new Error("unknown region")}(e),c="point"===e.type?15:2,l={x:r.x*o-c,y:r.y*i-c,w:r.w*o+2*c,h:r.h*i+2*c};return Object(C.a)(Object(C.a)({},n.clone().inverse().applyToPoint(l.x,l.y)),{},{w:l.w/n.a,h:l.h/n.d})}))},H=Object(M.a)("svg")({pointerEvents:"none",position:"absolute",zIndex:1,left:0,top:0,width:"100%",height:"100%","& text":{fill:"#fff"},"& path":{vectorEffect:"non-scaling-stroke",strokeWidth:2,opacity:.5,stroke:"#FFF",fill:"none",strokeDasharray:5,animationDuration:"4s",animationTimingFunction:"linear",animationIterationCount:"infinite",animationPlayState:"running"}}),V=function(e){var t=e.projectRegionBox,n=e.regions,i=e.pointDistancePrecision,r=e.realSize;return o.a.createElement(H,null,n.filter((function(e){return"point"===e.type})).flatMap((function(e,c){return n.filter((function(e,t){return t>c})).filter((function(e){return"point"===e.type})).map((function(n){var c,l=t(e),s=t(n),u={x:(l.x+l.w/2+s.x+s.w/2)/2,y:(l.y+l.h/2+s.y+s.h/2)/2};if(r){var d=r.w,g=r.h,m=r.unitName;c=Math.sqrt(Math.pow(e.x*d-n.x*d,2)+Math.pow(e.y*g-n.y*g,2)).toFixed(i)+m}else c=(100*Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))).toFixed(i)+"%";return o.a.createElement(a.Fragment,null,o.a.createElement("path",{d:"M".concat(l.x+l.w/2,",").concat(l.y+l.h/2," L").concat(s.x+s.w/2,",").concat(s.y+s.h/2)}),o.a.createElement("text",{x:u.x,y:u.y},c))}))})))},U=n(194),F=n(56),Y={regionInfo:{fontSize:12,cursor:"default",transition:"opacity 200ms",opacity:.5,"&:hover":{opacity:.9,cursor:"pointer"},"&.highlighted":{opacity:.9,"&:hover":{opacity:1}},fontWeight:600,color:F.a[900],padding:8,"& .name":{display:"flex",flexDirection:"row",alignItems:"center","& .circle":{marginRight:4,boxShadow:"0px 0px 2px rgba(0,0,0,0.4)",width:10,height:10,borderRadius:5}},"& .tags":{"& .tag":{color:F.a[700],display:"inline-block",margin:1,fontSize:10,textDecoration:"underline"}}},commentBox:{fontWeight:400,fontSize:13}},K=n(34),X=n.n(K),Z=n(252),J=n(82),q=n.n(J),$=n(248),Q=n.n($),ee=n(220),te=n(403),ne=n(6),ae=n.n(ne),oe=Object(c.a)(Y),ie=Object(a.memo)((function(e){var t=e.region,n=e.editing,i=e.allowedClasses,r=e.allowedTags,c=e.onDelete,l=e.onChange,s=e.onClose,u=e.onOpen,d=e.onRegionClassAdded,g=e.allowComments,m=oe(),p=Object(a.useRef)(null);return o.a.createElement(U.a,{onClick:function(){return n?null:u(t)},className:X()(m.regionInfo,{highlighted:t.highlighted})},n?o.a.createElement("div",{style:{width:200}},o.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},o.a.createElement("div",{style:{display:"flex",backgroundColor:t.color||"#888",color:"#fff",padding:4,paddingLeft:8,paddingRight:8,borderRadius:4,fontWeight:"bold",textShadow:"0px 0px 5px rgba(0,0,0,0.4)"}},t.type),o.a.createElement("div",{style:{flexGrow:1}}),o.a.createElement(Z.a,{onClick:function(){return c(t)},tabIndex:-1,style:{width:22,height:22},size:"small",variant:"outlined"},o.a.createElement(q.a,{style:{marginTop:-8,width:16,height:16}}))),(i||[]).length>0&&o.a.createElement("div",{style:{marginTop:6}},o.a.createElement(te.a,{placeholder:"Classification",onChange:function(e,n){return"create-option"==n.action&&d(e.value),l(Object(C.a)(Object(C.a)({},t),{},{cls:e.value}))},value:t.cls?{label:t.cls,value:t.cls}:null,options:Object(ne.asMutable)(i.map((function(e){return{value:e,label:e}})))})),(r||[]).length>0&&o.a.createElement("div",{style:{marginTop:4}},o.a.createElement(f.default,{onChange:function(e){return l(Object(C.a)(Object(C.a)({},t),{},{tags:e.map((function(e){return e.value}))}))},placeholder:"Tags",value:(t.tags||[]).map((function(e){return{label:e,value:e}})),isMulti:!0,options:Object(ne.asMutable)(r.map((function(e){return{value:e,label:e}})))})),g&&o.a.createElement(ee.a,{InputProps:{className:m.commentBox},fullWidth:!0,multiline:!0,rows:3,ref:p,onClick:function(e){var t=p.current.children[0].children[0];if(t)return t.focus()},value:t.comment||"",onChange:function(e){return l(Object(C.a)(Object(C.a)({},t),{},{comment:e.target.value}))}}),s&&o.a.createElement("div",{style:{marginTop:4,display:"flex"}},o.a.createElement("div",{style:{flexGrow:1}}),o.a.createElement(h.a,{onClick:function(){return s(t)},size:"small",variant:"contained",color:"primary"},o.a.createElement(Q.a,null)))):o.a.createElement("div",null,t.cls&&o.a.createElement("div",{className:"name"},o.a.createElement("div",{className:"circle",style:{backgroundColor:t.color}}),t.cls),t.tags&&o.a.createElement("div",{className:"tags"},t.tags.map((function(e){return o.a.createElement("div",{key:e,className:"tag"},e)})))))}),(function(e,t){return e.editing===t.editing&&e.region===t.region})),re=n(145),ce=n.n(re),le=function(e){var t=e.regions,n=e.projectRegionBox,a=e.mouseEvents,i=e.regionClsList,r=e.regionTagList,c=e.onBeginRegionEdit,l=e.onChangeRegion,s=e.onCloseRegionEdit,u=e.onDeleteRegion,d=e.layoutParams,g=e.imageSrc,m=e.RegionEditLabel,h=e.onRegionClassAdded,f=e.allowComments,p=null!=m?m:ie;return t.filter((function(e){return e.visible||void 0===e.visible})).map((function(e){var m=n(e),b=d.current,y=(b.iw,b.ih,8);e.highlighted&&"box"===e.type&&(y+=6);var O=e.editingLabels&&!e.locked?170:e.tags?60:50,v=m.y>O,E=v?{left:m.x,top:m.y-y/2}:{left:m.x,top:m.y+m.h+y/2};return e.locked?o.a.createElement("div",{key:e.id,style:Object(C.a)(Object(C.a)({position:"absolute"},E),{},{zIndex:10+(e.editingLabels?5:0)})},o.a.createElement(U.a,{style:Object(C.a)(Object(C.a)({position:"absolute",left:0},v?{bottom:0}:{top:0}),{},{zIndex:10,backgroundColor:"#fff",borderRadius:4,padding:2,paddingBottom:0,opacity:.5,pointerEvents:"none"})},o.a.createElement(ce.a,{style:{width:16,height:16,color:"#333"}}))):o.a.createElement("div",{key:e.id,style:Object(C.a)(Object(C.a)({position:"absolute"},E),{},{zIndex:10+(e.editingLabels?5:0),width:200}),onMouseDown:function(e){return e.preventDefault()},onMouseUp:function(e){return e.preventDefault()},onMouseEnter:function(t){e.editingLabels&&(a.onMouseUp(t),t.button=1,a.onMouseUp(t))}},o.a.createElement("div",Object.assign({style:Object(C.a)({position:"absolute",zIndex:20,left:0},v?{bottom:0}:{top:0})},e.editingLabels?{}:function(e){for(var t=Object(C.a)({},e),n=arguments.length,a=new Array(n>1?n-1:0),o=1;o<n;o++)a[o-1]=arguments[o];for(var i=0,r=a;i<r.length;i++){var c=r[i];delete t[c]}return t}(a,"onMouseDown","onMouseUp")),o.a.createElement(p,{allowedClasses:i,allowedTags:r,onOpen:c,onChange:l,onClose:s,onDelete:u,editing:e.editingLabels,region:e,regions:t,imageSrc:g,onRegionClassAdded:h,allowComments:f})))}))},se=n(109),ue=n(111),de=n(112),ge=n(110),me=n(350),he=n(351),fe=n(108),pe=n(352),be=n(107),ye=n(353),Oe=n(354),ve=n(355),Ee=[se.a[500],ue.a[500],de.a[500],ge.a[800],me.a[500],he.a[700],fe.a[500],pe.a[500],be.a[500],ye.a[500],Oe.a[500],ve.a[500]];Ee.map((function(e){return(2281701376|function(e){var t=(e=e.replace("#","")).substr(4,2)+e.substr(2,2)+e.substr(0,2);return parseInt(t,16)}(e))>>>0}));var xe=Ee,we=n(1197),je=function(e){var t=Array.from(document.getElementsByTagName("img")).find((function(t){return t.src===e})),n=document.createElement("canvas"),a=n.getContext("2d");return t||((t=new Image).crossOrigin="anonymous",t.src=e),new Promise((function(e,o){t.onload=function(){n.width=t.naturalWidth,n.height=t.naturalHeight,a.drawImage(t,0,0);var o=a.getImageData(0,0,t.naturalWidth,t.naturalHeight);e(o)}}))},Ie=n(195),Te=n.n(Ie);var Ce=function(e){var t=e.regions,n=e.regionClsList,i=e.imageSrc,r=e.imagePosition,c=e.zIndex,l=void 0===c?1:c,s=e.hide,u=void 0!==s&&s,d=e.autoSegmentationOptions,g=void 0===d?{type:"simple"}:d,h=Object(a.useState)(null),f=Object(m.a)(h,2),p=f[0],b=f[1],y=Object(a.useState)(),O=Object(m.a)(y,2),v=O[0],E=O[1];Object(a.useEffect)((function(){i&&je(i).then((function(e){Te.a.setConfig(Object(C.a)({classNames:n},g)),Te.a.loadImage(e),E(e)}))}),[i]),Object(we.a)((function(){if(!u&&p&&v&&!(t.filter((function(e){return e.cls})).length<2)){var e=function(e){return e.map((function(e){switch(e.type){case"point":return{regionType:"point",classification:e.cls,x:e.x,y:e.y};case"polygon":return{regionType:"polygon",classification:e.cls,points:e.points.map((function(e){var t=Object(m.a)(e,2);return{x:t[0],y:t[1]}}))};case"box":return{regionType:"bounding-box",classification:e.cls,centerX:e.x+e.w/2,centerY:e.y+e.h/2,width:e.w,height:e.h};default:return null}})).filter(Boolean)}(t);Te.a.getMask(e).then((function(e){var t=p.getContext("2d");t.clearRect(0,0,e.width,e.height),t.putImageData(e,0,0)}))}}),1e3,[p,v,t,u]);var x=Object(a.useMemo)((function(){var e=r.bottomRight.x-r.topLeft.x,t=r.bottomRight.y-r.topLeft.y;return{display:u?"none":void 0,imageRendering:"pixelated",transform:"translateZ(0px)",left:r.topLeft.x,top:r.topLeft.y,width:isNaN(e)?0:e,height:isNaN(t)?0:t,zIndex:l,position:"absolute",pointerEvents:"none"}}),[r.topLeft.x,r.topLeft.y,r.bottomRight.x,r.bottomRight.y,l,u]);return o.a.createElement("canvas",{style:x,width:v?v.width:0,height:v?v.height:0,ref:b})},Se=Object(c.a)({"@keyframes borderDance":{from:{strokeDashoffset:0},to:{strokeDashoffset:100}},highlightBox:{zIndex:2,transition:"opacity 500ms","&.highlighted":{zIndex:3},"&:not(.highlighted)":{opacity:0},"&:not(.highlighted):hover":{opacity:.6},"& path":{vectorEffect:"non-scaling-stroke",strokeWidth:2,stroke:"#FFF",fill:"none",strokeDasharray:5,animationName:"$borderDance",animationDuration:"4s",animationTimingFunction:"linear",animationIterationCount:"infinite",animationPlayState:"running"}}}),Me=function(e){var t=e.mouseEvents,n=e.dragWithPrimary,a=e.zoomWithPrimary,i=e.createWithPrimary,r=e.onBeginMovePoint,c=e.onSelectRegion,l=e.region,s=e.pbox,u=Se();if(!s.w||s.w===1/0)return null;if(!s.h||s.h===1/0)return null;if(l.unfinished)return null;var d="point"===l.type?{left:s.x+s.w/2-30,top:s.y+s.h/2-30,width:60,height:60}:{left:s.x-5,top:s.y-5,width:s.w+10,height:s.h+10},g="point"===l.type?"M5,5 L".concat(d.width-5," 5L").concat(d.width-5," ").concat(d.height-5,"L5 ").concat(d.height-5,"Z"):"M5,5 L".concat(s.w+5,",5 L").concat(s.w+5,",").concat(s.h+5," L5,").concat(s.h+5," Z");return o.a.createElement("svg",Object.assign({key:l.id,className:X()(u.highlightBox,{highlighted:l.highlighted})},t,a||n?{}:{onMouseDown:function(e){return!l.locked&&"point"===l.type&&l.highlighted&&0===e.button?r(l):0!==e.button||i?void t.onMouseDown(e):c(l)}},{style:Object(C.a)(Object(C.a)({},l.highlighted?{pointerEvents:"point"!==l.type?"none":void 0,cursor:"grab"}:{cursor:a||n||i?void 0:"pointer",pointerEvents:a||n||i&&!l.highlighted?"none":void 0}),{},{position:"absolute"},d)}),o.a.createElement("path",{d:g}))},Ne=n(702),ke=Object(M.a)("div")({width:8,height:8,zIndex:2,border:"2px solid #FFF",position:"absolute"}),Ae=[["nw-resize","n-resize","ne-resize"],["w-resize","grab","e-resize"],["sw-resize","s-resize","se-resize"]],_e=Object(a.memo)((function(e){var t=e.region,n=e.mouseEvents,i=e.projectRegionBox,r=e.dragWithPrimary,c=e.createWithPrimary,l=e.zoomWithPrimary,s=e.onBeginMovePoint,u=e.onSelectRegion,d=e.layoutParams,g=(e.fullImageSegmentationMode,e.mat),h=e.onBeginBoxTransform,f=e.onBeginMovePolygonPoint,p=e.onBeginMoveKeypoint,b=e.onAddPolygonPoint,y=e.showHighlightBox,O=i(t),v=d.current,E=v.iw,x=v.ih;return o.a.createElement(a.Fragment,null,o.a.createElement(R,null,y&&"polygon"!==t.type&&o.a.createElement(Me,{region:t,mouseEvents:n,dragWithPrimary:r,createWithPrimary:c,zoomWithPrimary:l,onBeginMovePoint:s,onSelectRegion:u,pbox:O}),"box"===t.type&&!r&&!l&&!t.locked&&t.highlighted&&g.a<1.2&&[[0,0],[.5,0],[1,0],[1,.5],[1,1],[.5,1],[0,1],[0,.5],[.5,.5]].map((function(e,a){var i=Object(m.a)(e,2),r=i[0],c=i[1];return o.a.createElement(ke,Object.assign({key:a},n,{onMouseDown:function(e){if(0===e.button)return h(t,[2*r-1,2*c-1]);n.onMouseDown(e)},style:{left:O.x-4-2+O.w*r,top:O.y-4-2+O.h*c,cursor:Ae[2*c][2*r],borderRadius:.5===r&&.5===c?4:void 0}}))})),"polygon"===t.type&&!r&&!l&&!t.locked&&t.highlighted&&t.points.map((function(e,a){var i=Object(m.a)(e,2),r=i[0],c=i[1],l=g.clone().inverse().applyToPoint(r*E,c*x);return o.a.createElement(ke,Object.assign({key:a},n,{onMouseDown:function(e){if(0===e.button&&(!t.open||0===a))return f(t,a);n.onMouseDown(e)},style:{cursor:t.open?0===a?"pointer":void 0:"move",zIndex:10,pointerEvents:t.open&&a===t.points.length-1?"none":void 0,left:l.x-4,top:l.y-4}}))})),"polygon"===t.type&&t.highlighted&&!r&&!l&&!t.locked&&!t.open&&t.points.length>1&&t.points.map((function(e,n){return[e,t.points[(n+1)%t.points.length]]})).map((function(e){var t=Object(m.a)(e,2),n=t[0],a=t[1];return[(n[0]+a[0])/2,(n[1]+a[1])/2]})).map((function(e,a){var i=g.clone().inverse().applyToPoint(e[0]*E,e[1]*x);return o.a.createElement(ke,Object.assign({key:a},n,{onMouseDown:function(o){if(0===o.button)return b(t,e,a+1);n.onMouseDown(o)},style:{cursor:"copy",zIndex:10,left:i.x-4,top:i.y-4,border:"2px dotted #fff",opacity:.5}}))})),"keypoints"===t.type&&!r&&!l&&!t.locked&&t.highlighted&&Object.entries(t.points).map((function(e,a){var i=Object(m.a)(e,2),r=i[0],c=i[1],l=c.x,s=c.y,u=g.clone().inverse().applyToPoint(l*E,s*x);return o.a.createElement(Ne.a,{title:r,key:a},o.a.createElement(ke,Object.assign({key:a},n,{onMouseDown:function(e){if(0===e.button&&(!t.open||0===a))return p(t,r);n.onMouseDown(e)},style:{cursor:t.open?0===a?"pointer":void 0:"move",zIndex:10,pointerEvents:t.open&&a===t.points.length-1?"none":void 0,left:u.x-4,top:u.y-4}})))}))))}),(function(e,t){return e.region===t.region&&e.dragWithPrimary===t.dragWithPrimary&&e.createWithPrimary===t.createWithPrimary&&e.zoomWithPrimary===t.zoomWithPrimary&&e.mat===t.mat})),Le=Object(a.memo)((function(e){return e.regions.filter((function(e){return e.visible||void 0===e.visible})).filter((function(e){return!e.locked})).map((function(t,n){return o.a.createElement(_e,Object.assign({key:t.id},e,{region:t}))}))}),(function(e,t){return e.regions===t.regions&&e.mat===t.mat})),De=Object(a.createContext)({showCrosshairs:!1,showHighlightBox:!0,wasdMode:!0}),Re=function(){return Object(a.useContext)(De)},Pe=function(e){var t=e.children,n=Object(a.useState)((function(){return function(){if(!window||!window.localStorage)return{};for(var e={},t=0;t<window.localStorage.length;t++){var n=window.localStorage.key(t);if(n.startsWith("settings_"))try{e[n.replace("settings_","")]=JSON.parse(window.localStorage.getItem(n))}catch(a){}}return e}()})),i=Object(m.a)(n,2),r=i[0],c=i[1];return o.a.createElement(De.Provider,{value:Object(C.a)(Object(C.a)({},r),{},{changeSetting:function(e,t){c(Object(C.a)(Object(C.a)({},r),{},{[e]:t})),window.localStorage.setItem("settings_".concat(e),JSON.stringify(t))}})},t)},Be=Object(M.a)("video")({zIndex:0,position:"absolute"}),We=Object(M.a)("img")({zIndex:0,position:"absolute"}),ze=Object(M.a)("div")({zIndex:0,position:"absolute",left:0,right:0,bottom:0,top:0,backgroundColor:"rgba(255,0,0,0.2)",color:"#ff0000",fontWeight:"bold",whiteSpace:"pre-wrap",padding:50}),Ge=function(e){var t=e.imagePosition,n=e.mouseEvents,i=e.videoTime,r=e.videoSrc,c=e.imageSrc,l=e.onLoad,s=e.useCrossOrigin,u=void 0!==s&&s,d=e.videoPlaying,g=e.onChangeVideoTime,h=e.onChangeVideoPlaying,f=Re(),p=Object(a.useRef)(),b=Object(a.useRef)(),y=Object(a.useState)(),O=Object(m.a)(y,2),v=O[0],E=O[1];Object(a.useEffect)((function(){!d&&p.current&&(p.current.currentTime=(i||0)/1e3)}),[i]),Object(a.useEffect)((function(){var e=!1;return p.current&&(d?(p.current.play(),e=!0,f.videoPlaybackSpeed&&(p.current.playbackRate=parseFloat(f.videoPlaybackSpeed))):p.current.pause()),function t(){if(e&&p.current){var n=Math.floor(1e3*p.current.currentTime);i!==n&&g(n),p.current.paused&&(e=!1,h(!1)),requestAnimationFrame(t)}}(),function(){e=!1}}),[d]);var x=Object(L.a)((function(e){var t=e.currentTarget;t.currentTime=(i||0)/1e3,l&&l({naturalWidth:t.videoWidth,naturalHeight:t.videoHeight,videoElm:t,duration:t.duration})})),w=Object(L.a)((function(e){var t=e.currentTarget;l&&l({naturalWidth:t.naturalWidth,naturalHeight:t.naturalHeight,imageElm:t})})),j=Object(L.a)((function(e){E("Could not load image\n\nMake sure your image works by visiting ".concat(c||r," in a web browser. If that URL works, the server hosting the URL may be not allowing you to access the image from your current domain. Adjust server settings to enable the image to be viewed.").concat(u?"\n\nYour image may be blocked because it's not being sent with CORs headers. To do pixel segmentation, browser web security requires CORs headers in order for the algorithm to read the pixel data from the image. CORs headers are easy to add if you're using an S3 bucket or own the server hosting your images.":"","\n\n If you need a hand, reach out to the community at universaldatatool.slack.com"))})),I=Object(a.useMemo)((function(){var e=t.bottomRight.x-t.topLeft.x,n=t.bottomRight.y-t.topLeft.y;return{imageRendering:"pixelated",left:t.topLeft.x,top:t.topLeft.y,width:isNaN(e)?0:e,height:isNaN(n)?0:n}}),[t.topLeft.x,t.topLeft.y,t.bottomRight.x,t.bottomRight.y]);return r||c?v?o.a.createElement(ze,null,v):c&&void 0===i?o.a.createElement(We,Object.assign({},n,{src:c,ref:b,style:I,onLoad:w,onError:j,crossOrigin:u?"anonymous":void 0})):o.a.createElement(Be,Object.assign({},n,{ref:p,style:I,onLoadedMetadata:x,src:r||c})):o.a.createElement(ze,null,"No imageSrc or videoSrc provided")},He=n(51),Ve=n.n(He);function Ue(e,t,n){return e<=t?t:e>=n?n:e}for(var Fe={point:Object(a.memo)((function(e){var t=e.region,n=e.iw,a=e.ih;return o.a.createElement("g",{transform:"translate(".concat(t.x*n," ").concat(t.y*a,")")},o.a.createElement("path",{d:"M0 8L8 0L0 -8L-8 0Z",strokeWidth:2,stroke:t.color,fill:"transparent"}))})),line:Object(a.memo)((function(e){var t=e.region,n=e.iw,a=e.ih;return o.a.createElement("g",{transform:"translate(".concat(t.x1*n," ").concat(t.y1*a,")")},o.a.createElement("line",{strokeWidth:2,x1:0,y1:0,x2:(t.x2-t.x1)*n,y2:(t.y2-t.y1)*a,stroke:Ve()(t.color,.75),fill:Ve()(t.color,.25)}))})),box:Object(a.memo)((function(e){var t=e.region,n=e.iw,a=e.ih;return o.a.createElement("g",{transform:"translate(".concat(t.x*n," ").concat(t.y*a,")")},o.a.createElement("rect",{strokeWidth:2,x:0,y:0,width:Math.max(t.w*n,0),height:Math.max(t.h*a,0),stroke:Ve()(t.color,.75),fill:Ve()(t.color,.25)}))})),polygon:Object(a.memo)((function(e){var t=e.region,n=e.iw,a=e.ih,i=(e.fullSegmentationMode,t.open?"polyline":"polygon");return o.a.createElement(i,{points:t.points.map((function(e){var t=Object(m.a)(e,2),o=t[0],i=t[1];return[o*n,i*a]})).map((function(e){return e.join(" ")})).join(" "),strokeWidth:2,stroke:Ve()(t.color,.75),fill:Ve()(t.color,.25)})})),keypoints:function(e){var t=e.region,n=e.iw,a=e.ih,i=e.keypointDefinitions,r=t.points,c=t.keypointsDefinitionId;if(!i[c])throw new Error('No definition for keypoint configuration "'.concat(c,'"'));var l=i[c],s=l.landmarks,u=l.connections;return o.a.createElement("g",null,Object.entries(r).map((function(e,t){var i=Object(m.a)(e,2),r=i[0],c=i[1],l=c.x,u=c.y;return o.a.createElement("g",{key:t,transform:"translate(".concat(l*n," ").concat(u*a,")")},o.a.createElement("path",{d:"M0 8L8 0L0 -8L-8 0Z",strokeWidth:2,stroke:s[r].color,fill:"transparent"}))})),u.map((function(e){var t=Object(m.a)(e,2),i=t[0],c=t[1],l=r[i],u=r[c],d=(l.x+u.x)/2,g=(l.y+u.y)/2;return o.a.createElement("g",{key:"".concat(l.x,",").concat(l.y,".").concat(u.x,",").concat(u.y)},o.a.createElement("line",{x1:l.x*n,y1:l.y*a,x2:d*n,y2:g*a,strokeWidth:2,stroke:s[i].color}),o.a.createElement("line",{x1:u.x*n,y1:u.y*a,x2:d*n,y2:g*a,strokeWidth:2,stroke:s[c].color}))})))},"expanding-line":Object(a.memo)((function(e){var t=e.region,n=e.iw,a=e.ih,i=t.expandingWidth,r=void 0===i?.005:i,c=t.points;r=c.slice(-1)[0].width||r;var l=c.map((function(e,t){var n=e.x,a=e.y,o=e.angle,i=e.width;if(!o){var l=c[Ue(t+1,0,c.length-1)],s=c[Ue(t-1,0,c.length-1)];o=Math.atan2(s.x-l.x,s.y-l.y)+Math.PI/2}var u=Math.sin(o)*(i||r)/2,d=Math.cos(o)*(i||r)/2;return[{x:n+u,y:a+d},{x:n-u,y:a-d}]})),s=l.map((function(e){var t=Object(m.a)(e,2),n=t[0];t[1];return n})),u=l.map((function(e){var t=Object(m.a)(e,2);t[0];return t[1]})).asMutable();u.reverse();var d=c.slice(-1)[0];return o.a.createElement(o.a.Fragment,null,o.a.createElement("polygon",{points:s.concat(t.candidatePoint?[t.candidatePoint]:[]).concat(u).map((function(e){return"".concat(e.x*n," ").concat(e.y*a)})).join(" "),strokeWidth:2,stroke:Ve()(t.color,.75),fill:Ve()(t.color,.25)}),c.map((function(e,i){var r=e.x,c=e.y,l=e.angle;return o.a.createElement("g",{key:i,transform:"translate(".concat(r*n," ").concat(c*a,") rotate(").concat(180*-(l||0)/Math.PI,")")},o.a.createElement("g",null,o.a.createElement("rect",{x:-5,y:-5,width:10,height:10,strokeWidth:2,stroke:Ve()(t.color,.75),fill:Ve()(t.color,.25)})))})),o.a.createElement("rect",{x:d.x*n-8,y:d.y*a-8,width:16,height:16,strokeWidth:4,stroke:Ve()(t.color,.5),fill:"transparent"}))})),pixel:function(){return null}},Ye=Object(a.memo)((function(e){var t=e.regions,n=e.keypointDefinitions,a=e.iw,i=e.ih,r=e.fullSegmentationMode;return t.filter((function(e){return!1!==e.visible})).map((function(e){var t=Fe[e.type];return o.a.createElement(t,{key:e.regionId,region:e,iw:a,ih:i,keypointDefinitions:n,fullSegmentationMode:r})}))}),(function(e,t){return e.regions===t.regions&&e.iw===t.iw&&e.ih===t.ih})),Ke=function(e){e.mat;var t=e.imagePosition,n=e.regions,a=void 0===n?[]:n,i=e.keypointDefinitions,r=e.fullSegmentationMode,c=t.bottomRight.x-t.topLeft.x,l=t.bottomRight.y-t.topLeft.y;return isNaN(c)||isNaN(l)?null:o.a.createElement("svg",{width:c,height:l,style:{position:"absolute",zIndex:2,left:t.topLeft.x,top:t.topLeft.y,pointerEvents:"none",width:c,height:l}},o.a.createElement(Ye,{key:"wrapped-region-list",regions:a,iw:c,ih:l,keypointDefinitions:i,fullSegmentationMode:r}))},Xe=Object(c.a)({canvas:{width:"100%",height:"100%",position:"relative",zIndex:1},zoomIndicator:{position:"absolute",bottom:16,right:0,backgroundColor:"rgba(0,0,0,0.4)",color:"#fff",opacity:.5,fontWeight:"bolder",fontSize:14,padding:4},fixedRegionLabel:{position:"absolute",zIndex:10,top:10,left:10,opacity:.5,transition:"opacity 500ms","&:hover":{opacity:1}}}),Ze=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.iw,a=t.ih,o=k.Matrix.from(1,0,0,1,-10,-10);return e&&n&&(o=o.translate(e.x*n,e.y*a).scaleU(e.w+.05)),o},Je=function(e){var t=e.regions,n=e.imageSrc,i=e.videoSrc,r=e.videoTime,c=e.realSize,l=e.showTags,s=e.onMouseMove,u=void 0===s?function(e){return null}:s,d=e.onMouseDown,g=void 0===d?function(e){return null}:d,h=e.onMouseUp,f=void 0===h?function(e){return null}:h,p=e.dragWithPrimary,b=void 0!==p&&p,y=e.zoomWithPrimary,O=void 0!==y&&y,v=e.createWithPrimary,E=void 0!==v&&v,x=e.pointDistancePrecision,w=void 0===x?0:x,j=e.regionClsList,I=e.regionTagList,T=e.showCrosshairs,S=e.showHighlightBox,M=void 0===S||S,k=e.showPointDistances,_=e.allowedArea,D=e.RegionEditLabel,B=void 0===D?null:D,H=e.videoPlaying,U=void 0!==H&&H,F=e.showMask,Y=void 0===F||F,K=e.fullImageSegmentationMode,X=e.autoSegmentationOptions,Z=e.onImageOrVideoLoaded,J=e.onChangeRegion,q=e.onBeginRegionEdit,$=e.onCloseRegionEdit,Q=e.onBeginBoxTransform,ee=e.onBeginMovePolygonPoint,te=e.onAddPolygonPoint,ne=e.onBeginMoveKeypoint,ae=e.onSelectRegion,oe=e.onBeginMovePoint,re=e.onDeleteRegion,ce=e.onChangeVideoTime,se=e.onChangeVideoPlaying,ue=e.onRegionClassAdded,de=e.zoomOnAllowedArea,ge=void 0===de||de,me=e.modifyingAllowedArea,he=void 0!==me&&me,fe=e.keypointDefinitions,pe=e.allowComments,be=Xe(),ye=Object(a.useRef)(null),Oe=Object(a.useRef)({}),ve=Object(P.a)(!1),Ee=Object(m.a)(ve,2),xe=Ee[0],we=Ee[1],je=Object(P.a)(0),Ie=Object(m.a)(je,2),Te=(Ie[0],Ie[1],Object(P.a)(null)),Se=Object(m.a)(Te,2),Me=Se[0],Ne=Se[1],ke=Object(P.a)(null),Ae=Object(m.a)(ke,2),_e=Ae[0],De=Ae[1],Pe=Object(P.a)(Ze()),Be=Object(m.a)(Pe,2),We=Be[0],ze=Be[1],He=(Object(a.useRef)({}),W());!function(e){var t=e.getLatestMat,n=e.changeMat,o=Re().wasdMode;Object(a.useEffect)((function(){if(o){var e={w:[0,-10],a:[-10,0],s:[0,10],d:[10,0]},a={},i=Object.keys(e),r=function(e){i.includes(e.key)&&(a[e.key]=!0,e.preventDefault(),e.stopPropagation())},c=function(e){i.includes(e.key)&&(a[e.key]=!1,e.preventDefault(),e.stopPropagation())},l=setInterval((function(){var o=t().clone(),i=!1;for(var r in a){var c;if(a[r])o=(c=o).translate.apply(c,Object(N.a)(e[r])),i=!0}i&&n(o)}),16);return window.addEventListener("keydown",r),window.addEventListener("keyup",c),function(){clearInterval(l),window.removeEventListener("keydown",r),window.removeEventListener("keyup",c)}}}),[o])}({getLatestMat:Object(L.a)((function(){return We})),changeMat:ze});var Ve=z({canvasEl:ye,dragging:xe,mat:We,layoutParams:Oe,changeMat:ze,zoomStart:Me,zoomEnd:_e,changeZoomStart:Ne,changeZoomEnd:De,changeDragging:we,zoomWithPrimary:O,dragWithPrimary:b,onMouseMove:u,onMouseDown:g,onMouseUp:f}),Ue=Ve.mouseEvents,Fe=Ve.mousePosition;Object(a.useLayoutEffect)((function(){return ze(We.clone())}),[He]);We.applyToPoint(Fe.current.x,Fe.current.y);var Ye=G({layoutParams:Oe,mat:We}),Je=Object(a.useState)(),qe=Object(m.a)(Je,2),$e=qe[0],Qe=qe[1],et=Boolean($e&&$e.naturalWidth),tt=Object(L.a)((function(e){var t={naturalWidth:e.naturalWidth,naturalHeight:e.naturalHeight,duration:e.duration};Z&&Z(t),Qe(t),setTimeout((function(){return Qe(t)}),10)})),nt=function(){var e=Object(a.useRef)(null);if(null===e.current){e.current={image:new Image,pattern:null};var t=document.createElement("canvas");t.width=100,t.height=100;var n=t.getContext("2d");e.current.image.onload=function(){e.current.pattern=n.createPattern(e.current.image,"repeat")},e.current.image.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAB3RJTUUH4wMSAxY5oG+lzgAAABl0RVh0Q29tbWVudABDcmVhdGVkIHdpdGggR0lNUFeBDhcAAAAcSURBVAjXY/jPwPCfAQnA+TAGugLcAhhakRUAAK3lEe8m9qZhAAAAAElFTkSuQmCC"}return e.current.pattern}(),at=ye.current;if(at&&et){var ot=at.clientWidth,it=at.clientHeight,rt=Math.max($e.naturalWidth/(ot-20),$e.naturalHeight/(it-20)),ct=$e.naturalWidth/rt,lt=$e.naturalHeight/rt;Oe.current={iw:ct,ih:lt,fitScale:rt,canvasWidth:ot,canvasHeight:it}}Object(a.useEffect)((function(){et&&ze(Ze(ge?_:null,Oe.current))}),[et]),Object(a.useLayoutEffect)((function(){if($e){var e=at.clientWidth,t=at.clientHeight;at.width=e,at.height=t;var n=at.getContext("2d");n.save(),n.transform.apply(n,Object(N.a)(We.clone().inverse().toArray()));var a=Oe.current,o=a.iw,i=a.ih;if(_){var r=_.x,c=_.y,l=_.w,s=_.h;n.save(),n.globalAlpha=1;var u=[[0,0],[o,0],[o,i],[0,i]],d=[[r*o,c*i],[r*o+l*o,c*i],[r*o+l*o,c*i+s*i],[r*o,c*i+s*i]];n.moveTo.apply(n,Object(N.a)(u[0])),u.forEach((function(e){return n.lineTo.apply(n,Object(N.a)(e))})),n.lineTo.apply(n,Object(N.a)(u[0])),n.closePath(),d.reverse(),n.moveTo.apply(n,Object(N.a)(d[0])),d.forEach((function(e){return n.lineTo.apply(n,Object(N.a)(e))})),n.lineTo.apply(n,Object(N.a)(d[0])),n.fillStyle=nt||"#f00",n.fill(),n.restore()}n.restore()}}));var st=Oe.current,ut=st.iw,dt=st.ih,gt=Me&&_e?Object(C.a)(Object(C.a)({},We.clone().inverse().applyToPoint(Me.x,Me.y)),{},{w:(_e.x-Me.x)/We.a,h:(_e.y-Me.y)/We.d}):null;gt&&(gt.w<0&&(gt.x+=gt.w,gt.w*=-1),gt.h<0&&(gt.y+=gt.h,gt.h*=-1));var mt={topLeft:We.clone().inverse().applyToPoint(0,0),bottomRight:We.clone().inverse().applyToPoint(ut,dt)},ht=Object(a.useMemo)((function(){var e=t.filter((function(e){return e.highlighted}));return 1!==e.length?null:e[0]}),[t]);return o.a.createElement("div",{style:{width:"100%",height:"100%",maxHeight:"calc(100vh - 68px)",position:"relative",overflow:"hidden",cursor:E?"crosshair":xe?"grabbing":b?"grab":O?We.a<1?"zoom-out":"zoom-in":void 0}},T&&o.a.createElement(A,{key:"crossHairs",mousePosition:Fe}),et&&!xe&&o.a.createElement(Le,{key:"regionSelectAndTransformBoxes",regions:he&&_?[{type:"box",id:"$$allowed_area",cls:"allowed_area",highlighted:!0,x:_.x,y:_.y,w:_.w,h:_.h,visible:!0,color:"#ff0"}]:t,mouseEvents:Ue,projectRegionBox:Ye,dragWithPrimary:b,createWithPrimary:E,zoomWithPrimary:O,onBeginMovePoint:oe,onSelectRegion:ae,layoutParams:Oe,mat:We,onBeginBoxTransform:Q,onBeginMovePolygonPoint:ee,onBeginMoveKeypoint:ne,onAddPolygonPoint:te,showHighlightBox:M}),et&&l&&!xe&&o.a.createElement(R,{key:"regionTags"},o.a.createElement(le,{regions:t,projectRegionBox:Ye,mouseEvents:Ue,regionClsList:j,regionTagList:I,onBeginRegionEdit:q,onChangeRegion:J,onCloseRegionEdit:$,onDeleteRegion:re,layoutParams:Oe,imageSrc:n,RegionEditLabel:B,onRegionClassAdded:ue,allowComments:pe})),!l&&ht&&o.a.createElement("div",{key:"topLeftTag",className:be.fixedRegionLabel},o.a.createElement(ie,{disableClose:!0,allowedClasses:j,allowedTags:I,onChange:J,onDelete:re,editing:!0,region:ht,imageSrc:n,allowComments:pe})),O&&null!==gt&&o.a.createElement("div",{key:"zoomBox",style:{position:"absolute",zIndex:1,border:"1px solid #fff",pointerEvents:"none",left:gt.x,top:gt.y,width:gt.w,height:gt.h}}),k&&o.a.createElement(V,{key:"pointDistances",regions:t,realSize:c,projectRegionBox:Ye,pointDistancePrecision:w}),o.a.createElement(R,Object.assign({style:{width:"100%",height:"100%"}},Ue),o.a.createElement(o.a.Fragment,null,K&&o.a.createElement(Ce,{hide:!Y,autoSegmentationOptions:X,imagePosition:mt,regionClsList:j,imageSrc:n,regions:t}),o.a.createElement("canvas",{style:{opacity:.25},className:be.canvas,ref:ye}),o.a.createElement(Ke,{mat:We,keypointDefinitions:fe,imagePosition:mt,regions:t,fullSegmentationMode:K}),o.a.createElement(Ge,{videoPlaying:U,imagePosition:mt,mouseEvents:Ue,onLoad:tt,videoTime:r,videoSrc:i,imageSrc:n,useCrossOrigin:K,onChangeVideoTime:ce,onChangeVideoPlaying:se}))),o.a.createElement("div",{className:be.zoomIndicator},(1/We.a*100).toFixed(0),"%"))},qe={container:{display:"flex",flexGrow:1,flexDirection:"column",height:"100%",maxHeight:"100vh",backgroundColor:"#fff",overflow:"hidden","&.fullscreen":{position:"absolute",zIndex:99999,left:0,right:0,top:0,bottom:0}},headerTitle:{fontWeight:"bold",color:F.a[700],paddingLeft:16}},$e=n(415),Qe=n.n($e),et=n(416),tt=n.n(et),nt=function(e){var t=e.open,n=e.onClose,a=Re();return o.a.createElement(b.a,{open:t||!1,onClose:n},o.a.createElement(y.a,null,"Settings"),o.a.createElement(O.a,{style:{minWidth:400}},o.a.createElement(tt.a,{variant:"flat",noActions:!0,defaultAnswers:a,onQuestionChange:function(e,t,n){return a.changeSetting(e,t)},form:{questions:[{type:"boolean",title:"Show Crosshairs",name:"showCrosshairs"},{type:"boolean",title:"Show Highlight Box",name:"showHighlightBox"},{type:"boolean",title:"WASD Mode",name:"wasdMode"},{type:"dropdown",title:"Video Playback Speed",name:"videoPlaybackSpeed",defaultValue:"1x",choices:["0.25x","0.5x","1x","2x"]}]}})),o.a.createElement(v.a,null,o.a.createElement(h.a,{onClick:n},"Close")))},at=n(265),ot=function(e){var t,n,a=null;return"image"===e.annotationType?-1===(a=e.selectedImage)?(a=null,n=null):(t=["images",a],n=Object(ne.getIn)(e,t)):"video"===e.annotationType&&(t=["keyframes",e.currentVideoTime||0],n=Object(ne.getIn)(e,t)||null),{currentImageIndex:a,pathToActiveImage:t,activeImage:n}},it=n(73),rt=[],ct=function(e,t){if(e[t||0])return e[t||0].regions;var n=Object.keys(e).map((function(e){return parseInt(e)})).filter((function(e){return!isNaN(e)}));if(0===n.length)return rt;n.sort((function(e,t){return e-t}));var a=n.findIndex((function(e){return e>=t}));if(-1===a)return e[n[n.length-1]].regions||rt;if(0===a)return rt;var o,i=n[a-1],r=e[i],c=n[a],l=e[c],s={},u={},d=Object(it.a)(r.regions);try{for(d.s();!(o=d.n()).done;){var g=o.value;s[g.id]=g}}catch(x){d.e(x)}finally{d.f()}var h,f=Object(it.a)(l.regions);try{for(f.s();!(h=f.n()).done;){var p=h.value;u[p.id]=p}}catch(x){f.e(x)}finally{f.f()}var b=[],y=(c-t)/(c-i),O=1-y,v=function(e){var t=[s[e],u[e]],n=t[0],a=t[1];if(!a)return b.push(Object(C.a)(Object(C.a)({},n),{},{highlighted:!1,editingLabels:!1})),"continue";switch(n.type){case"point":b.push(Object(C.a)(Object(C.a)({},n),{},{highlighted:!1,editingLabels:!1,x:n.x*y+a.x*O,y:n.y*y+a.y*O}));break;case"box":b.push(Object(C.a)(Object(C.a)({},n),{},{highlighted:!1,editingLabels:!1,x:n.x*y+a.x*O,y:n.y*y+a.y*O,w:n.w*y+a.w*O,h:n.h*y+a.h*O}));break;case"polygon":a.points.length===n.points.length?b.push(Object(C.a)(Object(C.a)({},n),{},{highlighted:!1,editingLabels:!1,points:n.points.map((function(e,t){return[e[0]*y+a.points[t][0]*O,e[1]*y+a.points[t][1]*O]}))})):b.push(n);break;case"keypoints":for(var o={},i=0,r=Object.entries(n.points);i<r.length;i++){var c=Object(m.a)(r[i],2),l=c[0],d=c[1];o[l]={x:d.x*y+a.points[l].x*O,y:d.y*y+a.points[l].y*O}}b.push(Object(C.a)(Object(C.a)({},n),{},{highlighted:!1,editingLabels:!1,points:o}))}};for(var E in s)v(E);return b},lt=[],st=n(117),ut={},dt=0,gt=[{id:"select_tool",description:"Switch to the Select Tool",binding:"escape"},{id:"zoom_tool",description:"Select the Zoom Tool",binding:"z"},{id:"create_point",description:"Create a point"},{id:"create_bounding_box",description:"Create a bounding box",binding:"b"},{id:"pan_tool",description:"Select the Pan Tool",binding:"m"},{id:"create_polygon",description:"Create a Polygon",binding:"p"},{id:"create_pixel",description:"Create a Pixel Mask"},{id:"save_and_previous_sample",description:"Save and go to previous sample",binding:"ArrowLeft"},{id:"save_and_next_sample",description:"Save and go to next sample",binding:"ArrowRight"},{id:"save_and_exit_sample",description:"Save and exit current sample"},{id:"exit_sample",description:"Exit sample without saving"},{id:"delete_region",description:"Delete selected region",binding:"d"},{id:"undo",description:"Undo latest change",binding:"Ctrl+z"}];dt<gt.length;dt++){var mt=gt[dt],ht=mt.id,ft=mt.binding;ut[ht]=ft}var pt=function(e){var t=e.dispatch;return Object(a.useMemo)((function(){return{select_tool:function(){t({type:"SELECT_TOOL",selectedTool:"select"})},zoom_tool:function(){t({type:"SELECT_TOOL",selectedTool:"zoom"})},create_point:function(){t({type:"SELECT_TOOL",selectedTool:"create-point"})},create_bounding_box:function(){t({type:"SELECT_TOOL",selectedTool:"create-box"})},pan_tool:function(){t({type:"SELECT_TOOL",selectedTool:"pan"})},create_polygon:function(){t({type:"SELECT_TOOL",selectedTool:"create-polygon"})},create_pixel:function(){t({type:"SELECT_TOOL",selectedTool:"create-pixel"})},save_and_previous_sample:function(){t({type:"HEADER_BUTTON_CLICKED",buttonName:"Prev"})},save_and_next_sample:function(){t({type:"HEADER_BUTTON_CLICKED",buttonName:"Next"})},save_and_exit_sample:function(){t({type:"HEADER_BUTTON_CLICKED",buttonName:"Save"})},delete_region:function(){t({type:"DELETE_SELECTED_REGION"})},undo:function(){t({type:"RESTORE_HISTORY"})}}}),[t])},bt=n(52),yt=n(53),Ot=n(189),vt=n.n(Ot),Et=n(421),xt={marginTop:4,width:16,height:16,marginBottom:4},wt={select:function(){return o.a.createElement(bt.a,{style:xt,size:"xs",fixedWidth:!0,icon:yt.h})},pan:function(){return o.a.createElement(bt.a,{style:xt,size:"xs",fixedWidth:!0,icon:yt.f})},zoom:function(){return o.a.createElement(bt.a,{style:xt,size:"xs",fixedWidth:!0,icon:yt.i})},"show-tags":function(){return o.a.createElement(bt.a,{style:xt,size:"xs",fixedWidth:!0,icon:yt.j})},"create-point":function(){return o.a.createElement(bt.a,{style:xt,size:"xs",fixedWidth:!0,icon:yt.b})},"create-box":function(){return o.a.createElement(bt.a,{style:xt,size:"xs",fixedWidth:!0,icon:yt.k})},"create-polygon":function(){return o.a.createElement(bt.a,{style:xt,size:"xs",fixedWidth:!0,icon:yt.c})},"create-expanding-line":function(){return o.a.createElement(bt.a,{style:xt,size:"xs",fixedWidth:!0,icon:yt.e})},"create-line":function(){return o.a.createElement(bt.a,{style:xt,size:"xs",fixedWidth:!0,icon:yt.a})},"show-mask":function(){return o.a.createElement(bt.a,{style:xt,size:"xs",fixedWidth:!0,icon:yt.g})},"modify-allowed-area":function(){return o.a.createElement(bt.a,{style:xt,size:"xs",fixedWidth:!0,icon:yt.d})},"create-keypoints":n.n(Et).a,window:vt.a},jt=n(258),It=n.n(jt),Tt=n(422),Ct=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(e<1e3)return e+"ms";var n=e/1e3;if(n<60)return Number.isInteger(n)?n+"s":n.toFixed(t)+"s";var a=n/60;return Number.isInteger(a)?a+"m":a.toFixed(t)+"m"},St=Object(M.a)("div")({position:"relative",display:"flex",flexGrow:1,minWidth:240,height:64,marginLeft:16,marginRight:16}),Mt=Object(M.a)("div")({position:"absolute",width:2,marginLeft:-1,height:"100%",backgroundColor:F.a[300],bottom:0}),Nt=Object(M.a)("div")({position:"absolute",userSelect:"none",fontSize:10,color:F.a[600],fontWeight:"bold",bottom:0}),kt=Object(M.a)("div")({position:"absolute",bottom:"calc(50% + 6px)",fontSize:10,fontWeight:"bold",color:"#fff",display:"grid",placeItems:"center",width:48,marginLeft:-24,borderRadius:2,height:24,backgroundColor:ue.a[500],userSelect:"none",fontVariantNumeric:"tabular-nums","&::before":{position:"absolute",bottom:-6,left:16,content:'""',width:0,height:0,borderTop:"8px solid ".concat(ue.a[500]),borderLeft:"8px solid transparent",borderRight:"8px solid transparent"}}),At=Object(M.a)("div")({position:"absolute",bottom:8,cursor:"pointer",opacity:.75,fontSize:10,fontWeight:"bold",color:"#fff",display:"grid",placeItems:"center",width:16,marginLeft:0,borderTopLeftRadius:2,borderTopRightRadius:2,height:12,marginLeft:-8,backgroundColor:se.a[500],userSelect:"none",fontVariantNumeric:"tabular-nums","&::before":{position:"absolute",bottom:-8,left:0,content:'""',width:0,height:0,borderTop:"8px solid ".concat(se.a[500]),borderLeft:"8px solid transparent",borderRight:"8px solid transparent"}}),_t=6e4,Lt=[[50,250],[100,500],[250,1e3],[1e3,5e3],[5e3,3e4],[1e4,_t],[3e4,2*_t],[_t,5*_t],[5*_t,30*_t],[10*_t,60*_t],[30*_t,60*_t*3],[60*_t,60*_t*5]],Dt=function(e){var t=e.currentTime,n=void 0===t?0:t,i=e.duration,r=e.onChangeCurrentTime,c=e.keyframes,l=Object(Tt.a)(),s=Object(m.a)(l,2),u=s[0],d=s[1],g=Object(a.useState)(n),h=Object(m.a)(g,2),f=h[0],p=h[1],b=Object(P.a)(!1),y=Object(m.a)(b,2),O=y[0],v=y[1],E=Object.keys(c||{}).map((function(e){return parseInt(e)})).filter((function(e){return!isNaN(e)})).sort((function(e,t){return e-t}));Object(a.useEffect)((function(){n!==f&&p(n)}),[n]);var x=Object(a.useMemo)((function(){return function(e){var t,n=Object(it.a)(Lt);try{for(n.s();!(t=n.n()).done;){var a=Object(m.a)(t.value,2),o=a[0],i=a[1];if(e/i<6&&e/i>2)return[o,i]}}catch(r){n.e(r)}finally{n.f()}return[e/4,e]}(i)}),[i]),w=Object(m.a)(x,2),j=w[0],I=w[1],T=Object(L.a)((function(e){if(O){var t=(e.clientX-d.left)/d.width;p(Math.min(i,Math.max(0,Math.floor(t*i))))}})),C=Object(L.a)((function(e){v(!1);var t=(e.clientX-d.left)/d.width,n=Math.min(i,Math.max(0,Math.floor(t*i)));p(n),r(n)}));return i?o.a.createElement(St,{onMouseMove:T,onMouseUp:C,ref:u},It()(0,i,I).map((function(e){return o.a.createElement(o.a.Fragment,null,o.a.createElement(Mt,{key:e,style:{left:e/i*d.width,height:"50%"}}),o.a.createElement(Nt,{style:{left:e/i*d.width+8,bottom:"calc(50% - 12px)"}},Ct(e)))})),It()(0,i,j).filter((function(e){return!Number.isInteger(e/I)})).map((function(e){return o.a.createElement(Mt,{key:e,style:{left:e/i*d.width,height:"25%"}})})),E.map((function(e){return o.a.createElement(At,{onClick:function(){return r(e)},key:e,style:{left:e/i*d.width}})})),o.a.createElement(kt,{onMouseDown:function(e){return v(!0)},style:{cursor:O?"grabbing":"grab",left:f/i*d.width}},Ct(f))):null},Rt=n(447),Pt=n(427),Bt=Object(c.a)({container:{margin:8},header:{display:"flex",flexDirection:"row",alignItems:"center",padding:8,paddingLeft:16,paddingRight:16},title:{fontSize:14,fontWeight:"bold",flexGrow:1,paddingLeft:8,color:F.a[800],"& span":{color:F.a[600],fontSize:12}},expandButton:{padding:0,width:30,height:30,"& .icon":{marginTop:-6,width:20,height:20,transition:"500ms transform","&.expanded":{transform:"rotate(180deg)"}}},expandedContent:{maxHeight:300,overflowY:"auto","&.noScroll":{overflowY:"visible",overflow:"visible"}}}),Wt=Object(a.memo)((function(e){var t=e.icon,n=e.title,i=(e.subTitle,e.children),r=e.noScroll,c=void 0!==r&&r,l=e.expandedByDefault,s=void 0!==l&&l,u=Bt(),d=(X()(u.expandedContent,c&&"noScroll"),Object(a.useState)(s)),g=Object(m.a)(d,2),h=g[0],f=g[1];Object(L.a)((function(){return f(!h)}));return o.a.createElement(Pt.a,{icon:t,title:n},i)}),(function(e,t){return e.title===t.title&&e.children===t.children})),zt=function(e){var t=e.state,n=e.lastAction,a=(t.images||[])[t.selectedImage],i=a?(a.regions||[]).filter((function(e){return e.highlighted})):null;return o.a.createElement(Wt,{title:"Debug",icon:o.a.createElement("span",null),expandedByDefault:!0},o.a.createElement("div",{style:{padding:4}},o.a.createElement("div",null,o.a.createElement("b",null,"region"),":"),o.a.createElement("pre",null,JSON.stringify(i,null,"  ")),o.a.createElement("div",null,o.a.createElement("b",null,"lastAction"),":"),o.a.createElement("pre",null,JSON.stringify(n,null,"  ")),o.a.createElement("div",null,o.a.createElement("b",null,"mode"),":"),o.a.createElement("pre",null,JSON.stringify(t.mode,null,"  ")),o.a.createElement("div",null,o.a.createElement("b",null,"frame:")),o.a.createElement("pre",null,JSON.stringify(t.selectedImageFrameTime,null,"  "))))},Gt=n(430),Ht=n.n(Gt),Vt=(Object(c.a)({}),[]),Ut=function(){return null},Ft=Object(a.memo)((function(e){var t=e.currentImage,n=e.imageClsList,i=void 0===n?Vt:n,r=e.imageTagList,c=void 0===r?Vt:r,l=e.onChangeImage,s=void 0===l?Ut:l,u=t||{},d=u.tags,g=void 0===d?[]:d,m=u.cls,h=void 0===m?null:m,p=Object(L.a)((function(e){return s({cls:e.value})})),b=Object(L.a)((function(e){return s({tags:e.map((function(e){return e.value}))})})),y=Object(a.useMemo)((function(){return h?{value:h,label:h}:null}),[h]),O=Object(a.useMemo)((function(){return Object(ne.asMutable)(i.map((function(e){return{value:e,label:e}})))}),[i]),v=Object(a.useMemo)((function(){return Object(ne.asMutable)(c.map((function(e){return{value:e,label:e}})))}),[c]),E=Object(a.useMemo)((function(){return g.map((function(e){return{value:e,label:e}}))}),[g]);return t?o.a.createElement(Wt,{title:"Image Tags",expandedByDefault:!0,noScroll:!0,icon:o.a.createElement(Ht.a,{style:{color:F.a[700]}})},i.length>0&&o.a.createElement("div",{style:{padding:8}},o.a.createElement(f.default,{placeholder:"Image Classification",onChange:p,value:y,options:O})),c.length>0&&o.a.createElement("div",{style:{padding:8,paddingTop:0}},o.a.createElement(f.default,{isMulti:!0,placeholder:"Image Tags",onChange:b,value:E,options:v}))):null}),(function(e,t){return e.currentImage.cls===t.currentImage.cls&&e.currentImage.tags===t.currentImage.tags&&e.imageClsList===t.imageClsList&&e.imageTagList===t.imageTagList})),Yt=n(431),Kt=n.n(Yt),Xt=Object(M.a)("div")({cursor:"pointer",display:"flex",alignItems:"center",padding:8,fontSize:14,color:F.a[700],"&.current":{backgroundColor:ue.a[100]},"&:hover":{backgroundColor:F.a[100]},"& .time":{flexGrow:1,fontWeight:"bold","& .regionCount":{marginLeft:8,fontWeight:"normal",color:F.a[500]}},"& .trash":{"& .icon":{fontSize:18,color:F.a[600],transition:"transform 80ms","&:hover":{color:F.a[800],transform:"scale(1.25,1.25)"}}}}),Zt=function(e){var t=e.currentVideoTime,n=e.keyframes,a=e.onChangeVideoTime,i=e.onDeleteKeyframe,r=Object.keys(n).map((function(e){return parseInt(e)}));return o.a.createElement(Wt,{title:"Keyframes",subTitle:"",icon:o.a.createElement(Kt.a,{style:{color:F.a[700]}}),expandedByDefault:!0},r.map((function(e){var r;return o.a.createElement(Xt,{fullWidth:!0,key:e,className:t===e?"current":"",onClick:function(){return a(e)}},o.a.createElement("div",{className:"time"},Ct(e,2),o.a.createElement("span",{className:"regionCount"},"(",((null===(r=n[e])||void 0===r?void 0:r.regions)||[]).length,")")),o.a.createElement("div",{className:"trash"},o.a.createElement(q.a,{onClick:function(t){i(e),t.stopPropagation()},className:"icon"})))})))},Jt=n(432),qt=n.n(Jt),$t=n(191),Qt=n.n($t),en=Object(M.a)("div")({paddingLeft:16,paddingRight:16,fontSize:12,"& h1":{fontSize:18},"& h2":{fontSize:14},"& h3":{fontSize:12},"& h4":{fontSize:12},"& h5":{fontSize:12},"& h6":{fontSize:12},"& p":{fontSize:12},"& a":{},"& img":{width:"100%"}}),tn=Object(a.memo)((function(e){var t=e.description;return o.a.createElement(Wt,{title:"Task Description",icon:o.a.createElement(qt.a,{style:{color:F.a[700]}}),expandedByDefault:!t||""===t},o.a.createElement(en,null,o.a.createElement(Qt.a,{source:t})))})),nn=n(437),an=n.n(nn),on=n(900),rn=n(433),cn=n.n(rn),ln=n(434),sn=n.n(ln),un=n(435),dn=n.n(un),gn=n(262),mn=n.n(gn),hn=n(436),fn=n.n(hn),pn={container:{fontSize:11,fontWeight:"bold",color:F.a[700],"& .icon":{marginTop:4,width:16,height:16},"& .icon2":{opacity:.5,width:16,height:16,transition:"200ms opacity","&:hover":{cursor:"pointer",opacity:1}}},row:{padding:4,cursor:"pointer","&.header:hover":{backgroundColor:"#fff"},"&.highlighted":{backgroundColor:ue.a[100]},"&:hover":{backgroundColor:ue.a[50],color:F.a[800]}},chip:{display:"flex",flexDirection:"row",padding:2,borderRadius:2,paddingLeft:4,paddingRight:4,alignItems:"center","& .color":{borderRadius:5,width:10,height:10,marginRight:4},"& .text":{}}},bn=n(64),yn=n.n(bn),On=Object(c.a)(pn),vn=Object(M.a)("div")({borderTop:"1px solid ".concat(F.a[200]),marginTop:2,marginBottom:2}),En=function(e){var t=e.color,n=e.text,a=On();return o.a.createElement("span",{className:a.chip},o.a.createElement("div",{className:"color",style:{backgroundColor:t}}),o.a.createElement("div",{className:"text"},n))},xn=function(e){var t=e.header,n=e.highlighted,i=e.order,r=e.classification,c=e.area,l=(e.tags,e.trash),s=e.lock,u=e.visible,d=e.onClick,g=On(),h=Object(a.useState)(!1),f=Object(m.a)(h,2),p=(f[0],f[1]);return o.a.createElement("div",{onClick:d,onMouseEnter:function(){return p(!0)},onMouseLeave:function(){return p(!1)},className:X()(g.row,{header:t,highlighted:n})},o.a.createElement(on.a,{container:!0,alignItems:"center"},o.a.createElement(on.a,{item:!0,xs:2},o.a.createElement("div",{style:{textAlign:"right",paddingRight:10}},i)),o.a.createElement(on.a,{item:!0,xs:5},r),o.a.createElement(on.a,{item:!0,xs:2},o.a.createElement("div",{style:{textAlign:"right",paddingRight:6}},c)),o.a.createElement(on.a,{item:!0,xs:1},l),o.a.createElement(on.a,{item:!0,xs:1},s),o.a.createElement(on.a,{item:!0,xs:1},u)))},wn=Object(a.memo)((function(){return o.a.createElement(xn,{header:!0,highlighted:!1,order:o.a.createElement(cn.a,{className:"icon"}),classification:o.a.createElement("div",{style:{paddingLeft:10}},"Class"),area:o.a.createElement(sn.a,{className:"icon"}),trash:o.a.createElement(q.a,{className:"icon"}),lock:o.a.createElement(ce.a,{className:"icon"}),visible:o.a.createElement(mn.a,{className:"icon"})})})),jn=Object(a.memo)((function(e){var t=e.region,n=e.highlighted,a=e.onSelectRegion,i=e.onDeleteRegion,r=e.onChangeRegion,c=(e.visible,e.locked,e.color),l=e.cls,s=e.index;return o.a.createElement(xn,{header:!1,highlighted:n,onClick:function(){return a(t)},order:"#".concat(s+1),classification:o.a.createElement(En,{text:l||"",color:c||"#ddd"}),area:"",trash:o.a.createElement(q.a,{onClick:function(){return i(t)},className:"icon2"}),lock:t.locked?o.a.createElement(ce.a,{onClick:function(){return r(Object(C.a)(Object(C.a)({},t),{},{locked:!1}))},className:"icon2"}):o.a.createElement(dn.a,{onClick:function(){return r(Object(C.a)(Object(C.a)({},t),{},{locked:!0}))},className:"icon2"}),visible:t.visible||void 0===t.visible?o.a.createElement(mn.a,{onClick:function(){return r(Object(C.a)(Object(C.a)({},t),{},{visible:!1}))},className:"icon2"}):o.a.createElement(fn.a,{onClick:function(){return r(Object(C.a)(Object(C.a)({},t),{},{visible:!0}))},className:"icon2"})})}),(function(e,t){return e.highlighted===t.highlighted&&e.visible===t.visible&&e.locked===t.locked&&e.id===t.id&&e.index===t.index&&e.cls===t.cls&&e.color===t.color})),In=[],Tn=function(e){return[e.id,e.color,e.locked,e.visible,e.highlighted]},Cn=Object(a.memo)((function(e){var t=e.regions,n=void 0===t?In:t,a=e.onDeleteRegion,i=e.onChangeRegion,r=e.onSelectRegion,c=On();return o.a.createElement(Wt,{title:"Regions",subTitle:"",icon:o.a.createElement(an.a,{style:{color:F.a[700]}}),expandedByDefault:!0},o.a.createElement("div",{className:c.container},o.a.createElement(wn,null),o.a.createElement(vn,null),n.map((function(e,t){return o.a.createElement(jn,Object.assign({key:e.id},e,{region:e,index:t,onSelectRegion:r,onDeleteRegion:a,onChangeRegion:i}))}))))}),(function(e,t){return yn()((e.regions||In).map(Tn),(t.regions||In).map(Tn))})),Sn=n(438),Mn=n.n(Sn),Nn=n(411),kn=n(418),An=n(225),_n=Object(c.a)({img:{width:40,height:40,borderRadius:8}}),Ln=function(e){return[e.name,(e.regions||[]).length,e.src]},Dn=(Object(a.memo)((function(e){var t=e.images,n=e.onSelect,a=_n();return o.a.createElement(Wt,{title:"Images",subTitle:"(".concat(t.length,")"),icon:o.a.createElement(Mn.a,{style:{color:F.a[700]}})},o.a.createElement("div",null,o.a.createElement(Nn.a,null,t.map((function(e,t){return o.a.createElement(kn.a,{button:!0,onClick:function(){return n(e)},dense:!0,key:t},o.a.createElement("img",{className:a.img,src:e.src}),o.a.createElement(An.a,{primary:e.name,secondary:"".concat((e.regions||[]).length," Labels")}))})))))}),(function(e,t){return yn()(e.images.map(Ln),t.images.map(Ln))})),n(439)),Rn=n.n(Dn),Pn=n(901),Bn=n(440),Wn=n.n(Bn),zn=n(118),Gn=n.n(zn),Hn=Object(c.a)({emptyText:{fontSize:14,fontWeight:"bold",color:F.a[500],textAlign:"center",padding:20}}),Vn={paddingLeft:16},Un=Object(a.memo)((function(e){var t=e.history,n=e.onRestoreHistory,a=Hn();return o.a.createElement(Wt,{title:"History",icon:o.a.createElement(Rn.a,{style:{color:F.a[700]}}),expandedByDefault:!0},o.a.createElement(Nn.a,null,0===t.length&&o.a.createElement("div",{className:a.emptyText},"No History Yet"),t.map((function(e,t){var a=e.name,i=e.time;return o.a.createElement(kn.a,{button:!0,dense:!0,key:t},o.a.createElement(An.a,{style:Vn,primary:a,secondary:Gn()(i).format("LT")}),0===t&&o.a.createElement(Pn.a,{onClick:function(){return n()}},o.a.createElement(Z.a,null,o.a.createElement(Wn.a,null))))}))))}),(function(e,t){return yn()(e.history.map((function(e){return[e.name,e.time]})),t.history.map((function(e){return[e.name,e.time]})))})),Fn=function(e){var t,n,a,o=null===(t=Object(st.getApplicationKeyMap)()[e])||void 0===t||null===(n=t.sequences)||void 0===n||null===(a=n[0])||void 0===a?void 0:a.sequence;return o?" (".concat(o,")"):""},Yn=n(1103),Kn=n(442),Xn=n.n(Kn),Zn=n(441),Jn=n.n(Zn),qn=Object(M.a)("div")({display:"flex",paddingTop:4,paddingBottom:4,paddingLeft:16,paddingRight:16,alignItems:"center",cursor:"pointer",opacity:.7,backgroundColor:"#fff","&:hover":{opacity:1},"&.selected":{opacity:1,fontWeight:"bold"}}),$n=Object(M.a)("div")({width:12,height:12,borderRadius:12,marginRight:8}),Qn=Object(M.a)("div")({fontSize:11}),ea=Object(M.a)("div")({flexGrow:1,borderBottom:"2px dotted ".concat(F.a[300]),marginLeft:8,marginRight:8}),ta=Object(M.a)("div")({fontSize:11,textAlign:"center",minWidth:14,paddingTop:2,paddingBottom:2,fontWeight:"bold",color:F.a[700]}),na=function(e){var t=e.selectedCls,n=e.regionClsList,i=e.onSelectCls;return Object(a.useEffect)((function(){for(var e={},t=function(t){e[t+1]=function(){return i(n[t])}},a=0;a<9&&a<n.length;a++)t(a);var o=function(t){e[t.key]&&(e[t.key](),t.preventDefault(),t.stopPropagation())};return window.addEventListener("keydown",o),function(){return window.removeEventListener("keydown",o)}}),[n,t]),o.a.createElement(Wt,{title:"Classifications",subTitle:"",icon:o.a.createElement(Xn.a,{style:{color:F.a[700]}}),expandedByDefault:!0},n.map((function(e,n){return o.a.createElement(qn,{className:X()({selected:e===t}),onClick:function(){return i(e)}},o.a.createElement($n,{style:{backgroundColor:xe[n%xe.length]}}),o.a.createElement(Qn,{className:X()({selected:e===t})},Jn()(e)),o.a.createElement(ea,null),o.a.createElement(ta,{className:X()({selected:e===t})},n<9?"Key [".concat(n+1,"]"):""))})),o.a.createElement(Yn.a,{pb:2}))},aa=[],oa=Object(c.a)(qe),ia=Object(st.withHotKeys)((function(e){var t=e.hotKeys,n=e.children,a=e.divRef,i=Object(S.a)(e,["hotKeys","children","divRef"]);return o.a.createElement("div",Object.assign({},Object(C.a)(Object(C.a)({},t),i),{ref:a}),n)})),ra=Object(M.a)("div")({width:"100%",height:"100%","& .fullscreen":{width:"100%",height:"100%"}}),ca=function(e){var t,n=e.state,i=e.dispatch,r=(e.alwaysShowNextButton,e.alwaysShowPrevButton,e.RegionEditLabel),c=e.onRegionClassAdded,l=e.hideHeader,s=e.hideHeaderText,u=e.hideNext,d=void 0!==u&&u,g=e.hidePrev,m=void 0!==g&&g,h=oa(),f=Re(),p=Object(at.b)(),b=Object(a.useRef)({}),y=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];var o="".concat(e,"(").concat(n.join(","),")");if(b.current[o])return b.current[o];var r=function(){for(var t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];return n.length>0?i(Object(C.a)({type:e},n.reduce((function(e,t,n){return e[t]=a[n],e}),{}))):i(Object(C.a)({type:e},a[0]))};return b.current[o]=r,r},O=ot(n),v=O.currentImageIndex,E=O.activeImage;null!==v&&(t=n.images[v+1]),Qe()((function(){return i({type:"CANCEL"})}),{detectKeys:[27]});E&&E.frameTime;var x=Object(a.useRef)(),w=pt({dispatch:i}),j=function(e){if("video"!==e.annotationType)return lt;var t=e.keyframes,n=e.currentVideoTime,o=void 0===n?0:n;return Object(a.useMemo)((function(){return ct(t,o)}),[t,o])}(n),I=Object(a.useCallback)((function(e){x.current&&(x.current.contains(document.activeElement)||x.current.contains(e.target)&&(x.current.focus(),e.target.focus()))}),[]),T=o.a.createElement(Je,Object.assign({},f,{showCrosshairs:f.showCrosshairs&&!["select","pan","zoom"].includes(n.selectedTool),key:n.selectedImage,showMask:n.showMask,fullImageSegmentationMode:n.fullImageSegmentationMode,autoSegmentationOptions:n.autoSegmentationOptions,showTags:n.showTags,allowedArea:n.allowedArea,modifyingAllowedArea:"modify-allowed-area"===n.selectedTool,regionClsList:n.regionClsList,regionTagList:n.regionTagList,regions:"image"===n.annotationType?E.regions||[]:j,realSize:E?E.realSize:void 0,videoPlaying:n.videoPlaying,imageSrc:"image"===n.annotationType?E.src:null,videoSrc:"video"===n.annotationType?n.videoSrc:null,pointDistancePrecision:n.pointDistancePrecision,createWithPrimary:n.selectedTool.includes("create"),dragWithPrimary:"pan"===n.selectedTool,zoomWithPrimary:"zoom"===n.selectedTool,showPointDistances:n.showPointDistances,videoTime:"image"===n.annotationType?n.selectedImageFrameTime:n.currentVideoTime,keypointDefinitions:n.keypointDefinitions,onMouseMove:y("MOUSE_MOVE"),onMouseDown:y("MOUSE_DOWN"),onMouseUp:y("MOUSE_UP"),onChangeRegion:y("CHANGE_REGION","region"),onBeginRegionEdit:y("OPEN_REGION_EDITOR","region"),onCloseRegionEdit:y("CLOSE_REGION_EDITOR","region"),onDeleteRegion:y("DELETE_REGION","region"),onBeginBoxTransform:y("BEGIN_BOX_TRANSFORM","box","directions"),onBeginMovePolygonPoint:y("BEGIN_MOVE_POLYGON_POINT","polygon","pointIndex"),onBeginMoveKeypoint:y("BEGIN_MOVE_KEYPOINT","region","keypointId"),onAddPolygonPoint:y("ADD_POLYGON_POINT","polygon","point","pointIndex"),onSelectRegion:y("SELECT_REGION","region"),onBeginMovePoint:y("BEGIN_MOVE_POINT","point"),onImageLoaded:y("IMAGE_LOADED","image"),RegionEditLabel:r,onImageOrVideoLoaded:y("IMAGE_OR_VIDEO_LOADED","metadata"),onChangeVideoTime:y("CHANGE_VIDEO_TIME","newTime"),onChangeVideoPlaying:y("CHANGE_VIDEO_PLAYING","isPlaying"),onRegionClassAdded:c,allowComments:n.allowComments})),S=Object(L.a)((function(e){i({type:"SELECT_TOOL",selectedTool:e.name})})),M=Object(L.a)((function(e){"Fullscreen"===e.name?p.enter():"Window"===e.name&&p.exit(),i({type:"HEADER_BUTTON_CLICKED",buttonName:e.name})})),N=Boolean(window.localStorage.$ANNOTATE_DEBUG_MODE&&n),k=!t||t.regions&&t.regions.length>0;return o.a.createElement(ra,null,o.a.createElement(at.a,{handle:p,onChange:function(e){e||(p.exit(),y("HEADER_BUTTON_CLICKED","buttonName")("Window"))}},o.a.createElement(ia,{tabIndex:-1,divRef:x,onMouseDown:I,onMouseOver:I,allowChanges:!0,handlers:w,className:X()(h.container,n.fullScreen&&"Fullscreen")},o.a.createElement(Rt.a,{allowFullscreen:!0,iconDictionary:wt,hideHeader:l,hideHeaderText:s,headerLeftSide:["video"===n.annotationType?o.a.createElement(Dt,{currentTime:n.currentVideoTime,duration:n.videoDuration,onChangeCurrentTime:y("CHANGE_VIDEO_TIME","newTime"),keyframes:n.keyframes}):E?o.a.createElement("div",{className:h.headerTitle},E.name):null].filter(Boolean),headerItems:[!m&&{name:"Prev"},!d&&{name:"Next"},"video"!==n.annotationType?null:n.videoPlaying?{name:"Pause"}:{name:"Play"},!k&&E.regions&&{name:"Clone"},{name:"Settings"},n.fullScreen?{name:"Window"}:{name:"Fullscreen"},{name:"Save"}].filter(Boolean),onClickHeaderItem:M,onClickIconSidebarItem:S,selectedTools:[n.selectedTool,n.showTags&&"show-tags",n.showMask&&"show-mask"].filter(Boolean),iconSidebarItems:[{name:"select",helperText:"Select"+Fn("select_tool"),alwaysShowing:!0},{name:"pan",helperText:"Drag/Pan (right or middle click)"+Fn("pan_tool"),alwaysShowing:!0},{name:"zoom",helperText:"Zoom In/Out (scroll)"+Fn("zoom_tool"),alwaysShowing:!0},{name:"show-tags",helperText:"Show / Hide Tags",alwaysShowing:!0},{name:"create-point",helperText:"Add Point"+Fn("create_point")},{name:"create-box",helperText:"Add Bounding Box"+Fn("create_bounding_box")},{name:"create-polygon",helperText:"Add Polygon"+Fn("create_polygon")},{name:"create-line",helperText:"Add Line"},{name:"create-expanding-line",helperText:"Add Expanding Line"},{name:"create-keypoints",helperText:"Add Keypoints (Pose)"},n.fullImageSegmentationMode&&{name:"show-mask",alwaysShowing:!0,helperText:"Show / Hide Mask"},{name:"modify-allowed-area",helperText:"Modify Allowed Area"}].filter(Boolean).filter((function(e){return e.alwaysShowing||n.enabledTools.includes(e.name)})),rightSidebarItems:[N&&o.a.createElement(zt,{state:N,lastAction:n.lastAction}),n.taskDescription&&o.a.createElement(tn,{description:n.taskDescription}),n.regionClsList&&o.a.createElement(na,{selectedCls:n.selectedCls,regionClsList:n.regionClsList,onSelectCls:y("SELECT_CLASSIFICATION","cls")}),n.labelImages&&o.a.createElement(Ft,{currentImage:E,imageClsList:n.imageClsList,imageTagList:n.imageTagList,onChangeImage:y("CHANGE_IMAGE","delta"),expandedByDefault:!0}),o.a.createElement(Cn,{regions:E?E.regions:aa,onSelectRegion:y("SELECT_REGION","region"),onDeleteRegion:y("DELETE_REGION","region"),onChangeRegion:y("CHANGE_REGION","region")}),n.keyframes&&o.a.createElement(Zt,{onChangeVideoTime:y("CHANGE_VIDEO_TIME","newTime"),onDeleteKeyframe:y("DELETE_KEYFRAME","time"),onChangeCurrentTime:y("CHANGE_VIDEO_TIME","newTime"),currentTime:n.currentVideoTime,duration:n.videoDuration,keyframes:n.keyframes}),o.a.createElement(Un,{history:n.history,onRestoreHistory:y("RESTORE_HISTORY")})].filter(Boolean)},T),o.a.createElement(nt,{open:n.settingsOpen,onClose:function(){return i({type:"HEADER_BUTTON_CLICKED",buttonName:"Settings"})}}))))},la={BEGIN_BOX_TRANSFORM:"Transform/Move Box",BEGIN_MOVE_POINT:"Move Point",DELETE_REGION:"Delete Region"},sa=function(e,t){return Object(ne.updateIn)(e,["history"],(function(n){return[{time:Gn()().toDate(),state:Object(ne.without)(e,"history"),name:t}].concat((n||[]).slice(0,9))}))};function ua(e,t,n){return e<=t?t:e>=n?n:e}var da=function(e){var t=e.expandingWidth||.005,n=e.points.map((function(n,a){var o=n.x,i=n.y,r=n.angle,c=n.width;if(!r){var l=e.points[ua(a+1,0,e.points.length-1)],s=e.points[ua(a-1,0,e.points.length-1)];r=Math.atan2(s.x-l.x,s.y-l.y)+Math.PI/2}var u=Math.sin(r)*(c||t)/2,d=Math.cos(r)*(c||t)/2;return[{x:o+u,y:i+d},{x:o-u,y:i-d}]})),a=n.map((function(e){var t=Object(m.a)(e,2),n=t[0];t[1];return n})),o=n.map((function(e){var t=Object(m.a)(e,2);t[0];return t[1]})).asMutable();o.reverse();var i=a.concat(o).map((function(e){return[e.x,e.y]}));return Object(C.a)(Object(C.a)({},e),{},{type:"polygon",open:!1,points:i,unfinished:void 0,candidatePoint:void 0})},ga=n(263),ma=n.n(ga),ha=function(e){var t,n=e.center,a=e.scale,o=e.landmarks,i={},r=Object(it.a)(Object.entries(o));try{for(r.s();!(t=r.n()).done;){var c=Object(m.a)(t.value,2),l=c[0],s=c[1].defaultPosition;i[l]={x:s[0]*a+n.x,y:s[1]*a+n.y}}}catch(u){r.e(u)}finally{r.f()}return i},fa=function(){return Math.random().toString().split(".")[1]},pa=function(e,t){if(e.allowedArea&&"modify-allowed-area"!==e.selectedTool&&["MOUSE_DOWN","MOUSE_UP","MOUSE_MOVE"].includes(t.type)){var n=e.allowedArea;t.x=ma()(t.x,n.x,n.x+n.w),t.y=ma()(t.y,n.y,n.y+n.h)}if("ON_CLS_ADDED"===t.type&&t.cls&&""!==t.cls){var a=e.regionClsList;return Object(C.a)(Object(C.a)({},e),{},{regionClsList:a.concat(t.cls)})}if("MOUSE_MOVE"===t.type){if(Date.now()-(e.lastMouseMoveCall||0)<16)return e;e=Object(ne.setIn)(e,["lastMouseMoveCall"],Date.now())}t.type.includes("MOUSE")||(e=Object(ne.setIn)(e,["lastAction"],t));var o=ot(e),i=o.currentImageIndex,r=o.pathToActiveImage,c=o.activeImage,l=function(e){var t="string"===typeof e||"number"===typeof e?e:e.id;if(!c)return null;var n=(c.regions||[]).findIndex((function(e){return e.id===t}));return-1===n?null:n},s=function(e){if(!c)return null;var t=l(e);return null===t?[null,null]:[c.regions[t],t]},u=function(t,n){var a=s(t),o=Object(m.a)(a,2),i=o[0],l=o[1];if(!i)return e;if(null!==n)return Object(ne.setIn)(e,[].concat(Object(N.a)(r),["regions",l]),Object(C.a)(Object(C.a)({},i),n));var u=c.regions;return Object(ne.setIn)(e,[].concat(Object(N.a)(r),["regions"]),(u||[]).filter((function(e){return e.id!==i.id})))},d=function(e){return null===i?e:Object(ne.setIn)(e,[].concat(Object(N.a)(r),["regions"]),(c.regions||[]).map((function(e){return Object(C.a)(Object(C.a)({},e),{},{editingLabels:!1})})))},g=function(t,n){var a="object"===typeof t?t:{src:t},o=(a.src,a.frameTime);return Object(ne.setIn)(Object(ne.setIn)(e,["selectedImage"],n),["selectedImageFrameTime"],o)};switch(t.type){case"@@INIT":return e;case"SELECT_IMAGE":return g(t.image,t.imageIndex);case"SELECT_CLASSIFICATION":return Object(ne.setIn)(e,["selectedCls"],t.cls);case"CHANGE_REGION":var h=l(t.region);if(null===h)return e;var f=c.regions[h];if(f.cls!==t.region.cls){var p=(e=sa(e,"Change Region Classification")).regionClsList.indexOf(t.region.cls);-1!==p&&(e=Object(ne.setIn)(e,["selectedCls"],t.region.cls),t.region.color=xe[p%xe.length])}return yn()(f.tags,t.region.tags)||(e=sa(e,"Change Region Tags")),yn()(f.comment,t.region.comment)||(e=sa(e,"Change Region Comment")),Object(ne.setIn)(e,[].concat(Object(N.a)(r),["regions",h]),t.region);case"CHANGE_IMAGE":if(!c)return e;for(var b=t.delta,y=0,O=Object.keys(b);y<O.length;y++){var v=O[y];"cls"===v&&sa(e,"Change Image Class"),"tags"===v&&sa(e,"Change Image Tags"),e=Object(ne.setIn)(e,[].concat(Object(N.a)(r),[v]),b[v])}return e;case"SELECT_REGION":var E=t.region;if(null===l(t.region))return e;var x=Object(N.a)(c.regions||[]).map((function(e){return Object(C.a)(Object(C.a)({},e),{},{highlighted:e.id===E.id,editingLabels:e.id===E.id})}));return Object(ne.setIn)(e,[].concat(Object(N.a)(r),["regions"]),x);case"BEGIN_MOVE_POINT":return e=d(e),Object(ne.setIn)(e,["mode"],{mode:"MOVE_REGION",regionId:t.point.id});case"BEGIN_BOX_TRANSFORM":var w=t.box,j=t.directions;return e=d(e),0===j[0]&&0===j[1]?Object(ne.setIn)(e,["mode"],{mode:"MOVE_REGION",regionId:w.id}):Object(ne.setIn)(e,["mode"],{mode:"RESIZE_BOX",regionId:w.id,freedom:j,original:{x:w.x,y:w.y,w:w.w,h:w.h}});case"BEGIN_MOVE_POLYGON_POINT":var I=t.polygon,T=t.pointIndex;return(e=d(e)).mode&&"DRAW_POLYGON"===e.mode.mode&&0===T?Object(ne.setIn)(u(I,{points:I.points.slice(0,-1),open:!1}),["mode"],null):(e=sa(e,"Move Polygon Point"),Object(ne.setIn)(e,["mode"],{mode:"MOVE_POLYGON_POINT",regionId:I.id,pointIndex:T}));case"BEGIN_MOVE_KEYPOINT":var S=t.region,M=t.keypointId;return e=d(e),e=sa(e,"Move Keypoint"),Object(ne.setIn)(e,["mode"],{mode:"MOVE_KEYPOINT",regionId:S.id,keypointId:M});case"ADD_POLYGON_POINT":var k=t.polygon,A=t.point,_=t.pointIndex,L=l(k);if(null===L)return e;var D=Object(N.a)(k.points);return D.splice(_,0,A),Object(ne.setIn)(e,[].concat(Object(N.a)(r),["regions",L]),Object(C.a)(Object(C.a)({},k),{},{points:D}));case"MOUSE_MOVE":var R=t.x,P=t.y;if(!e.mode)return e;if(!c)return e;e.mouseDownAt;switch(e.mode.mode){case"MOVE_POLYGON_POINT":var B=e.mode,W=B.pointIndex,z=B.regionId,G=l(z);return null===G?e:Object(ne.setIn)(e,[].concat(Object(N.a)(r),["regions",G,"points",W]),[R,P]);case"MOVE_KEYPOINT":var H=e.mode,V=H.keypointId,U=H.regionId,F=s(U),Y=Object(m.a)(F,2),K=Y[0],X=Y[1];return null===X?e:Object(ne.setIn)(e,[].concat(Object(N.a)(r),["regions",X,"points",V]),Object(C.a)(Object(C.a)({},K.points[V]),{},{x:R,y:P}));case"MOVE_REGION":var Z=e.mode.regionId;if("$$allowed_area"===Z){var J=e.allowedArea,q=J.w,$=J.h;return Object(ne.setIn)(e,["allowedArea"],{x:R-q/2,y:P-$/2,w:q,h:$})}var Q=l(Z);return null===Q?e:Object(ne.setIn)(e,[].concat(Object(N.a)(r),["regions",Q]),function(e,t,n){switch(e.type){case"point":return Object(C.a)(Object(C.a)({},e),{},{x:t,y:n});case"box":return Object(C.a)(Object(C.a)({},e),{},{x:t-e.w/2,y:n-e.h/2})}return e}(c.regions[Q],R,P));case"RESIZE_BOX":var ee=e.mode,te=ee.regionId,ae=Object(m.a)(ee.freedom,2),oe=ae[0],ie=ae[1],re=ee.original,ce=re.x,le=re.y,se=re.w,ue=re.h,de=0===oe?ce:-1===oe?Math.min(ce+se,R):ce,ge=0===oe?se:-1===oe?se+(ce-de):Math.max(0,se+(R-ce-se)),me=0===ie?le:-1===ie?Math.min(le+ue,P):le,he=0===ie?ue:-1===ie?ue+(le-me):Math.max(0,ue+(P-le-ue));if(ge<=.001&&(e=Object(ne.setIn)(e,["mode","freedom"],[-1*oe,ie])),he<=.001&&(e=Object(ne.setIn)(e,["mode","freedom"],[oe,-1*ie])),"$$allowed_area"===te)return Object(ne.setIn)(e,["allowedArea"],{x:de,w:ge,y:me,h:he});var fe=l(te);if(null===fe)return e;var pe=c.regions[fe];return Object(ne.setIn)(e,[].concat(Object(N.a)(r),["regions",fe]),Object(C.a)(Object(C.a)({},pe),{},{x:de,w:ge,y:me,h:he}));case"RESIZE_KEYPOINTS":var be=e.mode,ye=be.regionId,Oe=be.landmarks,ve=be.centerX,Ee=be.centerY,we=Math.sqrt(Math.pow(ve-R,2)+Math.pow(Ee-P,2));return u(ye,{points:ha({landmarks:Oe,center:{x:ve,y:Ee},scale:we/.15})});case"DRAW_POLYGON":var je=e.mode.regionId,Ie=s(je),Te=Object(m.a)(Ie,2),Ce=Te[0],Se=Te[1];return Ce?Object(ne.setIn)(e,[].concat(Object(N.a)(r),["regions",Se,"points",Ce.points.length-1]),[R,P]):Object(ne.setIn)(e,["mode"],null);case"DRAW_LINE":var Me=e.mode.regionId,Ne=s(Me),ke=Object(m.a)(Ne,2),Ae=ke[0],_e=ke[1];return Ae?Object(ne.setIn)(e,[].concat(Object(N.a)(r),["regions",_e]),Object(C.a)(Object(C.a)({},Ae),{},{x2:R,y2:P})):Object(ne.setIn)(e,["mode"],null);case"DRAW_EXPANDING_LINE":var Le=e.mode.regionId,De=s(Le),Re=Object(m.a)(De,2),Pe=Re[0],Be=Re[1];if(!Pe)return e;if(Boolean(e.mouseDownAt)){var We=Pe.points.slice(-1)[0],ze=Math.sqrt(Math.pow(We.x-R,2)+Math.pow(We.y-P,2));return ze<.002&&!We.width?e:Object(ne.setIn)(e,[].concat(Object(N.a)(r),["regions",Be,"points"]),Pe.points.slice(0,-1).concat([Object(C.a)(Object(C.a)({},We),{},{width:2*ze,angle:Math.atan2(We.x-R,We.y-P)})]))}return Object(ne.setIn)(e,[].concat(Object(N.a)(r),["regions",Be]),Object(C.a)(Object(C.a)({},Pe),{},{candidatePoint:{x:R,y:P}}));case"SET_EXPANDING_LINE_WIDTH":var Ge=e.mode.regionId,He=s(Ge),Ve=Object(m.a)(He,2),Ue=Ve[0],Fe=Ve[1];if(!Ue)return e;var Ye=Ue.points.slice(-1)[0];e.mouseDownAt;return Object(ne.setIn)(e,[].concat(Object(N.a)(r),["regions",Fe,"expandingWidth"]),Math.sqrt(Math.pow(Ye.x-R,2)+Math.pow(Ye.y-P,2)));default:return e}case"MOUSE_DOWN":if(!c)return e;var Ke,Xe=t.x,Ze=t.y;if((e=Object(ne.setIn)(e,["mouseDownAt"],{x:Xe,y:Ze})).mode)switch(e.mode.mode){case"DRAW_POLYGON":var Je=s(e.mode.regionId),qe=Object(m.a)(Je,2),$e=qe[0],Qe=qe[1];if(!$e)break;return Object(ne.setIn)(e,[].concat(Object(N.a)(r),["regions",Qe]),Object(C.a)(Object(C.a)({},$e),{},{points:$e.points.concat([[Xe,Ze]])}));case"DRAW_LINE":var et=s(e.mode.regionId),tt=Object(m.a)(et,2),nt=tt[0],at=tt[1];if(!nt)break;return Object(ne.setIn)(e,[].concat(Object(N.a)(r),["regions",at]),Object(C.a)(Object(C.a)({},nt),{},{x2:Xe,y2:Ze})),Object(ne.setIn)(e,["mode"],null);case"DRAW_EXPANDING_LINE":var it=s(e.mode.regionId),rt=Object(m.a)(it,2),ct=rt[0],lt=rt[1];if(!ct)break;var st=ct.points.slice(-1)[0];return ct.points.length>1&&Math.sqrt(Math.pow(st.x-Xe,2)+Math.pow(st.y-Ze,2))<.002?st.width?e.setIn([].concat(Object(N.a)(r),["regions",lt]),da(ct)).setIn(["mode"],null):Object(ne.setIn)(e,["mode"],{mode:"SET_EXPANDING_LINE_WIDTH",regionId:e.mode.regionId}):Object(ne.setIn)(e,[].concat(Object(N.a)(r),["regions",lt,"points"]),ct.points.concat([{x:Xe,y:Ze,angle:null,width:null}]));case"SET_EXPANDING_LINE_WIDTH":var ut=s(e.mode.regionId),dt=Object(m.a)(ut,2),gt=dt[0],mt=dt[1];if(!gt)break;var ht=gt.expandingWidth;return e.setIn([].concat(Object(N.a)(r),["regions",mt]),da(Object(C.a)(Object(C.a)({},gt),{},{points:gt.points.map((function(e){return e.width?e:Object(C.a)(Object(C.a)({},e),{},{width:ht})})),expandingWidth:void 0}))).setIn(["mode"],null)}var ft=e.selectedCls,pt="#ff0000",bt=(e.regionClsList||[]).indexOf(ft);switch(-1!==bt&&(pt=xe[bt%xe.length]),e.selectedTool){case"create-point":e=sa(e,"Create Point"),Ke={type:"point",x:Xe,y:Ze,highlighted:!0,editingLabels:!0,color:pt,id:fa(),cls:ft};break;case"create-box":e=sa(e,"Create Box"),Ke={type:"box",x:Xe,y:Ze,w:0,h:0,highlighted:!0,editingLabels:!1,color:pt,cls:ft,id:fa()},e=Object(ne.setIn)(e,["mode"],{mode:"RESIZE_BOX",editLabelEditorAfter:!0,regionId:Ke.id,freedom:[1,1],original:{x:Xe,y:Ze,w:Ke.w,h:Ke.h},isNew:!0});break;case"create-polygon":if(e.mode&&"DRAW_POLYGON"===e.mode.mode)break;e=sa(e,"Create Polygon"),Ke={type:"polygon",points:[[Xe,Ze],[Xe,Ze]],open:!0,highlighted:!0,color:pt,cls:ft,id:fa()},e=Object(ne.setIn)(e,["mode"],{mode:"DRAW_POLYGON",regionId:Ke.id});break;case"create-expanding-line":e=sa(e,"Create Expanding Line"),Ke={type:"expanding-line",unfinished:!0,points:[{x:Xe,y:Ze,angle:null,width:null}],open:!0,highlighted:!0,color:pt,cls:ft,id:fa()},e=Object(ne.setIn)(e,["mode"],{mode:"DRAW_EXPANDING_LINE",regionId:Ke.id});break;case"create-line":if(e.mode&&"DRAW_LINE"===e.mode.mode)break;e=sa(e,"Create Line"),Ke={type:"line",x1:Xe,y1:Ze,x2:Xe,y2:Ze,highlighted:!0,editingLabels:!1,color:pt,cls:ft,id:fa()},e=Object(ne.setIn)(e,["mode"],{mode:"DRAW_LINE",regionId:Ke.id});break;case"create-keypoints":e=sa(e,"Create Keypoints");var yt=Object.entries(e.keypointDefinitions),Ot=Object(m.a)(yt,1),vt=Object(m.a)(Ot[0],2),Et=vt[0],xt=vt[1],wt=xt.landmarks;xt.connections;Ke={type:"keypoints",keypointsDefinitionId:Et,points:ha({landmarks:wt,center:{x:Xe,y:Ze},scale:1}),highlighted:!0,editingLabels:!1,id:fa()},e=Object(ne.setIn)(e,["mode"],{mode:"RESIZE_KEYPOINTS",landmarks:wt,centerX:Xe,centerY:Ze,regionId:Ke.id,isNew:!0})}var jt=Object(N.a)(Object(ne.getIn)(e,r).regions||[]).map((function(e){return Object(ne.setIn)(e,["editingLabels"],!1).setIn(["highlighted"],!1)})).concat(Ke?[Ke]:[]);return Object(ne.setIn)(e,[].concat(Object(N.a)(r),["regions"]),jt);case"MOUSE_UP":var It=t.x,Tt=t.y,Ct=e.mouseDownAt,St=void 0===Ct?{x:It,y:Tt}:Ct;if(!e.mode)return e;switch((e=Object(ne.setIn)(e,["mouseDownAt"],null)).mode.mode){case"RESIZE_BOX":if(e.mode.isNew&&(Math.abs(e.mode.original.x-It)<.002||Math.abs(e.mode.original.y-Tt)<.002))return Object(ne.setIn)(u(e.mode.regionId,null),["mode"],null);if(e.mode.editLabelEditorAfter)return Object(C.a)(Object(C.a)({},u(e.mode.regionId,{editingLabels:!0})),{},{mode:null});case"MOVE_REGION":case"RESIZE_KEYPOINTS":case"MOVE_POLYGON_POINT":case"MOVE_KEYPOINT":return Object(C.a)(Object(C.a)({},e),{},{mode:null});case"CREATE_POINT_LINE":return e;case"DRAW_EXPANDING_LINE":var Mt=s(e.mode.regionId),Nt=Object(m.a)(Mt,2),kt=Nt[0],At=Nt[1];if(!kt)return e;var _t=kt,Lt=0!==kt.points.length?kt.points.slice(-1)[0]:St;if(kt.points.length>1?kt.points.slice(-2)[0]:Lt,!(Math.sqrt(Math.pow(Lt.x-It,2)+Math.pow(Lt.y-Tt,2))>.002))return e;for(var Dt=Object(N.a)(kt.points),Rt=0;Rt<Dt.length-1;Rt++)Dt[Rt].width||(Dt[Rt]=Object(C.a)(Object(C.a)({},Dt[Rt]),{},{width:Lt.width}));return _t=Object(ne.setIn)(kt,["points"],Dt),Object(ne.setIn)(e,[].concat(Object(N.a)(r),["regions",At]),_t);default:return e}case"OPEN_REGION_EDITOR":t.region;var Pt=l(t.region);if(null===Pt)return e;var Bt=Object(ne.setIn)(c.regions.map((function(e){return Object(C.a)(Object(C.a)({},e),{},{highlighted:!1,editingLabels:!1})})),[Pt],Object(C.a)(Object(C.a)({},(c.regions||[])[Pt]),{},{highlighted:!0,editingLabels:!0}));return Object(ne.setIn)(e,[].concat(Object(N.a)(r),["regions"]),Bt);case"CLOSE_REGION_EDITOR":t.region;var Wt=l(t.region);return null===Wt?e:Object(ne.setIn)(e,[].concat(Object(N.a)(r),["regions",Wt]),Object(C.a)(Object(C.a)({},(c.regions||[])[Wt]),{},{editingLabels:!1}));case"DELETE_REGION":return null===l(t.region)?e:Object(ne.setIn)(e,[].concat(Object(N.a)(r),["regions"]),(c.regions||[]).filter((function(e){return e.id!==t.region.id})));case"DELETE_SELECTED_REGION":return Object(ne.setIn)(e,[].concat(Object(N.a)(r),["regions"]),(c.regions||[]).filter((function(e){return!e.highlighted})));case"HEADER_BUTTON_CLICKED":switch(t.buttonName.toLowerCase()){case"prev":return null===i||0===i?e:g(e.images[i-1],i-1);case"next":return null===i||i===e.images.length-1?e:g(e.images[i+1],i+1);case"clone":return null===i||i===e.images.length-1?e:Object(ne.setIn)(g(e.images[i+1],i+1),["images",i+1,"regions"],c.regions);case"settings":return Object(ne.setIn)(e,["settingsOpen"],!e.settingsOpen);case"help":return e;case"fullscreen":return Object(ne.setIn)(e,["fullScreen"],!0);case"exit fullscreen":case"window":return Object(ne.setIn)(e,["fullScreen"],!1);case"hotkeys":return e;case"exit":case"done":default:return e}case"SELECT_TOOL":return"show-tags"===t.selectedTool?(function(e,t){window.localStorage.setItem("__REACT_IMAGE_ANNOTATE_".concat(e),JSON.stringify(t))}("showTags",!e.showTags),Object(ne.setIn)(e,["showTags"],!e.showTags)):"show-mask"===t.selectedTool?Object(ne.setIn)(e,["showMask"],!e.showMask):("modify-allowed-area"!==t.selectedTool||e.allowedArea||(e=Object(ne.setIn)(e,["allowedArea"],{x:0,y:0,w:1,h:1})),e=Object(ne.setIn)(e,["mode"],null),Object(ne.setIn)(e,["selectedTool"],t.selectedTool));case"CANCEL":var zt=e.mode;if(zt)switch(zt.mode){case"DRAW_EXPANDING_LINE":case"SET_EXPANDING_LINE_WIDTH":case"DRAW_POLYGON":return u(zt.regionId,null);case"MOVE_POLYGON_POINT":case"RESIZE_BOX":case"MOVE_REGION":return Object(ne.setIn)(e,["mode"],null);default:return e}var Gt=c.regions;if(Gt&&Gt.some((function(e){return e.editingLabels})))return Object(ne.setIn)(e,[].concat(Object(N.a)(r),["regions"]),Gt.map((function(e){return Object(C.a)(Object(C.a)({},e),{},{editingLabels:!1})})));if(Gt)return Object(ne.setIn)(e,[].concat(Object(N.a)(r),["regions"]),Gt.map((function(e){return Object(C.a)(Object(C.a)({},e),{},{highlighted:!1})})))}return e},ba=function(e,t){var n=ot(e),a=n.currentImageIndex;n.pathToActiveImage,n.activeImage;switch(t.type){case"IMAGE_OR_VIDEO_LOADED":return Object(ne.setIn)(e,["images",a,"pixelSize"],{w:t.metadata.naturalWidth,h:t.metadata.naturalHeight})}return e},ya=function(e,t){var n=function(){return Object(ne.setIn)(sa(e,"Add Keyframe"),["keyframes",e.currentVideoTime||0],{regions:ct(e.keyframes,e.currentVideoTime)})};switch(t.type){case"IMAGE_OR_VIDEO_LOADED":var a=t.metadata.duration;if("number"===typeof a)return Object(ne.setIn)(e,["videoDuration"],1e3*a);case"HEADER_BUTTON_CLICKED":switch(t.buttonName.toLowerCase()){case"play":return Object(ne.setIn)(e,["videoPlaying"],!0);case"pause":return Object(ne.setIn)(e,["videoPlaying"],!1)}case"CHANGE_VIDEO_TIME":return Object(ne.setIn)(e,["currentVideoTime"],t.newTime);case"CHANGE_VIDEO_PLAYING":return Object(ne.setIn)(e,["videoPlaying"],t.isPlaying);case"DELETE_KEYFRAME":return Object(ne.setIn)(e,["keyframes"],Object(ne.without)(e.keyframes,t.time))}if(!e.keyframes[e.currentVideoTime])switch(t.type){case"BEGIN_BOX_TRANSFORM":case"BEGIN_MOVE_POINT":case"BEGIN_MOVE_KEYPOINT":case"BEGIN_MOVE_POLYGON_POINT":case"ADD_POLYGON_POINT":case"SELECT_REGION":case"CHANGE_REGION":case"DELETE_REGION":case"OPEN_REGION_EDITOR":return n();case"MOUSE_DOWN":switch(e.selectedTool){case"create-point":case"create-polygon":case"create-box":case"create-keypoints":return n()}}return e},Oa=function(e){var t=e.images,n=e.allowedArea,i=e.selectedImage,r=void 0===i?t&&t.length>0?0:void 0:i,c=e.showPointDistances,l=e.pointDistancePrecision,s=e.showTags,u=void 0===s?function(e,t){try{return JSON.parse(window.localStorage["__REACT_IMAGE_ANNOTATE_".concat(e)])}catch(n){return t}}("showTags",!0):s,d=e.enabledTools,g=void 0===d?["select","create-point","create-box","create-polygon","create-line","create-expanding-line","show-mask"]:d,h=e.selectedTool,f=void 0===h?"select":h,p=e.regionTagList,b=void 0===p?[]:p,y=e.regionClsList,O=void 0===y?[]:y,v=e.imageTagList,E=void 0===v?[]:v,x=e.imageClsList,w=void 0===x?[]:x,j=e.keyframes,I=void 0===j?{}:j,T=e.taskDescription,S=void 0===T?"":T,M=e.fullImageSegmentationMode,N=void 0!==M&&M,k=e.RegionEditLabel,A=e.videoSrc,_=e.videoTime,D=void 0===_?0:_,R=e.videoName,P=e.onExit,B=e.onNextImage,W=e.onPrevImage,z=e.keypointDefinitions,G=e.autoSegmentationOptions,H=void 0===G?{type:"autoseg"}:G,V=e.hideHeader,U=e.hideHeaderText,F=e.hideNext,Y=e.hidePrev,K=e.allowComments;"string"===typeof r&&-1===(r=(t||[]).findIndex((function(e){return e.src===r})))&&(r=void 0);var X,Z=t?"image":"video",J=Object(a.useReducer)((X=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e,n){var a,o=Object(it.a)(t);try{for(o.s();!(a=o.n()).done;)e=(0,a.value)(e,n)}catch(i){o.e(i)}finally{o.f()}return e}}("image"===Z?ba:ya,pa),function(e,t){var n=e,a=X(e,t);if("RESTORE_HISTORY"===t.type){if(e.history.length>0)return Object(ne.setIn)(a.history[0].state,["history"],a.history.slice(1))}else if(n!==a&&Object.keys(la).includes(t.type))return Object(ne.setIn)(a,["history"],[{time:Gn()().toDate(),state:Object(ne.without)(n,"history"),name:la[t.type]||t.type}].concat(a.history||[]).slice(0,9));return a}),ae()(Object(C.a)({annotationType:Z,showTags:u,allowedArea:n,showPointDistances:c,pointDistancePrecision:l,selectedTool:f,fullImageSegmentationMode:N,autoSegmentationOptions:H,mode:null,taskDescription:S,showMask:!0,labelImages:w.length>0||E.length>0,regionClsList:O,regionTagList:b,imageClsList:w,imageTagList:E,currentVideoTime:D,enabledTools:g,history:[],videoName:R,keypointDefinitions:z,allowComments:K},"image"===Z?{selectedImage:r,images:t,selectedImageFrameTime:t&&t.length>0?t[0].frameTime:void 0}:{videoSrc:A,keyframes:I}))),q=Object(m.a)(J,2),$=q[0],Q=q[1],ee=Object(L.a)((function(e){if("HEADER_BUTTON_CLICKED"===e.type){if(["Exit","Done","Save","Complete"].includes(e.buttonName))return P(Object(ne.without)($,"history"));if("Next"===e.buttonName&&B)return B(Object(ne.without)($,"history"));if("Prev"===e.buttonName&&W)return W(Object(ne.without)($,"history"))}Q(e)})),te=Object(L.a)((function(e){Q({type:"ON_CLS_ADDED",cls:e})}));return Object(a.useEffect)((function(){void 0!==r&&Q({type:"SELECT_IMAGE",imageIndex:r,image:$.images[r]})}),[r,$.images]),t||A?o.a.createElement(Pe,null,o.a.createElement(ca,{RegionEditLabel:k,alwaysShowNextButton:Boolean(B),alwaysShowPrevButton:Boolean(W),state:$,dispatch:ee,onRegionClassAdded:te,hideHeader:V,hideHeaderText:U,hideNext:F,hidePrev:Y})):'Missing required prop "images" or "videoSrc"'},va=n(67),Ea=n(86),xa=n(96),wa=n(95),ja=function(e){Object(xa.a)(n,e);var t=Object(wa.a)(n);function n(){var e;Object(va.a)(this,n);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).state={hasError:!1,err:""},e}return Object(Ea.a)(n,[{key:"componentDidCatch",value:function(e,t){this.setState({hasError:!0,err:e.toString()+"\n\n"+t.componentStack})}},{key:"render",value:function(){return this.state.hasError?o.a.createElement(b.a,{open:this.state.hasError,onClose:this.props.onClose},o.a.createElement(y.a,null,"Error Loading Annotator"),o.a.createElement(O.a,null,o.a.createElement("pre",null,this.state.err)),o.a.createElement(v.a,null,o.a.createElement(h.a,{onClick:this.props.onClose},"Close"))):this.props.children}}]),n}(a.Component),Ia=function(){var e=Object(a.useState)(!1),t=Object(m.a)(e,2),n=t[0],i=t[1],r=Object(a.useState)(I.Custom()),c=Object(m.a)(r,2),l=c[0],s=c[1],u=Object(a.useState)(),d=Object(m.a)(u,2),g=d[0],h=d[1];return o.a.createElement("div",null,n?o.a.createElement(ja,{onClose:function(){i(!1)}},o.a.createElement(Oa,Object.assign({},l,{onExit:function(e){delete e.lastAction,h(e),i(!1)}}))):o.a.createElement(T,{lastOutput:g,onOpenAnnotator:function(e){s(e),i(!0)}}))},Ta=n(443),Ca=(n(912),n(1194)),Sa=n(445),Ma=Object(M.a)("div")({display:"flex",flexDirection:"column",alignItems:"center"}),Na=Object(M.a)("div")({width:"100%",boxSizing:"border-box",display:"flex",flexDirection:"column",maxWidth:1200}),ka=Object(M.a)("div")({width:"100%",display:"flex",justifyContent:"center",backgroundColor:ue.a[600],padding:8,boxSizing:"border-box"}),Aa=Object(M.a)(h.a)({color:"white",margin:8,padding:16,paddingLeft:24,paddingRight:24}),_a=Object(M.a)("div")({display:"flex",justifyContent:"center",width:"100%",backgroundColor:ue.a[500],padding:16,color:"white",boxSizing:"border-box"}),La=Object(M.a)("div")({fontSize:48,fontWeight:"bold",paddingTop:64,textShadow:"0px 1px 5px rgba(0,0,0,0.3)"}),Da=Object(M.a)("div")({paddingTop:32,lineHeight:1.5,fontSize:24,textShadow:"0px 1px 3px rgba(0,0,0,0.2)"}),Ra=Object(M.a)("div")({paddingTop:32,paddingBottom:48}),Pa=Object(M.a)("div")({display:"flex",padding:16,paddingTop:32,flexDirection:"column"}),Ba=function(e){var t=e.language,n=e.value;return o.a.createElement(Ca.a,{language:t,style:Sa.docco},n)};function Wa(e,t){return"string"===typeof t?e+t:o.a.Children.toArray(t.props.children).reduce(Wa,e)}function za(e){var t=o.a.Children.toArray(e.children).reduce(Wa,"").toLowerCase().replace(/\W/g,"-");return o.a.createElement("h"+e.level,{id:t},e.children)}var Ga=function(){return o.a.createElement(Ma,null,o.a.createElement(ka,{id:"about"},o.a.createElement(Na,{style:{flexDirection:"row",flexGrow:1}},o.a.createElement(Aa,{href:"#features"},"Features"),o.a.createElement(Aa,{href:"#usage"},"Usage"),o.a.createElement(Aa,{href:"#props"},"Props"),o.a.createElement(Aa,{href:"./demo"},"Demo Playground"))),o.a.createElement(_a,null,o.a.createElement(Na,null,o.a.createElement(La,null,"React Image Annotate"),o.a.createElement(Da,null,"Powerful React component for image annotations with bounding boxes, tagging, classification, multiple images and polygon segmentation."),o.a.createElement(Ra,null,o.a.createElement(Ta.a,{href:"https://github.com/waoai/react-image-annotate","data-size":"large","data-show-count":"true","aria-label":"Star waoai/react-image-annotate on GitHub"},"Star")))),o.a.createElement(Na,{className:"markdown-body"},o.a.createElement(Pa,{className:"markdown-body"},o.a.createElement(Qt.a,{escapeHtml:!1,source:'# Features\n\n- Simple input/output format\n- Bounding Box, Point and Polygon Annotation\n- Zooming, Scaling, Panning\n- Multiple Images\n- Cursor Crosshair\n\n![Screenshot of Annotator](https://user-images.githubusercontent.com/1910070/51199716-83c72080-18c5-11e9-837c-c3a89c8caef4.png)\n\n# Usage\n\n## Installation\n\n```bash\nnpm install react-image-annotate\n```\n\n## Basic Example\n\n```javascript\nimport ReactImageAnnotate from "react-image-annotate"\n\nconst App = () => (\n  <ReactImageAnnotate\n    selectedImage="https://example.com/image1.png"\n    taskDescription="# Draw region around each animal."\n    images={[{ src: "https://example.com/image1.png", name: "Image 1" }]}\n    regionClsList={["Dog", "Cat"]}\n    enabledTools={["create-box"]}\n  />\n)\n```\n\n# Props\n\nAll of the following properties can be defined on the `ReactImageAnnotate` component...\n\n| Prop                     | Type (\\* = required)                             | Description                                                                             | Default       |\n| ------------------------ | ------------------------------------------------ | --------------------------------------------------------------------------------------- | ------------- |\n| `taskDescription`        | \\*`string`                                       | Markdown description for what to do in the image.                                       |               |\n| `allowedArea`            | `{ x: number, y: number, w: number, h: number }` | Area that is available for annotation.                                                  | Entire image. |\n| `regionTagList`          | `Array<string>`                                  | Allowed "tags" (mutually inclusive classifications) for regions.                        |               |\n| `regionClsList`          | `Array<string>`                                  | Allowed "classes" (mutually exclusive classifications) for regions.                     |               |\n| `imageTagList`           | `Array<string>`                                  | Allowed tags for entire image.                                                          |               |\n| `imageClsList`           | `Array<string>`                                  | Allowed classes for entire image.                                                       |               |\n| `enabledTools`           | `Array<string>`                                  | Tools allowed to be used. e.g. "select", "create-point", "create-box", "create-polygon" | Everything.   |\n| `showTags`               | `boolean`                                        | Show tags and allow tags on regions.                                                    | `true`        |\n| `selectedImage`          | `string`                                         | URL of initially selected image.                                                        |               |\n| `images`                 | `Array<Image>`                                   | Array of images to load into annotator                                                  |               |\n| `showPointDistances`     | `boolean`                                        | Show distances between points.                                                          | `false`       |\n| `pointDistancePrecision` | `number`                                         | Precision on displayed points (e.g. 3 => 0.123)                                         |               |\n| `onExit`                 | `MainLayoutState => any`                         | Called when "Save" is called.                                                           |               |\n\n# Sponsors\n\n[![wao.ai sponsorship image](https://s3.amazonaws.com/asset.workaround.online/sponsorship-banner-1.png)](https://wao.ai)\n',renderers:{code:Ba,heading:za}}))))},Ha=(n(1101),function(){var e=window.location.pathname.replace(/\/$/,"").split("/").slice(-1)[0];return o.a.createElement(g,null,"demo"===e?o.a.createElement(Ia,null):o.a.createElement(Ga,null))});r.a.render(o.a.createElement(Ha,null),document.getElementById("root"))},456:function(e,t,n){e.exports=n(1102)},912:function(e,t,n){}},[[456,1,2]]]);
//# sourceMappingURL=main.018dea86.chunk.js.map